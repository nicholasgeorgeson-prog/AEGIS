/**
 * AEGIS - Roles Studio Styles
 * Version: 3.0.103
 * 
 * Role management, network graph, RACI matrix, and adjudication.
 * Classes: .role-*, .graph-*, .raci-*, .node-*, .adj-*
 */

/* ============================================================
   ENHANCED STYLES v2.6.0
   ============================================================ */

/**
 * AEGIS Enhanced Styles v2.6.0
 * Additional styles for new features
 * Append this to your existing style.css
 */

/* =============================================================================
   ROLE NETWORK VISUALIZATION
   ============================================================================= */

#role-network-svg {
    width: 100%;
    height: 100%;
}

#role-network-svg circle {
    cursor: pointer;
    transition: transform 0.2s, filter 0.2s;
}

#role-network-svg circle:hover {
    transform: scale(1.1);
    filter: brightness(1.1);
}

#role-network-svg line {
    stroke-opacity: 0.6;
}

#role-network-svg text {
    pointer-events: none;
}

.role-detail-section {
    margin-bottom: 15px;
    font-size: 14px;
}

.role-detail-section strong {
    display: block;
    margin-bottom: 5px;
    color: #333;
}

.role-detail-section ul {
    margin: 5px 0;
    padding-left: 20px;
}

.role-detail-section li {
    margin-bottom: 4px;
    color: #666;
    font-size: 13px;
}

.action-types {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.action-badge {
    display: inline-block;
    padding: 3px 8px;
    background: #e3f2fd;
    color: #1976d2;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 500;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #666;
}

.legend-color {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

/* Simple roles list fallback */
.roles-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 400px;
    overflow-y: auto;
}

.role-category {
    color: #1976d2;
    background: #e3f2fd;
    padding: 2px 8px;
    border-radius: 10px;
}

.role-count {
    color: #666;
}

/* Dashboard role summary */
.roles-summary {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.role-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 10px;
    background: #f8f9fa;
    border-radius: 6px;
    font-size: 13px;
}

.role-item .role-name {
    font-weight: 500;
    color: #333;
}

.role-item .role-count {
    color: #666;
    font-size: 12px;
}


/* ===== ENHANCED ROLES PAGE ===== */

.roles-tab {
    padding: var(--space-2) var(--space-4);
    background: transparent;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    border-radius: var(--radius-md) var(--radius-md) 0 0;
    transition: color var(--duration-fast), opacity var(--duration-fast), transform var(--duration-fast), border-color var(--duration-fast), box-shadow var(--duration-fast);
}

.roles-tab:hover {
    background: var(--bg-hover);
    color: var(--text-primary);
}

.roles-tab.active {
    background: var(--accent-subtle);
    color: var(--accent);
    border-bottom: 2px solid var(--accent);
}

/* v3.0.66 FIX: Add missing fadeIn keyframes that .roles-section references */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* v3.0.70 FIX: Add display rules for .active class that roles-tabs-fix.js expects */
#modal-roles .roles-section {
    display: none !important;
}

/* v3.0.72: Use flex to fill available height */
#modal-roles .roles-section.active {
    display: flex !important;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    animation: fadeIn 0.2s ease;
    opacity: 1;
}

/* v3.0.72: Make specific sections fill available space */
#roles-overview,
#roles-details,
#roles-adjudication,
#roles-documents,
#roles-dictionary,
#roles-crossref {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
}

/* v3.0.72: Make scrollable content areas expand */
#roles-overview > div:last-child,
#roles-details .details-list,
#roles-documents .document-log-table-container {
    flex: 1;
    overflow-y: auto;
    min-height: 200px;
}

/* Quick Actions Toolbar */
.roles-quick-actions {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border-light, #e2e8f0);
}

.roles-quick-actions .btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.roles-quick-actions .btn svg {
    width: 14px;
    height: 14px;
}

/* Roles Summary Grid */
.roles-summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: var(--space-4);
    margin-bottom: var(--space-5);
}

.roles-summary-card {
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    text-align: center;
    border: 1px solid var(--border-default);
}

.roles-summary-card .summary-icon {
    width: 40px;
    height: 40px;
    margin: 0 auto var(--space-2);
    background: var(--accent-subtle);
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
}

.roles-summary-card .summary-icon svg {
    width: 20px;
    height: 20px;
    color: var(--accent);
}

.roles-summary-card .summary-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1;
}

.roles-summary-card .summary-label {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: var(--space-1);
}

/* v3.0.12: Entity Audit Bar */
.entity-audit-bar {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    margin-bottom: var(--space-4);
    background: var(--bg-subtle);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-default);
    font-size: 13px;
    color: var(--text-secondary);
}

.entity-audit-bar svg {
    width: 16px;
    height: 16px;
    color: var(--accent-primary);
    flex-shrink: 0;
}

.entity-audit-bar.has-excluded {
    background: #fffbeb;
    border-color: #f59e0b;
}

.entity-audit-bar.has-excluded svg {
    color: #f59e0b;
}

.dark-mode .entity-audit-bar.has-excluded {
    background: rgba(245, 158, 11, 0.1);
}

/* Roles Bar Chart */
.roles-chart-container {
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-bottom: var(--space-4);
    border: 1px solid var(--border-default);
}

.roles-chart-container h4 {
    margin: 0 0 var(--space-3) 0;
    font-size: 14px;
    color: var(--text-secondary);
}

.roles-bar-chart {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

/* Top Roles List */
.roles-top-list {
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    border: 1px solid var(--border-default);
}

.roles-top-list h4 {
    margin: 0 0 var(--space-3) 0;
    font-size: 14px;
    color: var(--text-secondary);
}

.top-role-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--border-muted);
}

.top-role-item:last-child {
    border-bottom: none;
}

.top-role-rank.rank-1 { background: #ffd700; color: #333; }
.top-role-rank.rank-2 { background: #c0c0c0; color: #333; }
.top-role-rank.rank-3 { background: #cd7f32; color: #fff; }

/* Roles Filter Bar */
.roles-filter-bar {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
    /* v3.0.58: Add padding to prevent focus outline clipping */
    padding: 3px;
    margin-left: -3px;
    margin-top: -3px;
}

.roles-filter-bar input {
    flex: 1;
    max-width: 300px;
}

.roles-filter-bar select {
    width: 200px;
}

/* Responsibility Matrix */

.responsibility-matrix {
    overflow-x: auto;
}

.responsibility-matrix table {
    border-collapse: collapse;
    min-width: 100%;
}

.responsibility-matrix th,
.responsibility-matrix td {
    padding: var(--space-2);
    text-align: center;
    border: 1px solid var(--border-default);
    font-size: 12px;
}

.responsibility-matrix th {
    background: var(--bg-elevated);
    font-weight: 600;
    color: var(--text-secondary);
}

.responsibility-matrix th.role-header {
    writing-mode: vertical-lr;
    text-orientation: mixed;
    transform: rotate(180deg);
    white-space: nowrap;
    max-width: 40px;
    height: 120px;
}

.responsibility-matrix td.role-row-header {
    text-align: left;
    font-weight: 500;
    background: var(--bg-elevated);
    white-space: nowrap;
}

.matrix-cell.has-interaction {
    background: var(--accent-subtle);
    cursor: pointer;
}

.matrix-cell.has-interaction:hover {
    background: var(--accent-muted);
}

.matrix-cell.self {
    background: var(--bg-surface);
}

/* Document Log */
.document-log-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-3);
}

.document-log-header h4 {
    margin: 0;
    font-size: 14px;
    color: var(--text-secondary);
}

.document-log-table {
    overflow-x: auto;
}

.document-log-empty {
    text-align: center;
    padding: var(--space-6);
    color: var(--text-muted);
    font-style: italic;
}

/* Role Card Enhancements */

.role-card.expanded .role-card-body {
    display: block;
}

.role-card.expanded .role-card-chevron {
    transform: rotate(180deg);
}

/* ===== ENHANCED ROLE DETAILS ===== */
.role-aliases {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
    padding: var(--space-2);
    background: var(--bg-surface);
    border-radius: var(--radius-sm);
}

.confidence-badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    color: white;
    font-weight: 600;
}

/* ===== RACI MATRIX ===== */

.raci-cell {
    font-weight: 600;
    font-size: 14px;
}

.raci-cell.raci-r { background: rgba(52, 152, 219, 0.08); }
.raci-cell.raci-a { background: rgba(155, 89, 182, 0.08); }
.raci-cell.raci-c { background: rgba(46, 204, 113, 0.08); }
.raci-cell.raci-i { background: rgba(243, 156, 18, 0.08); }

.raci-total {
    font-weight: 700;
    background: var(--bg-surface);
}

.raci-legend {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
    margin-top: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-surface);
    border-radius: var(--radius-sm);
    font-size: 12px;
}

.raci-legend-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.raci-dot {
    width: 12px;
    height: 12px;
    border-radius: 2px;
}

.raci-dot.raci-r { background: rgba(52, 152, 219, 0.5); }
.raci-dot.raci-a { background: rgba(231, 76, 60, 0.5); }
.raci-dot.raci-c { background: rgba(46, 204, 113, 0.5); }
.raci-dot.raci-i { background: rgba(241, 196, 15, 0.5); }

/* ===== ROLE ADJUDICATION (v2.8.6) ===== */
.adjudication-header {
    margin-bottom: var(--space-4);
}

.adjudication-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin: 0 0 var(--space-2) 0;
}

.adjudication-header h4 svg {
    width: 20px;
    height: 20px;
    color: var(--success);
}

/* v3.0.58: Adjudication filter bar - prevent focus outline clipping */
.adjudication-filters {
    padding: 3px;
    margin-left: -3px;
    margin-top: -3px;
}

/* v3.0.72: Adjudication list fills available space */
.adjudication-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    flex: 1;
    min-height: 200px;
    overflow-y: auto;
}

.adjudication-item {
    display: flex;
    flex-direction: column; /* F4: Column layout */
    padding: var(--space-3);
    background: var(--bg-surface);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    transition: color var(--duration-fast), opacity var(--duration-fast), transform var(--duration-fast), border-color var(--duration-fast), box-shadow var(--duration-fast);
}

.adjudication-item:hover {
    border-color: var(--accent);
}

.adjudication-item.status-confirmed {
    border-left: 3px solid var(--success);
    background: rgba(46, 204, 113, 0.05);
}

.adjudication-item.status-deliverable {
    border-left: 3px solid var(--info);
    background: rgba(52, 152, 219, 0.05);
}

.adjudication-item.status-rejected {
    border-left: 3px solid var(--error);
    background: rgba(231, 76, 60, 0.05);
    opacity: 0.7;
}

/* v3.0.59: Adjudication edit mode styling */
.adjudication-item.status-pending {
    border-left: 3px solid var(--text-muted);
}

.adj-status-badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 3px;
    font-weight: 500;
}

.adj-status-badge.status-pending {
    background: var(--bg-secondary);
    color: var(--text-muted);
}

.adj-status-badge.status-confirmed {
    background: rgba(46, 204, 113, 0.15);
    color: var(--success);
}

.adj-status-badge.status-deliverable {
    background: rgba(52, 152, 219, 0.15);
    color: var(--info);
}

.adj-status-badge.status-rejected {
    background: rgba(231, 76, 60, 0.15);
    color: var(--error);
}

.adj-item-edit .form-input,
.adj-item-edit .form-select {
    border: 1px solid var(--border-default);
    border-radius: 4px;
}

.adj-item-edit .form-input:focus,
.adj-item-edit .form-select:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.15);
}

.adj-edit-actions {
    align-items: center;
}

.adj-item-main {
    flex: 1;
    display: flex;
    flex-direction: column; /* F4: Stack vertically */
    gap: var(--space-2);
}

.adj-item-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-2);
}

/* F2: Full name display with word wrap */
.adj-item-name {
    font-weight: 500;
    font-size: 14px;
    word-break: break-word;
    flex: 1;
}

.adj-item-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
}

.confidence-badge {
    font-size: 11px;
    padding: 2px 6px;
    border-radius: var(--radius-full);
    background: var(--bg-secondary);
    color: var(--text-secondary);
}

.confidence-badge.low {
    background: rgba(231, 76, 60, 0.15);
    color: var(--error);
}

.count-badge {
    font-size: 11px;
    color: var(--text-muted);
}

.suggested-badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: var(--radius-full);
    background: rgba(52, 152, 219, 0.15);
    color: var(--info);
}

.suggested-badge.deliverable {
    background: rgba(241, 196, 15, 0.15);
    color: #f39c12;
}

.adj-item-status {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    font-size: 12px;
    color: var(--text-muted);
    min-width: 100px;
}

.adj-item-status svg {
    width: 14px;
    height: 14px;
}

.status-confirmed .adj-item-status { color: var(--success); }
.status-deliverable .adj-item-status { color: var(--info); }
.status-rejected .adj-item-status { color: var(--error); }

/* F4: Action buttons with labels */
.adj-item-actions {
    display: flex;
    gap: var(--space-2);
    margin-top: var(--space-2);
    padding-top: var(--space-2);
    border-top: 1px solid var(--border-muted);
}

.adj-item-actions .btn {
    padding: 6px 12px;
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.adj-item-actions .btn svg {
    width: 14px;
    height: 14px;
}

.adj-item-actions .btn .btn-label {
    font-size: 11px;
}

/* F3: Improved context sentences display */
.adj-item-contexts {
    width: 100%;
    margin-top: var(--space-2);
    padding-top: var(--space-2);
    border-top: 1px dashed var(--border-default);
}

.adj-context-toggle {
    font-size: 11px;
    color: var(--text-muted);
}

.adj-context-toggle:hover {
    color: var(--accent);
}

.adj-context-list {
    margin-top: var(--space-2);
    max-height: 150px;
    overflow-y: auto;
}

.adj-context-sentence {
    font-size: 12px;
    color: var(--text-secondary);
    padding: var(--space-2);
    margin: var(--space-1) 0;
    background: var(--bg-surface);
    border-radius: var(--radius-sm);
    border-left: 2px solid var(--accent);
    font-style: italic;
    line-height: 1.5;
    word-break: break-word;
}

.btn-info {
    background: var(--info);
    color: white;
    border-color: var(--info);
}

.btn-info:hover {
    background: #2980b9;
}

.text-info { color: var(--info); }
.text-success { color: var(--success); }
.text-error { color: var(--error); }

/* ===== ADJUDICATION v4.0.3 - COMPLETE OVERHAUL ===== */

/* --- Dashboard --- */
.adj-dashboard {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
    flex-wrap: wrap;
}
.adj-dashboard-left h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin: 0 0 var(--space-1) 0;
    font-size: 18px;
}
.adj-dashboard-left h4 svg { width: 22px; height: 22px; color: var(--aegis-gold, #D6A84A); }
.adj-dashboard-left .help-text { margin: 0; font-size: 13px; color: var(--text-muted); max-width: 420px; }
.adj-dashboard-right {
    display: flex;
    align-items: center;
    gap: var(--space-4);
}
.adj-progress-ring { width: 52px; height: 52px; flex-shrink: 0; }
.adj-stat-cards {
    display: flex;
    gap: 8px;
}
.adj-stat-card {
    padding: 8px 16px;
    border-radius: 10px;
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    background: var(--bg-secondary);
    border: 1px solid var(--border-default);
    text-align: center;
    min-width: 72px;
    user-select: none;
}
.adj-stat-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}
.adj-stat-card.active {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-subtle, rgba(88,166,255,0.15));
}
.adj-stat-count {
    display: block;
    font-size: 22px;
    font-weight: 700;
    line-height: 1.2;
}
.adj-stat-label {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}
.adj-stat-pending .adj-stat-count { color: var(--text-secondary); }
.adj-stat-confirmed .adj-stat-count { color: var(--success); }
.adj-stat-deliverable .adj-stat-count { color: var(--info); }
.adj-stat-rejected .adj-stat-count { color: var(--error); }
.adj-stat-pending { border-left: 3px solid var(--text-muted); }
.adj-stat-confirmed { border-left: 3px solid var(--success); }
.adj-stat-deliverable { border-left: 3px solid var(--info); }
.adj-stat-rejected { border-left: 3px solid var(--error); }

/* --- Toolbar --- */
.adj-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-3);
    padding: 10px 14px;
    background: var(--bg-secondary);
    border-radius: 10px;
    margin-bottom: var(--space-3);
    flex-wrap: wrap;
    border: 1px solid var(--border-default);
}
.adj-toolbar-left, .adj-toolbar-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
}
.adj-select-all-label {
    display: flex;
    align-items: center;
    cursor: pointer;
}
.adj-select-all-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--accent);
}
.adj-filter-select {
    width: auto;
    min-width: 140px;
    padding: 6px 10px;
    font-size: 13px;
    border-radius: 6px;
}
.adj-search-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}
.adj-search-icon {
    position: absolute;
    left: 10px;
    width: 14px;
    height: 14px;
    color: var(--text-muted);
    pointer-events: none;
}
.adj-search-input {
    width: 180px;
    padding: 6px 10px 6px 30px;
    font-size: 13px;
    border-radius: 6px;
}
.adj-bulk-divider {
    width: 1px;
    height: 20px;
    background: var(--border-default);
}
.adj-bulk-label {
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 500;
}
.adj-bulk-btn {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    gap: 4px;
}
.adj-bulk-btn svg { width: 14px; height: 14px; }
.adj-bulk-confirm { color: var(--success); border: 1px solid var(--success); background: transparent; }
.adj-bulk-confirm:hover { background: var(--success); color: white; }
.adj-bulk-deliverable { color: var(--info); border: 1px solid var(--info); background: transparent; }
.adj-bulk-deliverable:hover { background: var(--info); color: white; }
.adj-bulk-reject { color: var(--error); border: 1px solid var(--error); background: transparent; }
.adj-bulk-reject:hover { background: var(--error); color: white; }

/* --- View Toggle --- */
.adj-view-toggle {
    display: flex;
    background: var(--bg-tertiary, var(--bg-surface));
    border-radius: 8px;
    padding: 2px;
    border: 1px solid var(--border-default);
}
.adj-view-btn {
    padding: 5px 10px;
    border-radius: 6px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    display: flex;
    align-items: center;
}
.adj-view-btn svg { width: 16px; height: 16px; }
.adj-view-btn:hover { color: var(--text-primary); }
.adj-view-btn.active {
    background: var(--accent);
    color: white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.adj-auto-btn {
    background: linear-gradient(135deg, var(--aegis-gold, #D6A84A) 0%, #B8743A 100%);
    color: white;
    border: none;
    font-weight: 500;
}
.adj-auto-btn:hover {
    box-shadow: 0 2px 8px rgba(214,168,74,0.4);
    transform: translateY(-1px);
}

/* --- Content Area --- */
.adj-content {
    flex: 1;
    min-height: 300px;
    overflow-y: auto;
    max-height: calc(100vh - 380px);
}
.adj-list-view {
    display: flex;
    flex-direction: column;
}

/* --- Enhanced Role Cards (List View) --- */
.adj-role-card {
    display: grid;
    grid-template-columns: auto 44px 1fr auto;
    gap: 14px;
    align-items: start;
    padding: 14px 16px;
    border-radius: 10px;
    border: 1px solid var(--border-default);
    border-left: 4px solid var(--text-muted);
    background: var(--bg-surface);
    margin-bottom: 8px;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    cursor: default;
}
.adj-role-card:hover {
    box-shadow: var(--shadow-sm);
    border-color: var(--border-default);
}
.adj-role-card.adj-focused {
    outline: 2px solid var(--accent);
    outline-offset: 1px;
    box-shadow: 0 0 0 4px var(--accent-subtle, rgba(88,166,255,0.1));
}
.adj-role-card.status-confirmed { border-left-color: var(--success); background: rgba(63,185,80,0.04); }
.adj-role-card.status-deliverable { border-left-color: var(--info); background: rgba(88,166,255,0.04); }
.adj-role-card.status-rejected { border-left-color: var(--error); background: rgba(248,81,73,0.04); opacity: 0.65; }
.adj-role-card.status-rejected:hover { opacity: 0.85; }
.adj-role-card .adj-card-checkbox {
    display: flex;
    align-items: center;
    padding-top: 2px;
}
.adj-role-card .adj-card-checkbox input {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--accent);
}

/* Confidence Ring */
.adj-confidence-ring {
    width: 44px;
    height: 44px;
    position: relative;
    flex-shrink: 0;
}
.adj-confidence-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}
.adj-confidence-ring .ring-bg {
    fill: none;
    stroke: var(--bg-secondary);
    stroke-width: 4;
}
.adj-confidence-ring .ring-fill {
    fill: none;
    stroke-width: 4;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.6s ease;
}
.adj-confidence-ring .ring-text {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
}

/* Card Body */
.adj-card-body { min-width: 0; }
.adj-card-title-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 4px;
    flex-wrap: wrap;
}
.adj-card-name {
    font-weight: 600;
    font-size: 14px;
    color: var(--text-primary);
    cursor: pointer;
    word-break: break-word;
}
.adj-card-name:hover { color: var(--accent); text-decoration: underline; }
.adj-card-category {
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 500;
    white-space: nowrap;
}

/* Function Tag Pills */
.adj-tag-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin: 4px 0;
    position: relative;
}
.adj-tag-pill {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 500;
    border: 1px solid;
    transition: all 0.15s;
}
.adj-tag-pill .adj-tag-remove {
    width: 12px;
    height: 12px;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.15s;
    border-radius: 50%;
}
.adj-tag-pill:hover .adj-tag-remove { opacity: 1; }
.adj-tag-add-btn {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 4px 12px;
    border-radius: 14px;
    font-size: 12px;
    font-weight: 500;
    color: var(--accent, #3b82f6);
    background: var(--bg-secondary);
    border: 1px dashed var(--accent, #3b82f6);
    cursor: pointer;
    transition: color 0.2s, opacity 0.2s, transform 0.2s, border-color 0.2s, box-shadow 0.2s;
}
.adj-tag-add-btn:hover {
    color: #fff;
    background: var(--accent, #3b82f6);
    border-style: solid;
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
}
.adj-tag-add-btn i, .adj-tag-add-btn svg { width: 13px; height: 13px; }

/* Tag Dropdown */
.adj-role-card:has(.adj-tag-dropdown) {
    z-index: 50;
    position: relative;
}
.adj-tag-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 9999;
    min-width: 280px;
    max-width: 360px;
    background: var(--bg-elevated, var(--bg-surface));
    border: 1px solid var(--border-default);
    border-radius: 10px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.35);
    margin-top: 4px;
}
.adj-tag-dropdown-search {
    padding: 8px;
    border-bottom: 1px solid var(--border-default);
}
.adj-tag-search-input {
    width: 100%;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid var(--border-default);
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 12px;
    outline: none;
}
.adj-tag-search-input:focus { border-color: var(--accent); }
.adj-tag-dropdown-list {
    max-height: 320px;
    overflow-y: auto;
    padding: 4px;
}
.adj-tag-dropdown-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}
.adj-tag-dropdown-item.adj-tag-level-2 { padding-left: 28px; }
.adj-tag-dropdown-item.adj-tag-level-3 { padding-left: 46px; font-size: 11px; }
.adj-tag-dropdown-item:hover { background: var(--bg-hover, var(--bg-secondary)); }
.adj-tag-dropdown-item .adj-tag-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}
.adj-tag-dropdown-header {
    padding: 8px 10px 2px;
    font-size: 10px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Export/Share Dropdown Menus */
.adj-export-dropdown,
.adj-share-dropdown {
    position: relative;
}
.adj-export-menu,
.adj-share-menu {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 4px;
    min-width: 220px;
    background: var(--bg-elevated, var(--bg-surface));
    border: 1px solid var(--border-default);
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
    z-index: 200;
    padding: 4px;
    animation: adjDropdownFade 0.15s ease;
}
@keyframes adjDropdownFade {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
}
.adj-export-item,
.adj-share-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 8px 12px;
    text-align: left;
    font-size: 13px;
    color: var(--text-primary);
    background: none;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}
.adj-export-item:hover,
.adj-share-item:hover {
    background: var(--bg-hover, rgba(255,255,255,0.05));
}
.adj-export-item i, .adj-export-item svg,
.adj-share-item i, .adj-share-item svg {
    width: 16px;
    height: 16px;
    color: var(--text-muted);
    flex-shrink: 0;
}
.adj-export-divider,
.adj-share-divider {
    height: 1px;
    background: var(--border-default);
    margin: 4px 8px;
}

/* Document Chips */
.adj-doc-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 4px;
}
.adj-doc-chip {
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 4px;
    background: var(--bg-secondary);
    color: var(--text-muted);
    border: 1px solid var(--border-default);
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Card Meta */
.adj-card-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 4px;
}
.adj-card-meta strong { color: var(--text-secondary); }

/* Context Preview */
.adj-card-context {
    margin-top: 6px;
    padding-top: 6px;
    border-top: 1px dashed var(--border-default);
}
.adj-card-context-text {
    font-size: 12px;
    color: var(--text-secondary);
    font-style: italic;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
.adj-card-context-toggle {
    font-size: 11px;
    color: var(--text-muted);
    cursor: pointer;
    border: none;
    background: none;
    padding: 2px 0;
    display: flex;
    align-items: center;
    gap: 4px;
}
.adj-card-context-toggle:hover { color: var(--accent); }
.adj-card-context-toggle svg { width: 12px; height: 12px; }
.adj-card-context-expanded {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 4px;
}
.adj-card-context-sentence {
    font-size: 12px;
    color: var(--text-secondary);
    padding: 6px 10px;
    margin: 4px 0;
    background: var(--bg-secondary);
    border-radius: 6px;
    border-left: 2px solid var(--accent);
    font-style: italic;
    line-height: 1.5;
    word-break: break-word;
}

/* Card Actions */
.adj-card-actions {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex-shrink: 0;
    align-self: center;
}
.adj-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 8px;
    border: 1px solid var(--border-default);
    background: transparent;
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    color: var(--text-muted);
}
.adj-action-btn svg { width: 16px; height: 16px; }
.adj-action-btn:hover { transform: scale(1.08); }
.adj-action-btn.adj-btn-confirm:hover { background: var(--success); color: white; border-color: var(--success); }
.adj-action-btn.adj-btn-deliverable:hover { background: var(--info); color: white; border-color: var(--info); }
.adj-action-btn.adj-btn-reject:hover { background: var(--error); color: white; border-color: var(--error); }
.adj-action-btn.adj-btn-view:hover { background: var(--accent); color: white; border-color: var(--accent); }
.adj-action-btn.adj-btn-statements:hover { background: #8b5cf6; color: white; border-color: #8b5cf6; }
.adj-action-btn.adj-active-confirm { background: var(--success); color: white; border-color: var(--success); }
.adj-action-btn.adj-active-deliverable { background: var(--info); color: white; border-color: var(--info); }
.adj-action-btn.adj-active-reject { background: var(--error); color: white; border-color: var(--error); }

/* --- Kanban View --- */
.adj-kanban-view {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    min-height: 400px;
}
.adj-kanban-column {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 12px;
    display: flex;
    flex-direction: column;
    border: 1px solid var(--border-default);
    min-height: 200px;
    max-height: calc(100vh - 320px);
}
.adj-kanban-column.drag-over {
    outline: 2px dashed var(--accent);
    background: var(--accent-subtle, rgba(88,166,255,0.08));
}
.adj-kanban-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding-bottom: 10px;
    margin-bottom: 10px;
    border-bottom: 1px solid var(--border-default);
    font-weight: 600;
    font-size: 13px;
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--bg-secondary);
    flex-shrink: 0;
}
.adj-kanban-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
}
.adj-dot-pending { background: var(--text-muted); }
.adj-dot-confirmed { background: var(--success); }
.adj-dot-deliverable { background: var(--info); }
.adj-dot-rejected { background: var(--error); }
.adj-kanban-count {
    margin-left: auto;
    font-size: 12px;
    padding: 1px 8px;
    border-radius: 10px;
    background: var(--bg-surface);
    color: var(--text-muted);
    font-weight: 500;
}
.adj-kanban-cards {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 6px;
    min-height: 50px;
}
.adj-kanban-card {
    padding: 10px 12px;
    border-radius: 8px;
    background: var(--bg-surface);
    border: 1px solid var(--border-default);
    cursor: grab;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    font-size: 13px;
}
.adj-kanban-card:active { cursor: grabbing; }
.adj-kanban-card:hover {
    box-shadow: var(--shadow-sm);
    transform: translateY(-1px);
}
.adj-kanban-card.dragging {
    opacity: 0.5;
    transform: rotate(2deg);
}
.adj-kanban-card-name {
    font-weight: 600;
    margin-bottom: 4px;
    word-break: break-word;
}
.adj-kanban-card-meta {
    display: flex;
    gap: 6px;
    font-size: 10px;
    color: var(--text-muted);
}
.adj-kanban-card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 3px;
    margin-top: 4px;
}
.adj-kanban-card-tag {
    font-size: 9px;
    padding: 1px 5px;
    border-radius: 8px;
    font-weight: 500;
}

/* --- Footer --- */
.adj-footer {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 16px;
    padding-top: 14px;
    border-top: 1px solid var(--border-default);
}
.adj-keyboard-hint {
    margin-left: auto;
    font-size: 11px;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    gap: 4px;
    flex-wrap: wrap;
}
.adj-keyboard-hint kbd {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    font-family: inherit;
    background: var(--bg-secondary);
    border: 1px solid var(--border-default);
    box-shadow: 0 1px 0 var(--border-default);
    color: var(--text-secondary);
    line-height: 1.4;
}

/* --- Auto-Classify Modal Overlay --- */
.adj-auto-overlay {
    position: fixed;
    inset: 0;
    z-index: 10000;
    background: rgba(0,0,0,0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
}
.adj-auto-modal {
    background: var(--bg-primary, #161b22);
    border: 1px solid var(--border-default);
    border-radius: 16px;
    padding: 28px 32px;
    width: 520px;
    max-width: 90vw;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: var(--shadow-2xl, 0 25px 50px rgba(0,0,0,0.5));
}
.adj-auto-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 16px;
}
.adj-auto-title svg { color: var(--aegis-gold, #D6A84A); }
.adj-auto-results {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin: 16px 0;
    max-height: 300px;
    overflow-y: auto;
}
.adj-auto-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    border-radius: 8px;
    background: var(--bg-secondary);
    font-size: 13px;
}
.adj-auto-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    margin-top: 16px;
}

/* --- Animations --- */
@keyframes adj-card-in {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}
.adj-role-card { animation: adj-card-in 0.25s ease both; }
.adj-role-card:nth-child(2) { animation-delay: 0.03s; }
.adj-role-card:nth-child(3) { animation-delay: 0.06s; }
.adj-role-card:nth-child(4) { animation-delay: 0.09s; }
.adj-role-card:nth-child(5) { animation-delay: 0.12s; }

@keyframes adj-count-pop {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
}
.adj-count-updated { animation: adj-count-pop 0.3s ease; }

/* ===== END ADJUDICATION v4.0.3 ===== */

/* ===== ROLES GRAPH VISUALIZATION (v2.8.0) ===== */

/* v4.5.2: Prominent layout switcher */
.graph-layout-switcher {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: var(--bg-surface);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-2);
    border: 1px solid var(--border-default);
}
.layout-switcher-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-right: var(--space-1);
    white-space: nowrap;
}
.layout-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    border: 1px solid var(--border-default);
    border-radius: var(--radius-sm);
    background: transparent;
    color: var(--text-secondary);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
    white-space: nowrap;
}
.layout-btn:hover {
    background: var(--bg-elevated);
    color: var(--text-primary);
    border-color: var(--accent);
}
.layout-btn.active {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
}
.layout-btn .lucide-icon,
.layout-btn svg {
    width: 14px;
    height: 14px;
}

.graph-controls {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-surface);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-3);
}

.graph-control-group {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.graph-control-group label {
    font-size: 12px;
    color: var(--text-secondary);
    white-space: nowrap;
}

.graph-control-group input[type="range"] {
    width: 100px;
    height: 6px;
    -webkit-appearance: none;
    background: var(--bg-elevated);
    border-radius: 3px;
    cursor: pointer;
}

.graph-control-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    background: var(--accent);
    border-radius: 50%;
    cursor: pointer;
}

.graph-control-group input[type="text"] {
    width: 150px;
}

.graph-control-group select {
    width: auto;
    min-width: 100px;
}

#graph-weight-value {
    min-width: 20px;
    text-align: center;
    font-weight: 600;
    color: var(--accent);
}

.graph-legend {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-2) var(--space-3);
    font-size: 12px;
    color: var(--text-secondary);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.legend-dot.role-dot {
    background: #4A90D9;
}

.legend-dot.doc-dot {
    background: #27AE60;
}

/* v2.9.10: Aligned node colors with JS colorScale (#8) */
.legend-dot.deliverable-dot {
    background: #F59E0B;  /* Amber - matches JS colorScale */
}

.legend-dot.system-dot {
    background: #8B5CF6;  /* Purple - matches JS colorScale */
}

.legend-dot.org-dot {
    background: #EC4899;  /* Pink - matches JS colorScale */
}

/* v2.9.10: Adjudication state legend dots (#8) */
.legend-dot.confirmed-dot {
    background: #10B981;  /* Emerald - confirmed role */
    box-shadow: 0 0 0 2px #fff, 0 0 0 3px #10B981;
}

.legend-dot.rejected-dot {
    background: #95A5A6;  /* Gray - rejected */
}

/* v3.0.72: Graph container fills available space */
.graph-container {
    position: relative;
    width: 100%;
    flex: 1;
    min-height: 400px;
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-default);
    overflow: hidden;
}

#roles-graph-svg {
    width: 100%;
    height: 100% !important; /* Override HTML attribute */
}

/* v3.0.72: Make graph section a flex container */
#roles-graph {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
}

.graph-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    background: var(--bg-primary);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    color: var(--text-secondary);
}

.graph-loading .spin {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Graph Node Styles */
.graph-node {
    cursor: pointer;
    transition: opacity 0.2s ease;
}

.graph-node:hover {
    opacity: 0.8;
}

.graph-node.highlighted {
    stroke: var(--warning);
    stroke-width: 3px;
}

.graph-node.dimmed {
    opacity: 0.5;
}

.graph-node.selected {
    stroke: var(--accent);
    stroke-width: 3px;
}

.graph-node-label {
    font-size: 11px;
    fill: var(--text-primary);
    pointer-events: none;
    text-anchor: middle;
    font-weight: 500;
    paint-order: stroke fill;
    stroke: var(--bg-primary);
    stroke-width: 3px;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.graph-link {
    stroke: var(--border-default);
    stroke-opacity: 0.6;
    fill: none;
    /* v4.5.2: Removed infinite dash animation — caused flickering/jank on large graphs.
       Dash patterns are now set by JS per link type (LINK_STYLES). */
}

@keyframes linkFlowAnimation {
    0% {
        stroke-dashoffset: 0;
    }
    100% {
        stroke-dashoffset: -24;
    }
}

/* v4.5.2: Only animate flow on explicitly marked links (not all links) */
.graph-link.link-animated {
    stroke-dasharray: 8 4;
    animation: linkFlowAnimation 2s linear infinite;
}

.graph-link.highlighted {
    stroke: var(--accent);
    stroke-opacity: 1;
    stroke-width: 2px;
    stroke-dasharray: none;
    /* v4.5.2: Removed expensive infinite drop-shadow animation — caused flickering */
    filter: drop-shadow(0 0 3px var(--accent));
}

.graph-link.dimmed {
    stroke-opacity: 0.2;
    animation: none;
    stroke-dasharray: 4 2;
}

/* Fallback Table */
.graph-fallback {
    padding: var(--space-4);
}

.fallback-notice {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3);
    background: var(--warning-bg);
    color: var(--warning-text);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-3);
    font-size: 13px;
}

.fallback-table-container {
    max-height: 400px;
    overflow-y: auto;
}

/* =============================================================================
   v4.0.2: Graph Layout with Side Panel
   ============================================================================= */

.graph-layout-container {
    display: flex;
    gap: 0;
    /* v4.0.2: Fill available height in modal - calc accounts for header, tabs, controls */
    height: calc(100vh - 280px);
    min-height: 450px;
    max-height: 800px;
    position: relative;
}

.graph-layout-container .graph-container {
    flex: 1;
    min-width: 0;
    position: relative;
    border-radius: var(--radius-lg) 0 0 var(--radius-lg);
    overflow: hidden;
}

/* Make SVG fill the container */
.graph-layout-container .graph-container svg {
    width: 100%;
    height: 100%;
}

/* Enhanced Details Side Panel */
.graph-details-panel {
    display: flex;
    position: relative;
    transition: all 0.3s ease;
}

/* Toggle tab on the left edge - always visible */
.panel-toggle-tab {
    position: absolute;
    left: -28px;
    top: 50%;
    transform: translateY(-50%);
    width: 28px;
    height: 80px;
    background: linear-gradient(180deg, var(--bg-primary), var(--bg-secondary));
    border: 1px solid var(--border-default);
    border-right: none;
    border-radius: 8px 0 0 8px;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    padding: 0;
}

.panel-toggle-tab:hover {
    background: linear-gradient(180deg, var(--accent), var(--accent-light, #6366f1));
    color: white;
    width: 32px;
    left: -32px;
}

.panel-toggle-tab i,
.panel-toggle-tab svg {
    width: 16px;
    height: 16px;
    transition: transform 0.3s ease;
}

/* Panel content wrapper */
.details-panel-content {
    width: 380px;
    min-width: 380px;
    background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    border-left: 1px solid var(--border-default);
    border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: -4px 0 20px rgba(0, 0, 0, 0.05);
    transition: width 0.3s ease, min-width 0.3s ease, opacity 0.3s ease;
}

/* Hidden/collapsed state for the details panel */
.graph-details-panel.hidden .details-panel-content {
    width: 0;
    min-width: 0;
    opacity: 0;
    border-left: none;
}

.graph-details-panel.hidden .details-panel-header,
.graph-details-panel.hidden .details-panel-body {
    visibility: hidden;
}

.details-panel-header {
    display: flex;
    align-items: flex-start;
    padding: var(--space-4);
    background: linear-gradient(135deg, rgba(74, 144, 217, 0.08) 0%, rgba(39, 174, 96, 0.08) 100%);
    border-bottom: 1px solid var(--border-default);
    flex-shrink: 0;
}

.details-panel-title-row {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    flex: 1;
    min-width: 0;
}

.details-panel-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #4A90D9 0%, #357ABD 100%);
    color: white;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(74, 144, 217, 0.3);
}

.details-panel-icon.document {
    background: linear-gradient(135deg, #27AE60 0%, #1E8449 100%);
    box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
}

.details-panel-icon i,
.details-panel-icon svg {
    width: 24px;
    height: 24px;
}

.details-panel-title-group {
    flex: 1;
    min-width: 0;
}

.details-panel-title-group h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1.3;
    word-wrap: break-word;
}

.details-panel-subtitle {
    display: block;
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 2px;
}

.details-panel-actions {
    display: flex;
    gap: var(--space-1);
    flex-shrink: 0;
}

.details-panel-body {
    flex: 1;
    overflow-y: auto;
    padding: var(--space-4);
}

/* Empty State */
.details-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
    color: var(--text-muted);
    padding: var(--space-6);
}

.details-empty-icon {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--bg-elevated);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: var(--space-4);
}

.details-empty-icon i,
.details-empty-icon svg {
    width: 28px;
    height: 28px;
    color: var(--text-muted);
}

.details-empty-state p {
    font-size: 13px;
    line-height: 1.6;
    max-width: 280px;
}

/* Stats Cards */
.details-stats-row {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.details-stat-card {
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    text-align: center;
    border: 1px solid var(--border-subtle);
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.details-stat-card:hover {
    border-color: var(--border-default);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.details-stat-value {
    font-size: 28px;
    font-weight: 800;
    color: var(--text-primary);
    line-height: 1;
    margin-bottom: var(--space-1);
}

.details-stat-value.accent {
    background: linear-gradient(135deg, #4A90D9 0%, #27AE60 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.details-stat-label {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Category Badge */
.details-category-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 14px;
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    margin-bottom: var(--space-4);
    border: 1px solid;
}

/* Section Headers */
.details-section {
    margin-bottom: var(--space-4);
}

.details-section-header {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 12px;
    font-weight: 700;
    color: var(--text-primary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: var(--space-3);
    padding-bottom: var(--space-2);
    border-bottom: 2px solid var(--border-subtle);
}

.details-section-header i,
.details-section-header svg {
    width: 16px;
    height: 16px;
}

.details-section-header .section-count {
    margin-left: auto;
    background: var(--bg-elevated);
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: 11px;
    color: var(--text-secondary);
}

/* Connection List */
.details-connection-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.details-connection-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-subtle);
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    cursor: pointer;
}

.details-connection-item:hover {
    border-color: var(--border-default);
    background: var(--bg-surface);
    transform: translateX(4px);
}

.details-conn-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-2);
}

.details-conn-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    flex: 1;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.details-conn-badge {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: 10px;
    font-weight: 700;
    white-space: nowrap;
}

.details-conn-badge.mentions {
    background: rgba(74, 144, 217, 0.15);
    color: #4A90D9;
}

.details-conn-badge.shared {
    background: rgba(39, 174, 96, 0.15);
    color: #27AE60;
}

.details-conn-bar {
    height: 4px;
    background: var(--bg-surface);
    border-radius: 2px;
    overflow: hidden;
}

.details-conn-bar-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.details-conn-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.15),
        rgba(255, 255, 255, 0.4),
        rgba(255, 255, 255, 0.15),
        transparent
    );
    animation: energy-pulse 3s ease-in-out infinite;
}

.details-conn-bar-fill.role {
    background: linear-gradient(90deg, #4A90D9 0%, #357ABD 100%);
}

.details-conn-bar-fill.document {
    background: linear-gradient(90deg, #27AE60 0%, #1E8449 100%);
}

.details-conn-terms {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
}

.details-show-more {
    padding: var(--space-2);
    text-align: center;
    font-size: 12px;
    color: var(--accent);
    font-weight: 500;
    cursor: pointer;
    border-radius: var(--radius-md);
    /* transition: background removed - anti-flicker */
}

.details-show-more:hover {
    background: var(--bg-elevated);
}

/* =============================================================================
   v4.0.2: DRILL-DOWN FILTERING STYLES
   ============================================================================= */

/* Filter hint text */
.details-filter-hint {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 10px;
    color: var(--text-muted);
    margin: 0 0 8px;
    padding: 4px 8px;
    background: rgba(var(--accent-rgb, 74, 144, 217), 0.08);
    border-radius: var(--radius-sm);
    opacity: 0.8;
}

.details-filter-hint i,
.details-filter-hint svg {
    width: 12px;
    height: 12px;
}

/* Clickable drill-down targets */
.details-connection-item.drilldown-target {
    position: relative;
    cursor: pointer;
}

.details-connection-item.drilldown-target:hover {
    border-color: var(--accent);
    background: rgba(var(--accent-rgb, 74, 144, 217), 0.08);
    box-shadow: 0 2px 8px rgba(var(--accent-rgb, 74, 144, 217), 0.15);
}

.details-connection-item.drilldown-target:active {
    transform: translateX(2px) scale(0.99);
}

/* Filter indicator icon */
.drilldown-indicator {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0;
    transition: opacity 0.2s, transform 0.2s;
    color: var(--accent);
    background: var(--bg-primary);
    border-radius: var(--radius-sm);
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.drilldown-indicator i,
.drilldown-indicator svg {
    width: 14px;
    height: 14px;
}

.details-connection-item.drilldown-target:hover .drilldown-indicator {
    opacity: 1;
    transform: translateY(-50%) translateX(-4px);
}

/* =============================================================================
   v4.0.2: MINIMAL FILTER BAR - Compact, elegant filter indicator
   ============================================================================= */

.graph-filter-bar {
    display: none;
    position: absolute;
    top: 8px;
    left: 8px;
    z-index: 15;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border-radius: var(--radius-full);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0, 0, 0, 0.04);
    padding: 4px 6px;
    align-items: center;
    gap: 2px;
    font-size: 11px;
    max-width: calc(100% - 16px);
}

/* Force all icons in filter bar to be small */
.graph-filter-bar svg,
.graph-filter-bar i {
    width: 14px !important;
    height: 14px !important;
}

.graph-container.graph-filtered .graph-filter-bar {
    display: flex;
}

.filter-bar-path {
    display: flex;
    align-items: center;
    gap: 2px;
    overflow: hidden;
}

.filter-bar-item {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 3px 8px;
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
    white-space: nowrap;
    max-width: 140px;
    color: var(--text-secondary);
    font-weight: 500;
}

.filter-bar-item:hover {
    background: rgba(0, 0, 0, 0.05);
}

.filter-bar-item.home {
    padding: 3px 5px;
    color: var(--text-muted);
}

.filter-bar-item.home:hover {
    color: var(--text-primary);
    background: rgba(0, 0, 0, 0.05);
}

.filter-bar-item i,
.filter-bar-item svg {
    width: 12px;
    height: 12px;
    flex-shrink: 0;
}

.filter-bar-item.role i,
.filter-bar-item.role svg { color: #4A90D9; }

.filter-bar-item.document i,
.filter-bar-item.document svg { color: #27AE60; }

.filter-bar-item.active {
    background: linear-gradient(135deg, var(--accent) 0%, #357ABD 100%);
    color: white;
    font-weight: 500;
    box-shadow: 0 1px 3px rgba(74, 144, 217, 0.3);
}

.filter-bar-item.active i,
.filter-bar-item.active svg { color: white !important; }

.filter-bar-icon {
    font-size: 14px;
    line-height: 1;
    flex-shrink: 0;
}

/* Enhance person icon specifically - it tends to wash out */
.filter-bar-item.role .filter-bar-icon {
    filter: saturate(2) contrast(1.3) brightness(0.9);
    text-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
}

/* Document icon enhancement */
.filter-bar-item.document .filter-bar-icon {
    filter: saturate(1.4) contrast(1.15);
}

.filter-bar-label {
    overflow: hidden;
    text-overflow: ellipsis;
}

.filter-bar-sep {
    color: var(--text-muted);
    opacity: 0.4;
    font-size: 10px;
    margin: 0 1px;
}

.filter-bar-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    margin-left: 4px;
}

.filter-bar-close:hover {
    background: rgba(0, 0, 0, 0.08);
    color: var(--text-primary);
}

.filter-bar-close i,
.filter-bar-close svg {
    width: 10px !important;
    height: 10px !important;
}

.filter-bar-count {
    padding: 2px 7px;
    background: rgba(74, 144, 217, 0.12);
    border-radius: var(--radius-full);
    color: var(--accent);
    font-size: 10px;
    font-weight: 600;
    margin-left: 6px;
}

/* Node icon enhancements for graph */
.node-icon-char {
    font-size: 14px;
}

.node-icon-person {
    filter: saturate(2) contrast(1.4) brightness(0.85);
    text-shadow: 0 0 3px rgba(0, 0, 0, 0.25);
}

.node-icon-document {
    filter: saturate(1.3);
}

/* =============================================================================
   v4.0.2: FOCUS MODE - Enhanced visual state when filtered
   ============================================================================= */

/* Subtle vignette effect when filtered */
.graph-container.graph-filtered::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.03) 100%);
    z-index: 1;
}

/* Graph container filtered state */
.graph-container.graph-filtered {
    border-color: var(--accent);
}

/* Filtered node states */
.graph-node.filter-hidden {
    pointer-events: none;
}

/* Enhanced visible nodes in filtered mode */
.graph-container.graph-filtered .graph-node.filter-visible circle {
    stroke-width: 2.5px !important;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
}

/* Icon nodes for filtered state */
.graph-node .node-icon {
    display: none;
    pointer-events: none;
}

.graph-container.graph-filtered .graph-node.filter-visible .node-icon {
    display: block;
}

.graph-container.graph-filtered .graph-node.filter-visible .node-icon text {
    font-family: 'Lucide', system-ui, sans-serif;
    fill: white;
    font-size: 12px;
    text-anchor: middle;
    dominant-baseline: central;
}

/* Pulse animation for the focused node */
@keyframes focusPulse {
    0%, 100% { transform: scale(1); filter: drop-shadow(0 0 0 transparent); }
    50% { transform: scale(1.02); filter: drop-shadow(0 0 8px rgba(74, 144, 217, 0.3)); }
}

.graph-container.graph-filtered .graph-node.filter-visible.selected circle {
    animation: focusPulse 2s ease-in-out infinite;
}

/* Connection glow for filtered links */
.graph-container.graph-filtered .graph-link:not(.filter-hidden) {
    filter: drop-shadow(0 0 2px rgba(74, 144, 217, 0.2));
}

/* Animation for filter transitions */
@keyframes filterPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.graph-node.filter-visible {
    animation: filterPulse 0.3s ease-out;
}

/* Explanation Box */
.details-explanation {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    padding: var(--space-3);
    background: linear-gradient(135deg, rgba(74, 144, 217, 0.08) 0%, rgba(39, 174, 96, 0.05) 100%);
    border-radius: var(--radius-md);
    border-left: 3px solid var(--accent);
    margin-bottom: var(--space-4);
}

.details-explanation i,
.details-explanation svg {
    width: 16px;
    height: 16px;
    color: var(--accent);
    flex-shrink: 0;
    margin-top: 1px;
}

.details-explanation p {
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.6;
    margin: 0;
}

.details-explanation strong {
    color: var(--text-primary);
    font-weight: 600;
}

/* Legend Footer */
.details-legend {
    margin-top: auto;
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-subtle);
}

.details-legend-title {
    font-size: 10px;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: var(--space-2);
}

.details-legend-items {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
}

.details-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--text-secondary);
}

.details-legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
}

.details-legend-dot.role {
    background: linear-gradient(135deg, #4A90D9 0%, #357ABD 100%);
}

.details-legend-dot.document {
    background: linear-gradient(135deg, #27AE60 0%, #1E8449 100%);
}

.details-legend-line {
    width: 20px;
    height: 3px;
    background: var(--text-muted);
    border-radius: 2px;
    flex-shrink: 0;
}

/* Responsive */
@media (max-width: 1100px) {
    .graph-layout-container {
        flex-direction: column;
        height: auto;
    }

    .graph-layout-container .graph-container {
        border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        height: 450px;
    }

    .graph-details-panel {
        width: 100%;
        min-width: 100%;
        border-left: none;
        border-top: 1px solid var(--border-default);
        border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        max-height: 400px;
    }
}

/* Legacy Info Panel styles - kept for compatibility */
.graph-info-panel {
    display: none !important; /* Hide old panel, use new one */
}

.info-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-2) var(--space-3);
    border-bottom: 1px solid var(--border-default);
    font-weight: 600;
}

.info-panel-body {
    padding: var(--space-3);
    max-height: 300px;
    overflow-y: auto;
}

.info-panel-body p {
    margin: 0 0 var(--space-2);
    font-size: 13px;
}

.info-panel-body strong {
    color: var(--text-primary);
}

.connection-item {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    padding: 2px 0;
}

.connection-item .weight {
    color: var(--text-muted);
}

.info-type-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
}

.info-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-bottom: 12px;
}

.info-stat {
    background: var(--bg-subtle);
    border-radius: var(--radius-md);
    padding: 10px;
    text-align: center;
}

.info-stat-value {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1;
}

.info-stat-label {
    font-size: 10px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 4px;
}

.info-category {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    margin-bottom: 12px;
}

.info-explanation {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    padding: 10px;
    background: var(--bg-subtle);
    border-radius: var(--radius-md);
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.5;
    margin-bottom: 12px;
}

.info-explanation i {
    flex-shrink: 0;
    margin-top: 2px;
    color: var(--text-muted);
}

.info-section-header {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 8px;
    padding-top: 8px;
    border-top: 1px solid var(--border-subtle);
}

.info-connections-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-bottom: 12px;
}

.info-connection-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.info-conn-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.info-conn-label {
    font-size: 12px;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.info-conn-weight {
    font-size: 11px;
    color: var(--text-muted);
    white-space: nowrap;
    margin-left: 8px;
}

.info-conn-bar-bg {
    height: 3px;
    background: var(--bg-subtle);
    border-radius: 2px;
    overflow: hidden;
}

.info-conn-bar {
    height: 100%;
    border-radius: 2px;
    transition: width 0.3s ease;
}

.info-conn-terms {
    font-size: 10px;
    color: var(--text-muted);
    font-style: italic;
}

.info-conn-more {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: 4px 0;
}

.info-legend {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--border-subtle);
}

.info-legend-title {
    font-size: 10px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
}

.info-legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    color: var(--text-secondary);
    margin-bottom: 4px;
}

.info-legend-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

.info-legend-line {
    width: 20px;
    height: 3px;
    background: linear-gradient(90deg, var(--text-muted) 0%, var(--text-muted) 100%);
    border-radius: 2px;
    flex-shrink: 0;
}

/* Graph Tooltip */
.graph-tooltip {
    position: absolute;
    padding: var(--space-2) var(--space-3);
    background: var(--bg-primary);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-md);
    font-size: 12px;
    pointer-events: none;
    z-index: 100;
    max-width: 250px;
}

.graph-tooltip .tooltip-title {
    font-weight: 600;
    margin-bottom: var(--space-1);
}

.graph-tooltip .tooltip-type {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
}

.graph-tooltip .tooltip-stats {
    margin-top: var(--space-1);
    font-size: 11px;
    color: var(--text-secondary);
}

/* v2.9.3 B17: Edge tooltip connection display */
.graph-tooltip .tooltip-connection {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) 0;
    margin: var(--space-1) 0;
    border-top: 1px solid var(--border-subtle);
    border-bottom: 1px solid var(--border-subtle);
}

.graph-tooltip .tooltip-role {
    font-weight: 500;
    color: var(--accent);
    max-width: 80px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.graph-tooltip .tooltip-arrow {
    color: var(--text-muted);
    font-size: 14px;
}


/* ============================================================
   BATCH E3: Role Graph Enhancements (v2.9.0)
   ============================================================ */

/* Link type styles with dash patterns */
.graph-link.link-role-role {
    stroke: var(--accent);
    stroke-opacity: 0.8;
}

.graph-link.link-role-document {
    stroke: var(--border-emphasis);
}

.graph-link.link-role-deliverable {
    stroke: var(--success);
    stroke-opacity: 0.7;
}

.graph-link.link-approval {
    stroke: var(--warning);
}

.graph-link.link-coordination {
    stroke: var(--info);
}

.graph-link.link-reports-to {
    stroke: #9333ea; /* Purple for hierarchy */
}

.graph-link.link-supports {
    stroke: var(--text-muted);
}

/* Enhanced link hover/highlight states */
.graph-link.highlighted {
    stroke: var(--accent) !important;
    stroke-opacity: 1 !important;
    stroke-width: 3px !important;
    filter: drop-shadow(0 0 3px var(--accent));
}

/* Node glow effects */
.graph-node.glow-enabled.selected circle {
    filter: url(#node-glow);
    transition: filter 0.3s ease;
}

.graph-node.glow-enabled.connected circle {
    filter: url(#node-highlight-glow);
}

/* Smooth node transitions */
.graph-node circle {
    transition: r 0.3s ease, fill 0.3s ease, filter 0.3s ease;
}

.graph-node.selected circle {
    stroke: var(--accent);
    stroke-width: 3px;
}

.graph-node.connected circle {
    stroke: var(--accent);
    stroke-width: 2px;
    stroke-opacity: 0.6;
}

/* v3.0.77: Weak connection nodes - visible but styled differently */
.graph-node.weak-connection circle {
    stroke-width: 2px;
    stroke-dasharray: 3,2;
}

.graph-node.weak-connection .graph-node-label {
    opacity: 0.7;
    font-size: 10px;
}

/* v3.0.77: Enhanced graph legend */
.graph-legend-enhanced {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) var(--space-3);
    background: var(--bg-surface);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    font-size: 12px;
    margin-bottom: var(--space-2);
}

.graph-legend-section {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.graph-legend-section-title {
    font-weight: 600;
    color: var(--text-secondary);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.legend-visual-example {
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

.legend-node-small {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
}

.legend-node-medium {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    display: inline-block;
}

.legend-node-large {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: inline-block;
}

.legend-line-solid {
    width: 24px;
    height: 3px;
    background: #4A90D9;
    display: inline-block;
    border-radius: 2px;
}

.legend-line-dashed {
    width: 24px;
    height: 3px;
    background: repeating-linear-gradient(
        90deg,
        #7c3aed 0px,
        #7c3aed 4px,
        transparent 4px,
        transparent 7px
    );
    display: inline-block;
}

.legend-line-thin {
    width: 24px;
    height: 1px;
    background: var(--text-muted);
    display: inline-block;
}

.legend-line-thick {
    width: 24px;
    height: 4px;
    background: var(--text-muted);
    display: inline-block;
    border-radius: 2px;
}

.legend-node-weak {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px dashed #4A90D9;
    background: rgba(74, 144, 217, 0.3);
    display: inline-block;
}

.legend-node-strong {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #4A90D9;
    border: 1px solid #4A90D9;
    display: inline-block;
}

.graph-first-time-hint {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: linear-gradient(90deg, rgba(74, 144, 217, 0.1), transparent);
    border-left: 3px solid var(--accent);
    border-radius: var(--radius-sm);
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: var(--space-2);
}

.graph-first-time-hint i {
    color: var(--accent);
    width: 16px;
    height: 16px;
}

.graph-first-time-hint .dismiss-hint {
    margin-left: auto;
    cursor: pointer;
    opacity: 0.5;
    transition: opacity 0.2s;
}

.graph-first-time-hint .dismiss-hint:hover {
    opacity: 1;
}

/* Performance mode - simplified rendering */
.graph-container.performance-mode .graph-link {
    stroke-dasharray: none !important;
    transition: none !important;
}

.graph-container.performance-mode .graph-node circle {
    transition: none !important;
}

.graph-container.performance-mode .graph-node.selected circle,
.graph-container.performance-mode .graph-node.connected circle {
    filter: none !important;
}

/* Performance notice - v4.0.2: Smaller, top-left, only shows in performance mode */
.graph-performance-notice {
    display: none !important;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-2);
    background: rgba(var(--bg-elevated-rgb, 255, 255, 255), 0.9);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-sm);
    font-size: 10px;
    color: var(--text-muted);
    position: absolute;
    top: var(--space-2);
    left: var(--space-2);
    z-index: 5;
    backdrop-filter: blur(4px);
}

.graph-container.performance-mode .graph-performance-notice {
    display: flex !important;
}

.graph-performance-notice i {
    width: 12px;
    height: 12px;
    color: var(--warning);
}

/* Link legend */
.graph-link-legend {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    padding: var(--space-2);
    background: var(--bg-surface);
    border-radius: var(--radius-md);
    margin-top: var(--space-2);
    font-size: 11px;
}

.link-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 2px 8px;
    background: var(--bg-elevated);
    border-radius: var(--radius-sm);
}

.link-legend-line {
    width: 24px;
    height: 2px;
}

.link-legend-line.solid {
    background: var(--border-emphasis);
}

.link-legend-line.dashed {
    background: repeating-linear-gradient(
        90deg,
        var(--success) 0px,
        var(--success) 8px,
        transparent 8px,
        transparent 12px
    );
}

.link-legend-line.dotted {
    background: repeating-linear-gradient(
        90deg,
        var(--info) 0px,
        var(--info) 4px,
        transparent 4px,
        transparent 8px
    );
}

/* Animated pulse for selected nodes */
@keyframes nodePulse {
    0% {
        stroke-opacity: 1;
    }
    50% {
        stroke-opacity: 0.5;
    }
    100% {
        stroke-opacity: 1;
    }
}

.glow-enabled .graph-node.selected circle {
    animation: nodePulse 2s ease-in-out infinite;
}

/* Dark mode adjustments for graph */
.dark-mode .graph-link.link-role-role {
    stroke: var(--accent-light);
}

.dark-mode .graph-link.link-role-deliverable {
    stroke: #4ade80;
}

.dark-mode .graph-link.link-reports-to {
    stroke: #a855f7;
}

.dark-mode .graph-link.highlighted {
    filter: drop-shadow(0 0 4px var(--accent));
}


/* ===== v4.5.1: HIERARCHICAL EDGE BUNDLING (HEB) + SEMANTIC ZOOM ===== */

/* --- Bundling Tension Slider --- */
#bundling-tension-group {
    transition: opacity 0.3s ease;
}
#bundling-tension-group.hidden {
    display: none !important;
}
#graph-bundling-value {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-secondary);
    min-width: 28px;
    text-align: center;
}

/* --- HEB Legend --- */
.graph-legend-heb {
    transition: opacity 0.3s ease;
}
.legend-arc-sample {
    display: inline-block;
    width: 20px;
    height: 8px;
    border-radius: 4px;
    background: linear-gradient(90deg, #27AE60, #4A90D9, #E74C3C);
    opacity: 0.7;
}
.legend-curve-sample {
    display: inline-block;
    width: 24px;
    height: 10px;
    position: relative;
}
.legend-curve-sample::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 24px;
    height: 10px;
    border: 2px solid var(--text-secondary);
    border-color: transparent transparent var(--text-secondary) transparent;
    border-radius: 0 0 50% 50%;
    opacity: 0.5;
}
.legend-line-dim {
    display: inline-block;
    width: 16px;
    height: 2px;
    background: var(--text-secondary);
    opacity: 0.2;
    border-radius: 1px;
}
.legend-line-bright {
    display: inline-block;
    width: 16px;
    height: 2px;
    background: var(--accent, #4A90D9);
    opacity: 0.9;
    border-radius: 1px;
}

/* --- HEB Document Group Arcs --- */
.heb-group-arc {
    fill-opacity: 0.08;
    stroke-opacity: 0.3;
    stroke-width: 1.5px;
    cursor: pointer;
    transition: fill-opacity 0.2s ease, stroke-opacity 0.2s ease;
}
.heb-group-arc:hover {
    fill-opacity: 0.18;
    stroke-opacity: 0.6;
}
.heb-group-arc.active {
    fill-opacity: 0.22;
    stroke-opacity: 0.8;
    stroke-width: 2.5px;
}

/* --- HEB Document Group Labels --- */
.heb-group-label {
    font-size: 11px;
    font-weight: 600;
    fill: var(--text-secondary, #6b7280);
    pointer-events: none;
    user-select: none;
}

/* --- HEB Edges (bundled paths) --- */
.heb-edge {
    fill: none;
    stroke-opacity: 0.15;
    stroke-width: 1.5px;
    pointer-events: stroke;
    transition: stroke-opacity 0.15s ease;
    /* v4.5.2: Removed mix-blend-mode: screen — caused compositing flicker on some GPUs.
       Using increased stroke-opacity values instead for visibility. */
}
.heb-edge:hover {
    stroke-opacity: 0.7;
    stroke-width: 2.5px;
}
.heb-edge.highlighted {
    stroke-opacity: 0.85;
    stroke-width: 2.5px;
}
.heb-edge.dimmed {
    stroke-opacity: 0.03;
}
.heb-edge.search-match {
    stroke-opacity: 0.6;
    stroke-width: 2px;
}
.heb-edge.weight-hidden {
    display: none;
}

/* --- HEB Nodes --- */
.heb-node circle {
    transition: r 0.2s ease, fill-opacity 0.15s ease, stroke-width 0.15s ease;
    cursor: pointer;
    stroke-width: 1.5px;
}
.heb-node circle:hover {
    stroke-width: 2.5px;
}
.heb-node.highlighted circle {
    fill-opacity: 1;
    stroke-width: 2.5px;
}
.heb-node.dimmed circle {
    fill-opacity: 0.15;
    stroke-width: 0.5px;
}
.heb-node.selected circle {
    stroke: var(--warning, #F59E0B);
    stroke-width: 3px;
    filter: drop-shadow(0 0 4px rgba(245, 158, 11, 0.5));
}
.heb-node.search-match circle {
    stroke: var(--accent, #4A90D9);
    stroke-width: 3px;
    filter: drop-shadow(0 0 4px var(--accent, #4A90D9));
}

/* --- HEB Node Labels --- */
.heb-node-label {
    font-size: 10px;
    fill: var(--text-primary, #1f2937);
    pointer-events: none;
    user-select: none;
    paint-order: stroke fill;
    stroke: var(--bg-surface, #ffffff);
    stroke-width: 3px;
    stroke-linejoin: round;
    transition: opacity 0.15s ease;
}
.heb-node-label.dimmed {
    opacity: 0.1;
}
.heb-node-label.hidden {
    display: none;
}

/* --- LOD (Semantic Zoom) Cluster Circles --- */
.lod-cluster {
    fill-opacity: 0.12;
    stroke-width: 2px;
    cursor: pointer;
    transition: fill-opacity 0.5s ease, stroke-width 0.3s ease, r 0.5s ease;
}
.lod-cluster:hover {
    fill-opacity: 0.25;
    stroke-width: 3px;
}
.lod-cluster.active {
    fill-opacity: 0.3;
    stroke-width: 3px;
}

/* --- LOD Cluster Labels --- */
.lod-cluster-label {
    font-size: 13px;
    font-weight: 600;
    fill: var(--text-primary, #1f2937);
    text-anchor: middle;
    pointer-events: none;
    user-select: none;
    paint-order: stroke fill;
    stroke: var(--bg-surface, #ffffff);
    stroke-width: 3px;
    stroke-linejoin: round;
    transition: opacity 0.5s ease;
}

/* --- LOD Inter-cluster Edges --- */
.lod-cluster-edge {
    fill: none;
    stroke-opacity: 0.25;
    transition: stroke-opacity 0.5s ease;
}
.lod-cluster-edge:hover {
    stroke-opacity: 0.6;
}

/* --- LOD Galaxy Dots (decorative role hints inside clusters) --- */
.lod-galaxy-dot {
    pointer-events: none;
    transition: opacity 0.5s ease;
}

/* --- HEB Performance Mode --- */
.graph-container.performance-mode .heb-edge {
    mix-blend-mode: normal;
    transition: none;
}
.graph-container.performance-mode .heb-node circle {
    transition: none;
}
.graph-container.performance-mode .heb-node-label {
    transition: none;
}
.graph-container.performance-mode .lod-cluster {
    transition: none;
}

/* --- Dark Mode Overrides for HEB --- */
.dark-mode .heb-node-label {
    fill: var(--text-primary, #e5e7eb);
    stroke: var(--bg-surface, #1f2937);
}
.dark-mode .heb-group-label {
    fill: var(--text-secondary, #9ca3af);
}
.dark-mode .heb-edge {
    /* v4.5.2: Removed mix-blend-mode: screen — causes compositing flicker.
       Using slightly higher base opacity for dark mode visibility instead. */
    stroke-opacity: 0.2;
}
.dark-mode .lod-cluster-label {
    fill: var(--text-primary, #e5e7eb);
    stroke: var(--bg-surface, #1f2937);
}
.dark-mode .legend-curve-sample::after {
    border-color: transparent transparent var(--text-secondary, #9ca3af) transparent;
}
.dark-mode .legend-line-dim {
    background: var(--text-secondary, #9ca3af);
}

/* v4.5.2: Light mode HEB edges — no blend mode needed, using standard opacity */
body:not(.dark-mode) .heb-edge {
    stroke-opacity: 0.18;
}

/* --- HEB Label Visibility Modes --- */
.graph-container.labels-none .heb-node-label {
    display: none;
}
.graph-container.labels-selected .heb-node-label {
    display: none;
}
.graph-container.labels-selected .heb-node.selected .heb-node-label,
.graph-container.labels-selected .heb-node.highlighted .heb-node-label,
.graph-container.labels-selected .heb-node.search-match .heb-node-label {
    display: block;
}
.graph-container.labels-hover .heb-node-label {
    display: none;
}
.graph-container.labels-hover .heb-node:hover .heb-node-label {
    display: block;
}
.graph-container.labels-all .heb-node-label {
    display: block;
}

/* ===== END v4.5.1: HEB + SEMANTIC ZOOM ===== */

/* ===== v5.1.0: SEMANTIC ZOOM — RELATIONSHIP GRAPH (LOD 2/3) ===== */

.sz-container-bg {
    transition: stroke-width 0.2s, fill 0.2s;
}
.sz-container-group:hover .sz-container-bg {
    stroke-width: 2.5;
    filter: brightness(1.1);
}
.sz-container-label {
    pointer-events: none;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}
.sz-container-count {
    pointer-events: none;
}
.sz-cross-link {
    transition: stroke-opacity 0.2s, stroke-width 0.2s;
    pointer-events: none;
}
.sz-role-node circle {
    cursor: pointer;
    transition: stroke-width 0.15s, r 0.15s, filter 0.15s;
}
.sz-role-node:hover circle {
    filter: brightness(1.3) drop-shadow(0 0 4px rgba(255,255,255,0.3));
}
.sz-role-label {
    pointer-events: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.6);
}
[data-theme="dark"] .sz-role-label {
    fill: #ccc;
}
[data-theme="dark"] .sz-container-label {
    fill: #eee;
}

/* --- Semantic Zoom Label Visibility Modes --- */
.graph-container.labels-none .sz-role-label {
    opacity: 0 !important;
    pointer-events: none;
}
.graph-container.labels-selected .sz-role-label {
    opacity: 0 !important;
    pointer-events: none;
}
.graph-container.labels-selected .sz-role-node.sz-selected .sz-role-label,
.graph-container.labels-selected .sz-role-node.sz-connected .sz-role-label {
    opacity: 1 !important;
}
.graph-container.labels-hover .sz-role-label {
    opacity: 0 !important;
    pointer-events: none;
}
.graph-container.labels-hover .sz-role-node:hover .sz-role-label {
    opacity: 1 !important;
}
.graph-container.labels-all .sz-role-label {
    opacity: 1 !important;
}

/* --- Semantic Zoom Selection Animation --- */
.sz-role-node.sz-dimmed circle {
    opacity: 0.15;
    filter: grayscale(0.8);
}
.sz-role-node.sz-dimmed .sz-role-label {
    opacity: 0 !important;
}
.sz-role-node.sz-selected circle {
    filter: brightness(1.4) drop-shadow(0 0 8px rgba(255,255,255,0.5));
}
.sz-role-node.sz-connected circle {
    filter: brightness(1.2) drop-shadow(0 0 4px rgba(255,255,255,0.25));
}
.sz-container-group.sz-container-dimmed .sz-container-bg {
    opacity: 0.2;
}
.sz-container-group.sz-container-dimmed .sz-container-label,
.sz-container-group.sz-container-dimmed .sz-container-count {
    opacity: 0.2;
}
.sz-container-group.sz-container-active .sz-container-bg {
    stroke-width: 2.5;
    filter: brightness(1.15);
}

/* ===== END v5.1.0: SEMANTIC ZOOM RELATIONSHIP GRAPH ===== */


/* ============================================================
   ROLE DICTIONARY STYLES
   ============================================================ */

.dictionary-header {
    margin-bottom: var(--space-3);
    flex-shrink: 0;
}

.dictionary-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.dictionary-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    flex-shrink: 0;
    margin-bottom: var(--space-3);
}

.dictionary-stats {
    display: flex;
    gap: var(--space-4);
    margin-bottom: var(--space-3);
    padding: var(--space-2) 0;
}

.dict-stat {
    font-size: 13px;
    color: var(--text-secondary);
}

.dict-stat strong {
    color: var(--text-primary);
    font-size: 16px;
}

.dictionary-table-container {
    overflow-y: auto;
    flex: 1;
    min-height: 120px;
}

#dictionary-table td {
    vertical-align: top;
}

/* Dictionary table action buttons */
#dictionary-table .btn-ghost {
    padding: 4px;
    border-radius: var(--radius-sm);
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

#dictionary-table .btn-ghost svg {
    width: 14px;
    height: 14px;
}

#dictionary-table .btn-ghost:hover {
    background: var(--bg-hover);
}

#dictionary-table .btn-ghost.btn-danger {
    color: var(--text-muted, #9ca3af);
}

#dictionary-table .btn-ghost.btn-danger:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.inactive-row {
    opacity: 0.6;
    background: var(--bg-elevated);
}

/* Category badges */
.category-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 500;
    background: var(--bg-elevated);
    color: var(--text-secondary);
}

/* Source badges */
.source-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 500;
}

/* Status badges */
.status-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
}

.status-badge.active,
.status-badge.status-active {
    background: var(--success, #10b981);
    color: white;
}

.status-badge.inactive,
.status-badge.status-inactive {
    background: var(--text-muted, #9ca3af);
    color: white;
}

/* Dictionary empty state */
.dictionary-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-6);
    flex-shrink: 0;
    color: var(--text-muted);
    text-align: center;
}

.dictionary-empty i {
    width: 48px;
    height: 48px;
    margin-bottom: var(--space-3);
}

/* Import dropzone */
.import-dropzone {
    border: 2px dashed var(--border-default);
    border-radius: var(--radius-md);
    padding: var(--space-4);
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.import-dropzone:hover,
.import-dropzone.drag-over,
.import-dropzone.dragover {
    border-color: var(--accent);
    background: var(--bg-elevated);
}

.import-dropzone i {
    width: 32px;
    height: 32px;
    color: var(--text-muted);
}

.import-format-help {
    margin-top: var(--space-3);
    padding: var(--space-2);
    background: var(--bg-elevated);
    border-radius: var(--radius-sm);
    font-size: 12px;
    color: var(--text-muted);
}

.import-format-help p {
    margin: var(--space-1) 0;
}

/* v2.9.1 D2: Smart Import Wizard Progress Steps */
.import-wizard-progress {
    border-top: 1px solid var(--border-color);
    padding-top: var(--space-3);
}

.progress-steps {
    display: flex;
    justify-content: space-between;
    gap: 4px;
}

.progress-step {
    flex: 1;
    text-align: center;
    padding: 8px 4px;
    font-size: 11px;
    color: var(--text-muted);
    background: var(--bg-elevated);
    border-radius: var(--radius-sm);
    transition: all 0.2s;
}

.progress-step.active {
    background: var(--accent);
    color: white;
}

.progress-step.current {
    font-weight: 600;
    box-shadow: 0 0 0 2px var(--accent);
}

/* Import wizard step content */
.import-wizard-step h4 {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0 0 12px 0;
}

.import-wizard-step h4 i {
    width: 20px;
    height: 20px;
    color: var(--accent);
}

.column-mapping-grid {
    background: var(--bg-elevated);
    padding: var(--space-3);
    border-radius: var(--radius-md);
}

.import-preview-summary {
    background: var(--success-bg, #E8F5E9);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
    border-left: 4px solid var(--success);
}

.import-complete-result .success-icon i {
    color: var(--success);
}

.analysis-stats {
    background: var(--bg-elevated);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
}

/* Form styling for modals */
.form-group {
    margin-bottom: var(--space-3);
}

.form-group label {
    display: block;
    margin-bottom: var(--space-1);
    font-weight: 500;
    font-size: 13px;
}

.form-textarea {
    width: 100%;
    padding: var(--space-2);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-sm);
    font-family: inherit;
    font-size: 14px;
    resize: vertical;
}

/* Ghost danger button - transparent with red icon, red bg on hover */
.btn-ghost.btn-danger,
.btn.btn-ghost.btn-danger {
    background: transparent !important;
    border-color: transparent !important;
    color: var(--text-muted, #9ca3af);
}

.btn-ghost.btn-danger:hover,
.btn.btn-ghost.btn-danger:hover {
    background: rgba(239, 68, 68, 0.1) !important;
    color: var(--error, #ef4444) !important;
}

.btn-ghost.btn-danger svg,
.btn.btn-ghost.btn-danger svg {
    color: inherit;
}

/* Ensure icon sizes are correct in action buttons */
.btn-ghost.btn-xs svg,
.btn.btn-ghost.btn-xs svg {
    width: 14px;
    height: 14px;
}

/* ============================================================
   DICTIONARY SHARING STYLES
   ============================================================ */

.dictionary-sharing-info {
    display: none;
    align-items: center;
    padding: var(--space-2) var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-3);
    border-left: 3px solid var(--accent);
    flex-shrink: 0;
}

.sharing-status {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 13px;
    color: var(--text-secondary);
}

.sharing-status i {
    width: 16px;
    height: 16px;
    color: var(--accent);
}

.btn-group {
    display: flex;
    gap: 0;
}

.btn-group .btn:first-child {
    border-radius: var(--radius-sm) 0 0 var(--radius-sm);
}

.btn-group .btn:last-child {
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.btn-group .btn:not(:last-child) {
    border-right: 1px solid var(--border-muted);
}

.btn-divider {
    width: 1px;
    height: 24px;
    background: var(--border-muted);
    margin: 0 var(--space-2);
}

/* Source badge for master_sync */

/* ============================================================
   SHARING SETTINGS STYLES
   ============================================================ */

.sharing-settings-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-1);
}

.radio-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-top: var(--space-2);
}

.radio-label {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-sm);
    /* transition: background removed - anti-flicker */
}

.radio-label:hover {
    background: var(--bg-elevated);
}

.radio-label input[type="radio"] {
    width: 16px;
    height: 16px;
}

.shared-path-group {
    margin-top: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    border-left: 3px solid var(--accent);
}

.input-with-button {
    display: flex;
    gap: var(--space-2);
}

.input-with-button .form-input {
    flex: 1;
}

.path-status {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-top: var(--space-2);
    padding: var(--space-2);
    border-radius: var(--radius-sm);
    font-size: 13px;
}

.path-status i {
    width: 16px;
    height: 16px;
}

.path-status.success {
    background: rgba(76, 175, 80, 0.1);
    color: var(--success);
}

.path-status.error {
    background: rgba(244, 67, 54, 0.1);
    color: var(--error);
}

.path-status.checking {
    background: var(--bg-elevated);
    color: var(--text-muted);
}

.sharing-status-panel {
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    padding: var(--space-3);
}

.status-row {
    display: flex;
    justify-content: space-between;
    padding: var(--space-1) 0;
    border-bottom: 1px solid var(--border-muted);
}

.status-row:last-child {
    border-bottom: none;
}

.status-label {
    color: var(--text-secondary);
    font-size: 13px;
}

.status-value {
    font-weight: 500;
    font-size: 13px;
}

.sharing-help {
    background: var(--bg-elevated);
}

.sharing-help h5 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.sharing-help h5 i {
    width: 14px;
    height: 14px;
    color: var(--accent);
}


/* ============================================================
   F15: ENHANCED ROLES CARD
   ============================================================ */

.roles-card-enhanced,
#roles-card-enhanced {
    background: var(--bg-secondary, #16213e);
    border-radius: 12px;
    padding: 16px;
    border: 1px solid var(--border-default, rgba(255,255,255,0.1));
}

.roles-enhanced-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 14px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-default, rgba(255,255,255,0.1));
}

.roles-enhanced-header h3 {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary, #e0e0e0);
}

.roles-enhanced-header h3 i {
    width: 18px;
    height: 18px;
    color: var(--accent-blue, #4dabf7);
}

/* Mini Network Graph */
.roles-network-graph-container {
    height: 160px;
    background: var(--bg-tertiary, #1f2937);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 14px;
    position: relative;
}

.mini-graph-svg {
    width: 100%;
    height: 100%;
}

.mini-graph-link {
    stroke: rgba(255,255,255,0.15);
    stroke-opacity: 0.6;
}

.mini-graph-node circle {
    stroke: rgba(255,255,255,0.3);
    stroke-width: 1.5px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.mini-graph-node circle:hover {
    stroke: #fff;
    stroke-width: 2px;
    filter: brightness(1.2);
}

.graph-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    color: var(--text-secondary, #a0a0a0);
    font-size: 11px;
}

.graph-loading .spinner {
    width: 24px;
    height: 24px;
    border: 2px solid rgba(255,255,255,0.1);
    border-top-color: var(--accent-blue, #4dabf7);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Stats Row */
.roles-stats-row {
    display: flex;
    gap: 10px;
    margin-bottom: 14px;
}

.stat-card {
    flex: 1;
    background: var(--bg-tertiary, #1f2937);
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.stat-card.clickable {
    cursor: pointer;
}

.stat-card.clickable:hover {
    background: var(--bg-hover, rgba(255,255,255,0.08));
    transform: translateY(-1px);
}

.stat-value {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-primary, #e0e0e0);
    line-height: 1.2;
}

.stat-label {
    font-size: 10px;
    color: var(--text-secondary, #a0a0a0);
    text-transform: uppercase;
    letter-spacing: 0.3px;
    margin-top: 2px;
}

.stat-bar-fill.confidence {
    background: var(--accent-green, #51cf66);
}

/* v3.4.0: Enhanced clickable stat cards for Data Explorer */
.stat-card-clickable {
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.stat-card-clickable::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--accent, #4A90D9), var(--success, #51cf66));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.stat-card-clickable:hover {
    background: var(--bg-hover, rgba(255,255,255,0.08));
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.stat-card-clickable:hover::before {
    opacity: 1;
}

.stat-hint {
    font-size: 10px;
    color: var(--accent, #4A90D9);
    margin-top: 6px;
    opacity: 0;
    transform: translateY(5px);
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.stat-card-clickable:hover .stat-hint {
    opacity: 1;
    transform: translateY(0);
}

.btn-explore {
    background: linear-gradient(135deg, var(--accent, #4A90D9), #6366f1);
    border: none;
    color: #fff;
    border-radius: 8px;
    font-weight: 500;
    transition: color 0.3s ease, opacity 0.3s ease, transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}

.btn-explore:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 144, 217, 0.4);
}

/* Top Roles List */
.roles-top-list {
    margin-bottom: 14px;
}

.roles-top-list h4 {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary, #a0a0a0);
    margin: 0 0 10px 0;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.top-roles-chart {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.role-bar-row {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 4px 0;
    cursor: pointer;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
    border-radius: 4px;
}

.role-bar-row:hover {
    background: var(--bg-hover, rgba(255,255,255,0.05));
    padding-left: 4px;
    padding-right: 4px;
}

.role-name,
.role-label {
    width: 100px;
    min-width: 100px;
    font-size: 12px;
    color: var(--text-primary, #e0e0e0);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: color 0.2s ease;
}

.role-bar-container {
    flex: 1;
    height: 10px;
    background: rgba(255,255,255,0.08);
    border-radius: 5px;
    overflow: hidden;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
}

.role-bar {
    height: 100%;
    border-radius: 5px;
    transition: width 0.4s ease, transform 0.2s ease;
    position: relative;
    overflow: hidden;
    background: linear-gradient(90deg, var(--accent, #4A90D9), #6366f1);
    box-shadow: 0 2px 4px rgba(74, 144, 217, 0.3);
}

.role-bar-row:hover .role-bar {
    transform: scaleY(1.2);
    box-shadow: 0 3px 8px rgba(74, 144, 217, 0.4);
}

.role-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.15),
        rgba(255, 255, 255, 0.4),
        rgba(255, 255, 255, 0.15),
        transparent
    );
    animation: energy-pulse 3s ease-in-out infinite;
}

@keyframes energy-pulse {
    0% {
        left: -50%;
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        left: 150%;
        opacity: 0;
    }
}

.role-count {
    width: 32px;
    text-align: right;
    font-size: 12px;
    font-weight: 600;
    color: var(--accent, #4A90D9);
    transition: transform 0.2s ease, color 0.2s ease;
}

.role-bar-row:hover .role-count {
    transform: scale(1.1);
    color: #6366f1;
}

.role-bar-row:hover .role-label {
    color: var(--accent, #4A90D9);
}

/* Actions Row */
.roles-actions-row {
    display: flex;
    gap: 8px;
    padding-top: 12px;
    border-top: 1px solid var(--border-default, rgba(255,255,255,0.1));
}

.roles-actions-row .btn {
    flex: 1;
    justify-content: center;
    font-size: 11px;
}


/* ============================================
   v2.9.7: Roles Studio Sidebar Navigation
   ============================================ */

/* v3.0.115: Override fullscreen solid background with semi-transparent backdrop */
#modal-roles.modal-fullscreen {
    background: rgba(0, 0, 0, 0.7) !important;
}

/* Modal Layout - Large (3/4 screen) but not fullscreen */
#modal-roles .modal-content {
    width: 92vw;
    max-width: 1800px;
    height: 88vh;
    max-height: none;
    display: flex;
    flex-direction: column;
    border-radius: var(--radius-lg, 12px);
}

.roles-modal-content {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.roles-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--border-default);
    flex-shrink: 0;
}

.roles-header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    margin-left: var(--space-4);
}

.roles-search-container {
    position: relative;
    display: flex;
    align-items: center;
    margin-right: var(--space-2);
}

.roles-search-container > svg {
    position: absolute;
    left: 10px;
    width: 16px;
    height: 16px;
    color: var(--text-muted);
}

/* Ensure dropdown icons are NOT affected by the search container positioning */
.smart-search-icon svg {
    position: static !important;
    left: auto !important;
}

.roles-search-input {
    padding: 8px 12px 8px 36px;
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    background: var(--bg-surface);
    color: var(--text-primary);
    width: 200px;
    font-size: 14px;
}

.roles-search-input:focus {
    outline: none;
    border-color: var(--accent);
}

/* v4.5.1: SmartSearch dropdown for global search */
.roles-search-container .smart-search-wrapper {
    position: relative;
    width: 100%;
}

.roles-search-container .smart-search-dropdown {
    min-width: 320px;
    left: 0;
    right: auto;
    border-radius: var(--radius-md);
    margin-top: 4px;
}

/* v3.0.98: Document filter dropdown */
.roles-document-filter {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

/* v3.0.116: Visible label for document filter */
.roles-document-filter-label {
    font-size: 13px;
    color: var(--text-secondary);
    white-space: nowrap;
}

.roles-document-filter select {
    padding: 8px 32px 8px 12px;
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    background: var(--bg-surface);
    color: var(--text-primary);
    font-size: 14px;
    cursor: pointer;
    min-width: 180px;
    max-width: 280px;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
}

.roles-document-filter select:focus {
    outline: none;
    border-color: var(--accent);
}

.roles-document-filter select:hover {
    border-color: var(--accent);
}

/* v3.0.98: Role context cards styling */
.role-context-section {
    border-top: 1px solid var(--border-default);
    padding-top: 12px;
}

.role-context-card {
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.role-context-card:hover {
    transform: translateX(4px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.context-location .action-tag {
    background: var(--bg-tertiary);
    padding: 1px 6px;
    border-radius: 3px;
    font-size: 10px;
    text-transform: uppercase;
}

.context-text {
    font-style: italic;
    color: var(--text-secondary);
}

.role-highlight {
    background: rgba(74, 144, 217, 0.3);
    padding: 1px 2px;
    border-radius: 2px;
    font-weight: 500;
}

/* Body with horizontal tabs layout - v3.0.71 fix */
.roles-modal-body {
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow: hidden;
}

/* Horizontal Tab Navigation Bar - v3.0.71 */
.roles-sidebar {
    width: 100%;
    flex-shrink: 0;
    border-bottom: 1px solid var(--border-default);
    overflow-x: auto;
    padding: 0 var(--space-3);
    background: var(--bg-surface);
    display: flex;
    flex-direction: row;
    align-items: stretch;
    gap: 0;
}

/* Hide section titles in horizontal mode - v3.0.71 */
.roles-nav-section {
    display: contents;
}

.roles-nav-title {
    display: none;
}

/* Horizontal Tab Items - v3.0.71 */
.roles-nav-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    width: auto;
    padding: var(--space-3) var(--space-4);
    border: none;
    background: transparent;
    color: var(--text-secondary);
    font-size: 13px;
    text-align: center;
    white-space: nowrap;
    border-radius: 0;
    cursor: pointer;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
}

.roles-nav-item:hover {
    background: var(--bg-hover);
    color: var(--text-primary);
}

.roles-nav-item.active {
    background: transparent;
    color: var(--accent);
    font-weight: 600;
    border-bottom: 2px solid var(--accent);
}

.roles-nav-item svg {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
}

/* Hide footer in horizontal mode - v3.0.71 */
.roles-nav-footer {
    display: none;
}

.roles-stats-mini {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: var(--space-2);
    font-size: 12px;
    color: var(--text-muted);
}

.roles-stats-mini strong {
    color: var(--accent);
}

/* Main Content Area - v3.0.72: Flex container for full-height content */
.roles-main {
    flex: 1;
    overflow-y: auto;
    padding: var(--space-4);
    display: flex;
    flex-direction: column;
    min-height: 0; /* Allow flex shrinking */
}

/* Override old tabs - hide them */

/* ============================================
   v2.9.7: Interactive RACI Matrix
   ============================================ */

.raci-header {
    margin-bottom: var(--space-4);
}

.raci-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin: 0 0 var(--space-2) 0;
    font-size: 18px;
}

.raci-header h4 svg {
    width: 20px;
    height: 20px;
    color: var(--accent);
}

.raci-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-default);
}

.raci-controls-left,
.raci-controls-right {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

/* v5.1.0: Export dropdown */
.raci-export-wrapper {
    position: relative;
}
.raci-export-wrapper .raci-export-chevron {
    width: 14px;
    height: 14px;
    margin-left: 2px;
    opacity: 0.6;
    transition: transform 0.2s;
}
.raci-export-menu {
    display: none;
    position: absolute;
    right: 0;
    top: calc(100% + 4px);
    min-width: 260px;
    max-height: 360px;
    overflow-y: auto;
    background: var(--bg-elevated);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-lg);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
    z-index: 500;
    padding: 4px;
}
.raci-export-menu.open {
    display: block;
    animation: raci-menu-in 0.15s ease-out;
}
@keyframes raci-menu-in {
    from { opacity: 0; transform: translateY(-6px); }
    to { opacity: 1; transform: translateY(0); }
}
.raci-export-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 7px 10px;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: 0.8rem;
    color: var(--text-secondary);
    transition: background 0.12s, color 0.12s;
}
.raci-export-item:hover {
    background: var(--bg-hover);
    color: var(--text-primary);
}
.raci-export-icon {
    width: 10px;
    height: 10px;
    border-radius: 2px;
    flex-shrink: 0;
}
.raci-export-label {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.raci-export-count {
    font-size: 0.7rem;
    font-weight: 600;
    background: var(--bg-secondary);
    color: var(--text-muted);
    padding: 1px 6px;
    border-radius: 8px;
    min-width: 22px;
    text-align: center;
}
.raci-export-divider {
    height: 1px;
    background: var(--border-default);
    margin: 4px 8px;
}

.raci-matrix-info {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    font-size: 13px;
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
}

.raci-matrix-info svg {
    width: 16px;
    height: 16px;
    color: var(--accent);
    flex-shrink: 0;
}

/* Interactive RACI Table */

/* Interactive RACI cells */
.raci-cell {
    cursor: pointer;
    /* transition: background removed - anti-flicker */
    position: relative;
    min-width: 50px;
}

.raci-cell:hover {
    background: var(--bg-hover);
}

.raci-cell.raci-r {
    background: rgba(52, 152, 219, 0.08);
    font-weight: 600;
}

.raci-cell.raci-a {
    background: rgba(155, 89, 182, 0.08);
    font-weight: 600;
}

.raci-cell.raci-c {
    background: rgba(46, 204, 113, 0.08);
    font-weight: 600;
}

.raci-cell.raci-i {
    background: rgba(243, 156, 18, 0.08);
    font-weight: 600;
}

/* RACI cell badges - mini icon matching legend colors */
.raci-cell-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 5px;
    font-weight: 700;
    font-size: 0.75rem;
    color: #fff;
}
.raci-badge-r { background: linear-gradient(135deg, #3498db, #2980b9); }
.raci-badge-a { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
.raci-badge-c { background: linear-gradient(135deg, #2ecc71, #27ae60); }
.raci-badge-i { background: linear-gradient(135deg, #f39c12, #e67e22); }

.raci-cell.edited {
    box-shadow: inset 0 0 0 2px var(--accent);
}

.raci-cell.editing {
    background: var(--bg-surface);
    box-shadow: inset 0 0 0 2px var(--accent);
}

/* RACI cell edit dropdown */
.raci-edit-dropdown {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-surface);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    padding: 8px;
    display: flex;
    gap: 4px;
}

.raci-edit-btn {
    padding: 6px 10px;
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
    font-weight: 600;
    font-size: 12px;
    transition: transform 0.1s ease;
}

.raci-edit-btn.raci-btn-r {
    background: rgba(34, 197, 94, 0.2);
    color: var(--success);
}

.raci-edit-btn.raci-btn-a {
    background: rgba(59, 130, 246, 0.2);
    color: var(--info);
}

.raci-edit-btn.raci-btn-c {
    background: rgba(234, 179, 8, 0.2);
    color: var(--warning);
}

.raci-edit-btn.raci-btn-i {
    background: rgba(148, 163, 184, 0.2);
    color: var(--text-secondary);
}

.raci-edit-btn.raci-btn-clear {
    background: var(--bg-secondary);
    color: var(--text-muted);
}

.raci-edit-btn:hover {
    transform: scale(1.1);
}

/* v3.4.0: Current button indicator */
.raci-edit-btn.current {
    outline: 2px solid var(--text-primary);
    outline-offset: 1px;
}

/* v3.4.0: RACI edit dropdown header for better UX */
.raci-edit-header {
    padding: 8px 4px 6px 4px;
    border-bottom: 1px solid var(--border-default);
    margin-bottom: 8px;
    text-align: center;
}

.raci-edit-header strong {
    display: block;
    font-size: 12px;
    color: var(--text-primary);
    margin-bottom: 4px;
    max-width: 180px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.raci-edit-hint {
    font-size: 10px;
    color: var(--text-muted);
    line-height: 1.3;
}

.raci-edit-buttons {
    display: flex;
    gap: 4px;
    justify-content: center;
}

/* Wider dropdown to accommodate header */
.raci-edit-dropdown {
    min-width: 200px;
    flex-direction: column;
}

.raci-total {
    font-weight: 700;
    color: var(--text-primary);
    background: var(--bg-elevated);
}

/* v3.4.0: RACI Responsibilities Modal */
.raci-resp-modal {
    max-width: 600px;
}

.raci-resp-header {
    margin-bottom: var(--space-4);
    padding-bottom: var(--space-3);
    border-bottom: 1px solid var(--border-default);
}

.raci-resp-header h3 {
    margin: 0 0 var(--space-2) 0;
    font-size: 18px;
    color: var(--text-primary);
}

.raci-resp-type {
    display: inline-block;
    padding: 4px 12px;
    border-radius: var(--radius-md);
    font-size: 14px;
    margin-bottom: var(--space-2);
}

.raci-resp-type.raci-r { background: rgba(34, 197, 94, 0.2); color: var(--success); }
.raci-resp-type.raci-a { background: rgba(59, 130, 246, 0.2); color: var(--info); }
.raci-resp-type.raci-c { background: rgba(234, 179, 8, 0.2); color: var(--warning); }
.raci-resp-type.raci-i { background: rgba(148, 163, 184, 0.2); color: var(--text-secondary); }

.raci-resp-desc {
    font-size: 13px;
    color: var(--text-muted);
    margin: 0;
}

.raci-resp-list {
    max-height: 300px;
    overflow-y: auto;
    padding: var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-4);
}

.raci-resp-list h4 {
    margin: 0 0 var(--space-3) 0;
    font-size: 14px;
    color: var(--text-secondary);
}

.raci-resp-item {
    display: flex;
    gap: var(--space-2);
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--border-subtle);
    font-size: 13px;
}

.raci-resp-item:last-child {
    border-bottom: none;
}

.raci-resp-num {
    flex-shrink: 0;
    color: var(--text-muted);
    font-weight: 600;
    width: 24px;
}

.raci-resp-text {
    color: var(--text-primary);
    line-height: 1.4;
}

.raci-resp-empty {
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: var(--space-4);
}

.raci-resp-empty p {
    margin: var(--space-2) 0;
}

.raci-resp-actions {
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-default);
}

.raci-resp-note {
    font-size: 13px;
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
}

.raci-edit-buttons-modal {
    flex-wrap: wrap;
    gap: 8px;
}

.raci-edit-buttons-modal .raci-edit-btn {
    padding: 8px 16px;
    font-size: 13px;
    min-width: 120px;
}

.raci-edit-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}

/* ═══════════════════════════════════════════════════════════════
   v5.1.0: Enhanced RACI Cell Detail Panel
   ═══════════════════════════════════════════════════════════════ */
.raci-detail-panel {
    max-width: 640px;
}

/* Header card */
.raci-detail-header {
    padding: 16px 20px;
    border-radius: var(--radius-lg);
    margin-bottom: 16px;
}
.raci-detail-header-top {
    display: flex;
    align-items: center;
    gap: 14px;
}
.raci-detail-badge {
    width: 42px;
    height: 42px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 1.2rem;
    color: #fff;
    flex-shrink: 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
.raci-detail-header-text {
    flex: 1;
    min-width: 0;
}
.raci-detail-role {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.raci-detail-type {
    margin: 2px 0 0;
    font-size: 0.8rem;
    color: var(--text-secondary);
}
.raci-detail-count {
    font-size: 1.8rem;
    font-weight: 800;
    color: var(--text-primary);
    line-height: 1;
    flex-shrink: 0;
    opacity: 0.7;
}

/* Sections */
.raci-detail-section {
    margin-bottom: 14px;
}
.raci-detail-section-title {
    font-size: 0.72rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    margin-bottom: 8px;
}

/* Action Verb Chart */
.raci-verb-chart {
    display: flex;
    flex-direction: column;
    gap: 5px;
}
.raci-verb-row {
    display: flex;
    align-items: center;
    gap: 8px;
}
.raci-verb-label {
    width: 80px;
    font-size: 0.78rem;
    color: var(--text-secondary);
    text-align: right;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-shrink: 0;
}
.raci-verb-track {
    flex: 1;
    height: 18px;
    background: var(--bg-secondary);
    border-radius: 4px;
    overflow: hidden;
}
.raci-verb-bar {
    height: 100%;
    border-radius: 4px;
    transition: width 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}
.raci-verb-bar.raci-verb-r { background: linear-gradient(90deg, #3498db, #2980b9); }
.raci-verb-bar.raci-verb-a { background: linear-gradient(90deg, #9b59b6, #8e44ad); }
.raci-verb-bar.raci-verb-c { background: linear-gradient(90deg, #2ecc71, #27ae60); }
.raci-verb-bar.raci-verb-i { background: linear-gradient(90deg, #f39c12, #e67e22); }
.raci-verb-count {
    width: 70px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-primary);
    flex-shrink: 0;
}
.raci-verb-pct {
    color: var(--text-muted);
    font-weight: 400;
}
.raci-verb-more, .raci-verb-empty {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
    padding: 4px 0 0 88px;
}

/* Document Chips */
.raci-doc-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}
.raci-doc-chip {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-default);
    border-radius: 16px;
    font-size: 0.72rem;
    color: var(--text-secondary);
    white-space: nowrap;
    cursor: default;
}
.raci-doc-chip.raci-doc-more {
    background: transparent;
    border-style: dashed;
    color: var(--text-muted);
}

/* Responsibility Statements — collapsible */
.raci-stmt-toggle {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    padding: 6px 0;
    user-select: none;
}
.raci-stmt-toggle:hover { opacity: 0.8; }
.raci-stmt-badge {
    font-size: 0.7rem;
    font-weight: 600;
    background: var(--bg-secondary);
    color: var(--text-muted);
    padding: 1px 7px;
    border-radius: 8px;
}
.raci-stmt-chevron {
    margin-left: auto;
    font-size: 0.8rem;
    color: var(--text-muted);
    transition: transform 0.2s;
}
.raci-detail-section.expanded .raci-stmt-chevron {
    transform: rotate(90deg);
}
.raci-stmt-list {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.35s ease;
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
}
.raci-detail-section.expanded .raci-stmt-list {
    max-height: 320px;
    overflow-y: auto;
    padding: 8px 12px;
    margin-top: 6px;
}
.raci-stmt-item {
    display: flex;
    gap: 8px;
    padding: 5px 0;
    border-bottom: 1px solid var(--border-subtle);
    font-size: 0.78rem;
    line-height: 1.4;
}
.raci-stmt-item:last-child { border-bottom: none; }
.raci-stmt-num {
    flex-shrink: 0;
    width: 22px;
    font-weight: 700;
    color: var(--text-muted);
    text-align: right;
}
.raci-stmt-text {
    color: var(--text-primary);
}
.raci-stmt-doc {
    font-size: 0.7rem;
    color: var(--text-muted);
    background: var(--bg-tertiary, rgba(0,0,0,0.05));
    padding: 1px 6px;
    border-radius: 3px;
    margin-left: auto;
    white-space: nowrap;
    flex-shrink: 0;
}
.raci-stmt-loading, .raci-stmt-empty {
    font-size: 0.78rem;
    color: var(--text-muted);
    font-style: italic;
    padding: 12px;
    text-align: center;
}

/* Actions section */
.raci-detail-actions {
    padding-top: 12px;
    border-top: 1px solid var(--border-default);
}

/* v3.4.0: Revert actions */
.raci-revert-actions {
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px dashed var(--border-default);
    text-align: center;
}

.raci-revert-btn {
    padding: 8px 16px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 13px;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.raci-revert-btn:hover {
    background: var(--bg-elevated);
    color: var(--warning);
    border-color: var(--warning);
}

/* RACI Legend Bar — compact single-row */
.raci-legend-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 6px 14px;
    margin-top: var(--space-2);
    padding: 6px 14px;
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-default);
    align-items: center;
}

.raci-legend-bar .raci-legend-item {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 0.72rem;
    color: var(--text-tertiary);
    white-space: nowrap;
    cursor: default;
}

/* Divider between RACI and other badges */
.raci-legend-divider {
    width: 1px;
    height: 14px;
    background: var(--border-default);
    flex-shrink: 0;
}

/* Legend badge base */
.raci-legend-badge {
    flex-shrink: 0;
}

/* Dict badge in legend */
.raci-legend-bar .raci-dict-badge {
    width: 14px;
    height: 14px;
    font-size: 8px;
    margin-right: 0;
    top: 0;
}

/* Adj badges in legend */
.raci-legend-bar .adj-badge {
    padding: 1px 5px;
    font-size: 9px;
    margin-left: 0;
}

/* RACI letter icons shrunk inside legend bar */
.raci-legend-bar .raci-legend-icon {
    width: 16px;
    height: 16px;
    font-size: 0.6rem;
    border-radius: 3px;
}

/* Doc count example icon in legend */
.raci-doc-count-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 14px;
    height: 14px;
    padding: 0 4px;
    background: var(--accent);
    color: white;
    font-size: 8px;
    font-weight: 600;
    border-radius: 7px;
}

.raci-dot {
    width: 12px;
    height: 12px;
    border-radius: 2px;
}

.raci-dot.raci-r {
    background: var(--success);
}

.raci-dot.raci-a {
    background: var(--info);
}

.raci-dot.raci-c {
    background: var(--warning);
}

.raci-dot.raci-i {
    background: var(--text-muted);
}

/* ============================================
   v2.9.7: Bulk Adjudication
   ============================================ */

.adj-select-all-label {
    padding: 6px 12px;
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
}

.adj-bulk-actions {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.bulk-divider {
    color: var(--border-default);
    margin: 0 var(--space-1);
}

.bulk-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
}

.adj-selection-count {
    padding: 6px 12px;
    background: var(--accent-subtle);
    color: var(--accent);
    border-radius: var(--radius-md);
    font-size: 13px;
}

/* Selectable adjudication items */
.adjudication-item {
    position: relative;
}

/* v3.0.58: Changed from absolute to flex-compatible inline checkbox */
.adj-item-checkbox {
    /* Remove absolute positioning - now uses flex layout in JS */
    flex-shrink: 0;
    width: 18px;
    height: 18px;
    margin-top: 2px;
    cursor: pointer;
    accent-color: var(--accent);
}

/* Legacy support for absolute positioning mode (add .selectable class) */
.adjudication-item.selectable .adj-item-checkbox {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
}

.adjudication-item.selectable {
    padding-left: 44px;
}

.adjudication-item.selected {
    background: var(--accent-subtle);
    border-color: var(--accent);
}

/* ============================================
   v2.9.7: Responsive adjustments
   ============================================ */


/* ============================================
   v3.0.57: Condensed RACI Matrix Table
   Role column wider, R/A/C/I columns compact
   Sticky header, scrollable body, sticky legend
   ============================================ */

/* RACI section layout - flex column with sticky legend */
#roles-matrix {
    display: flex;
    flex-direction: column;
    height: 100%;
    max-height: 100%;
    overflow: hidden;
}

#roles-matrix .raci-header,
#roles-matrix .raci-toolbar,
#roles-matrix .raci-matrix-info {
    flex-shrink: 0;
}

/* Scrollable table container - v3.0.72: Remove max-height to fill space */
#responsibility-matrix {
    flex: 1 1 auto;
    overflow-y: auto;
    overflow-x: auto;
    min-height: 150px;
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
}

/* Sticky legend at bottom */
#roles-matrix .raci-legend-bar {
    flex-shrink: 0;
    position: sticky;
    bottom: 0;
    background: var(--bg-elevated);
    z-index: 2;
    border-top: 1px solid var(--border-default);
    margin-top: 0;
}

.raci-matrix-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    font-size: 13px;
}

.raci-matrix-table thead th {
    padding: 10px 6px;
    text-align: center;
    font-weight: 600;
    border-top: 2px solid var(--border-default);
    border-bottom: 2px solid var(--border-default);
    background: var(--bg-elevated);
    position: sticky;
    top: 0;
    z-index: 1;
}

/* Role column - takes remaining space, allow wrap */
.raci-matrix-table thead th:first-child,
.raci-matrix-table tbody td:first-child {
    text-align: left;
    padding-left: 12px;
    padding-right: 8px;
    width: auto;
}

.raci-matrix-table tbody td.role-name {
    white-space: normal;
    word-break: break-word;
    line-height: 1.3;
    max-width: 300px;
    min-width: 120px;
}

/* R, A, C, I columns - compact */
.raci-matrix-table thead th.raci-header {
    width: 44px;
    min-width: 44px;
    max-width: 44px;
    padding: 10px 4px;
    font-size: 14px;
    font-weight: 700;
}

.raci-matrix-table thead th.raci-header.raci-r { color: #3498db; }
.raci-matrix-table thead th.raci-header.raci-a { color: #9b59b6; }
.raci-matrix-table thead th.raci-header.raci-c { color: #2ecc71; }
.raci-matrix-table thead th.raci-header.raci-i { color: #f39c12; }

.raci-matrix-table tbody .raci-cell {
    width: 44px;
    min-width: 44px;
    max-width: 44px;
    padding: 8px 4px;
    text-align: center;
    font-size: 13px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
    position: relative;
}

/* Total column - fixed width */
.raci-matrix-table thead th:nth-child(6),
.raci-matrix-table tbody td.raci-total {
    width: 60px;
    min-width: 60px;
    max-width: 60px;
    text-align: center;
    font-weight: 700;
}

/* Heatmap/Distribution column */
.raci-matrix-table thead th.raci-heatmap-col,
.raci-matrix-table tbody td.raci-heatmap-cell {
    width: 120px;
    min-width: 100px;
    max-width: 140px;
}

.raci-matrix-table tbody tr {
    border-bottom: 1px solid var(--border-default);
}

.raci-matrix-table tbody tr:hover {
    background: var(--bg-hover);
}

.raci-matrix-table tbody tr:last-child {
    border-bottom: none;
}

/* Override old raci-cell min-width */
.raci-matrix-table .raci-cell {
    min-width: 44px !important;
}

/* ============================================
   v3.1.10: Enhanced RACI Dashboard & Heatmap
   ============================================ */

.raci-dashboard {
    margin-bottom: var(--space-4);
    padding: var(--space-4);
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-color);
}

.raci-summary-cards {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.raci-summary-card {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) var(--space-4);
    background: var(--bg-primary);
    border-radius: var(--radius-md);
    border-left: 4px solid transparent;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    cursor: default;
}

.raci-summary-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.raci-summary-card.raci-card-r {
    border-left-color: #3498db;
}

.raci-summary-card.raci-card-a {
    border-left-color: #9b59b6;
}

.raci-summary-card.raci-card-c {
    border-left-color: #2ecc71;
}

.raci-summary-card.raci-card-i {
    border-left-color: #f39c12;
}

.raci-card-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    font-size: 18px;
    font-weight: 700;
    color: white;
}

.raci-card-r .raci-card-icon {
    background: linear-gradient(135deg, #3498db, #2980b9);
}

.raci-card-a .raci-card-icon {
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
}

.raci-card-c .raci-card-icon {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
}

.raci-card-i .raci-card-icon {
    background: linear-gradient(135deg, #f39c12, #e67e22);
}

.raci-card-content {
    display: flex;
    flex-direction: column;
}

.raci-card-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1.1;
}

.raci-card-label {
    font-size: 12px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Distribution Bar */
.raci-distribution-bar {
    display: flex;
    height: 24px;
    border-radius: var(--radius-sm);
    overflow: hidden;
    background: var(--bg-tertiary);
}

.raci-dist-segment {
    height: 100%;
    min-width: 2px;
    transition: width 0.3s ease;
    position: relative;
    overflow: hidden;
}

.raci-dist-segment::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.15),
        rgba(255, 255, 255, 0.4),
        rgba(255, 255, 255, 0.15),
        transparent
    );
    animation: energy-pulse 3s ease-in-out infinite;
}

.raci-dist-r {
    background: linear-gradient(180deg, #3498db, #2980b9);
}

.raci-dist-a {
    background: linear-gradient(180deg, #9b59b6, #8e44ad);
}

.raci-dist-c {
    background: linear-gradient(180deg, #2ecc71, #27ae60);
}

.raci-dist-i {
    background: linear-gradient(180deg, #f39c12, #e67e22);
}

.raci-dist-empty {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-tertiary);
    font-size: 12px;
}

/* Heatmap Column */
.raci-heatmap-col {
    width: 120px;
    min-width: 100px;
}

.raci-heatmap-cell {
    padding: 4px 8px !important;
}

.raci-heatmap-bar {
    display: flex;
    height: 16px;
    border-radius: 3px;
    overflow: hidden;
    background: var(--bg-tertiary);
}

.raci-heatmap-bar > div {
    height: 100%;
}

.raci-heat-r {
    background: #3498db;
}

.raci-heat-a {
    background: #9b59b6;
}

.raci-heat-c {
    background: #2ecc71;
}

.raci-heat-i {
    background: #f39c12;
}

.raci-heatmap-empty {
    color: var(--text-tertiary);
    font-size: 11px;
    text-align: center;
}

/* Document Count Badge */
.raci-doc-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    padding: 0 5px;
    margin-left: 6px;
    background: var(--accent);
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 9px;
}

/* Primary Type Row Indicator */
.raci-matrix-table tbody tr.raci-primary-r td.role-name {
    border-left: 3px solid #3498db;
}

.raci-matrix-table tbody tr.raci-primary-a td.role-name {
    border-left: 3px solid #9b59b6;
}

.raci-matrix-table tbody tr.raci-primary-c td.role-name {
    border-left: 3px solid #2ecc71;
}

.raci-matrix-table tbody tr.raci-primary-i td.role-name {
    border-left: 3px solid #f39c12;
}

/* Footer */
.raci-footer {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-color);
    font-size: 12px;
    color: var(--text-tertiary);
}
.raci-footer-top {
    display: flex;
    align-items: center;
    gap: 16px;
}
.raci-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    padding: 8px 0 4px;
}
.raci-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.82rem;
    color: var(--text-secondary);
}
.raci-legend-icon {
    width: 22px;
    height: 22px;
    border-radius: 4px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.72rem;
    color: #fff;
    flex-shrink: 0;
}
.raci-legend-icon.raci-r { background: linear-gradient(135deg, #3498db, #2980b9); }
.raci-legend-icon.raci-a { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
.raci-legend-icon.raci-c { background: linear-gradient(135deg, #2ecc71, #27ae60); }
.raci-legend-icon.raci-i { background: linear-gradient(135deg, #f39c12, #e67e22); }
.raci-legend-desc {
    color: var(--text-tertiary);
    font-size: 0.78rem;
}

.raci-source-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 500;
}

.raci-source-historical {
    background: rgba(139, 92, 246, 0.15);
    color: #8b5cf6;
}

.raci-source-realtime {
    background: rgba(46, 204, 113, 0.15);
    color: #2ecc71;
}

.raci-role-count {
    font-weight: 500;
}

/* Empty State */
.raci-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-8);
    text-align: center;
    color: var(--text-secondary);
}

.raci-empty-state svg {
    margin-bottom: var(--space-4);
    color: var(--text-tertiary);
}

.raci-empty-state h4 {
    margin: 0 0 var(--space-2) 0;
    color: var(--text-primary);
}

/* Responsive */
@media (max-width: 768px) {
    .raci-summary-cards {
        grid-template-columns: repeat(2, 1fr);
    }

    .raci-heatmap-col,
    .raci-heatmap-cell {
        display: none;
    }
}

/* Clickable Role Name */
.raci-role-clickable {
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}

.raci-role-clickable:hover {
    background: var(--bg-hover);
}

/* v4.5.2: Dictionary Badge in RACI Matrix */
.raci-dict-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    margin-right: 5px;
    background: #D6A84A;
    color: #fff;
    font-size: 9px;
    font-weight: 700;
    border-radius: 3px;
    position: relative;
    top: -1px;
    flex-shrink: 0;
}

/* Dictionary-only rows (no scan data, only in dictionary) */
.raci-matrix-table tbody tr.raci-dict-only {
    opacity: 0.75;
}

.raci-matrix-table tbody tr.raci-dict-only td.role-name {
    border-left: 3px solid #D6A84A;
}

/* Dictionary count in footer */
.raci-dict-count {
    display: inline-flex;
    align-items: center;
    font-weight: 500;
    color: #D6A84A;
}

/* ============================================
   v3.1.10: RACI Drilldown Modal
   ============================================ */

.raci-drilldown-modal {
    padding: var(--space-2);
}

.raci-drilldown-header {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
    padding-bottom: var(--space-3);
    border-bottom: 1px solid var(--border-color);
}

.raci-drilldown-header h3 {
    margin: 0;
    font-size: 1.25rem;
}

.raci-drilldown-category {
    padding: 2px 10px;
    background: var(--bg-tertiary);
    border-radius: 12px;
    font-size: 12px;
    color: var(--text-secondary);
}

.raci-drilldown-summary {
    display: flex;
    gap: var(--space-6);
    margin-bottom: var(--space-5);
    padding: var(--space-4);
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
    border-radius: var(--radius-lg);
}

.raci-drilldown-chart {
    flex-shrink: 0;
    width: 180px;
    height: 180px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.raci-css-pie {
    width: 150px;
    height: 150px;
    border-radius: 50%;
}

.raci-chart-empty {
    color: var(--text-tertiary);
    font-size: 14px;
}

.raci-drilldown-stats {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: var(--space-2);
}

.raci-stat-row {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: var(--bg-primary);
    border-radius: var(--radius-sm);
}

.raci-stat-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
}

.raci-stat-dot.raci-r { background: #3498db; }
.raci-stat-dot.raci-a { background: #9b59b6; }
.raci-stat-dot.raci-c { background: #2ecc71; }
.raci-stat-dot.raci-i { background: #f39c12; }

.raci-stat-label {
    flex: 1;
    font-size: 13px;
    color: var(--text-secondary);
}

.raci-stat-value {
    font-weight: 600;
    font-size: 16px;
    min-width: 30px;
    text-align: right;
}

.raci-stat-pct {
    font-size: 12px;
    color: var(--text-tertiary);
    min-width: 40px;
    text-align: right;
}

.raci-stat-total {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3);
    margin-top: var(--space-2);
    background: var(--accent);
    color: white;
    border-radius: var(--radius-sm);
}

.raci-stat-total .raci-stat-label {
    color: rgba(255, 255, 255, 0.8);
}

.raci-stat-total .raci-stat-value {
    font-size: 20px;
}

/* Document Breakdown */
.raci-drilldown-docs {
    margin-bottom: var(--space-5);
}

.raci-drilldown-docs h4 {
    margin: 0 0 var(--space-3) 0;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
}

.raci-docs-table-wrapper {
    max-height: 200px;
    overflow-y: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--border-color);
}

.raci-docs-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
}

.raci-docs-table thead th {
    position: sticky;
    top: 0;
    background: var(--bg-secondary);
    padding: var(--space-2) var(--space-3);
    text-align: left;
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid var(--border-color);
}

.raci-docs-table thead th.raci-th-r { color: #3498db; }
.raci-docs-table thead th.raci-th-a { color: #9b59b6; }
.raci-docs-table thead th.raci-th-c { color: #2ecc71; }
.raci-docs-table thead th.raci-th-i { color: #f39c12; }

.raci-docs-table tbody td {
    padding: var(--space-2) var(--space-3);
    border-bottom: 1px solid var(--border-color);
}

.raci-docs-table tbody td.doc-name {
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.raci-docs-table tbody td.raci-val {
    text-align: center;
    min-width: 40px;
    font-weight: 500;
}

.raci-docs-table tbody td.raci-val.raci-r { color: #3498db; background: rgba(52, 152, 219, 0.1); }
.raci-docs-table tbody td.raci-val.raci-a { color: #9b59b6; background: rgba(155, 89, 182, 0.1); }
.raci-docs-table tbody td.raci-val.raci-c { color: #2ecc71; background: rgba(46, 204, 113, 0.1); }
.raci-docs-table tbody td.raci-val.raci-i { color: #f39c12; background: rgba(243, 156, 18, 0.1); }

.raci-docs-table tbody td.doc-total {
    font-weight: 600;
    text-align: center;
}

.raci-docs-table tbody tr:hover {
    background: var(--bg-hover);
}

/* Insights */
.raci-drilldown-insights {
    padding: var(--space-4);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    border-left: 4px solid var(--accent);
}

.raci-drilldown-insights h4 {
    margin: 0 0 var(--space-3) 0;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
}

.raci-drilldown-insights ul {
    margin: 0;
    padding: 0;
    list-style: none;
}

.raci-drilldown-insights li {
    padding: var(--space-2) 0;
    font-size: 13px;
    color: var(--text-primary);
}

.raci-drilldown-insights li::before {
    content: "→ ";
    color: var(--accent);
}

.insight-important {
    padding: 2px 8px;
    background: rgba(155, 89, 182, 0.15);
    color: #9b59b6;
    border-radius: 4px;
    font-weight: 500;
}

/* ============================================
   v3.0.97: Role-Document Matrix Styles
   ============================================ */

.roledoc-header {
    margin-bottom: var(--space-4);
}

.roledoc-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin: 0 0 var(--space-2) 0;
    font-size: var(--font-size-lg);
}

.roledoc-header h4 svg {
    width: 20px;
    height: 20px;
    color: var(--accent);
}

.roledoc-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
    padding: var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    flex-wrap: wrap;
    gap: var(--space-3);
}

.roledoc-controls-left,
.roledoc-controls-right {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.roledoc-matrix-info {
    display: flex;
    align-items: flex-start;
    gap: var(--space-2);
    padding: var(--space-3);
    background: var(--info-bg);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-4);
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
}

.roledoc-matrix-info svg {
    width: 16px;
    height: 16px;
    color: var(--info);
    flex-shrink: 0;
    margin-top: 2px;
}

.roledoc-table-wrapper {
    overflow-x: auto;
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
}

.roledoc-matrix-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--font-size-sm);
}

.roledoc-matrix-table thead th {
    background: var(--bg-tertiary);
    padding: var(--space-2) var(--space-3);
    text-align: center;
    font-weight: 600;
    border-bottom: 2px solid var(--border-default);
    white-space: nowrap;
}

.roledoc-matrix-table thead th.roledoc-role-header {
    text-align: left;
    min-width: 180px;
    position: sticky;
    left: 0;
    background: var(--bg-tertiary);
    z-index: 1;
}

.roledoc-matrix-table thead th.roledoc-doc-header {
    min-width: 80px;
    max-width: 120px;
    font-size: var(--font-size-xs);
}

.roledoc-matrix-table thead th.roledoc-total-header {
    min-width: 60px;
    background: var(--bg-secondary);
}

.roledoc-matrix-table tbody td {
    padding: var(--space-2) var(--space-3);
    text-align: center;
    border-bottom: 1px solid var(--border-muted);
}

.roledoc-matrix-table tbody td.roledoc-role-name {
    text-align: left;
    font-weight: 500;
    position: sticky;
    left: 0;
    background: var(--bg-primary);
    z-index: 1;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.roledoc-matrix-table tbody tr:hover td {
    background: var(--bg-secondary);
}

.roledoc-matrix-table tbody tr:hover td.roledoc-role-name {
    background: var(--bg-secondary);
}

.roledoc-cell.roledoc-present {
    color: var(--success);
    font-weight: 600;
}

.roledoc-cell.roledoc-absent {
    color: var(--text-muted);
}

.roledoc-total {
    font-weight: 600;
    background: var(--bg-secondary) !important;
    color: var(--accent);
}

.roledoc-summary {
    display: flex;
    gap: var(--space-4);
    padding: var(--space-3);
    margin-top: var(--space-4);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
}

.roledoc-summary span strong {
    color: var(--accent);
}

.roledoc-empty {
    text-align: center;
    padding: var(--space-6);
    color: var(--text-muted);
    font-style: italic;
}

/* Dark mode adjustments */
.dark-mode .roledoc-matrix-table thead th.roledoc-role-header,
.dark-mode .roledoc-matrix-table tbody td.roledoc-role-name {
    background: var(--bg-primary);
}

.dark-mode .roledoc-matrix-table tbody tr:hover td.roledoc-role-name {
    background: var(--bg-secondary);
}


/* ============================================================
   DOCUMENT PROFILES SETTINGS (v3.0.110)
   Customizable presets for document types
   ============================================================ */

.profiles-header {
    margin-bottom: var(--space-4);
}

.profiles-header h4 {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--font-size-base);
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: var(--space-1);
}

.profiles-header h4 i {
    width: 18px;
    height: 18px;
    color: var(--accent);
}

.profile-selector-settings {
    display: flex;
    gap: var(--space-2);
    flex-wrap: wrap;
}

.profile-btn-settings {
    padding: var(--space-2) var(--space-4);
    background: var(--bg-elevated);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    font-size: var(--font-size-sm);
    font-weight: 500;
    cursor: pointer;
    transition: color var(--duration-fast), opacity var(--duration-fast), transform var(--duration-fast), border-color var(--duration-fast), box-shadow var(--duration-fast);
}

.profile-btn-settings:hover {
    background: var(--bg-surface);
    color: var(--text-primary);
    border-color: var(--border-emphasis);
}

.profile-btn-settings.active {
    background: var(--accent-subtle);
    color: var(--accent);
    border-color: var(--accent);
}

.profile-description {
    padding: var(--space-3);
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    margin-bottom: var(--space-4);
    border-left: 3px solid var(--accent);
}

.profile-description strong {
    color: var(--text-primary);
}

.checker-grid-container {
    background: var(--bg-elevated);
    border-radius: var(--radius-md);
    padding: var(--space-3);
    border: 1px solid var(--border-default);
}

.checker-grid-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-3);
    padding-bottom: var(--space-2);
    border-bottom: 1px solid var(--border-muted);
}

.checker-grid-header > span {
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--text-primary);
}

.checker-grid-actions {
    display: flex;
    gap: var(--space-2);
}

.checker-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-4);
}

.checker-grid .checker-category {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.checker-grid .checker-category-header {
    font-size: var(--font-size-xs);
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding-bottom: var(--space-1);
    border-bottom: 1px solid var(--border-muted);
    margin-bottom: var(--space-1);
}

.checker-option {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-1) 0;
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    cursor: pointer;
    transition: color var(--duration-fast);
}

.checker-option:hover {
    color: var(--text-primary);
}

.checker-option input[type="checkbox"] {
    width: 14px;
    height: 14px;
    accent-color: var(--accent);
    cursor: pointer;
}

.checker-option input[type="checkbox"]:checked + span,
.checker-option:has(input:checked) {
    color: var(--text-primary);
}

.profile-save-status {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: rgba(76, 175, 80, 0.1);
    border-radius: var(--radius-md);
    margin-top: var(--space-3);
    color: var(--success);
    font-size: var(--font-size-sm);
}

.profile-save-status i {
    width: 16px;
    height: 16px;
}

/* Dark mode adjustments for profiles */
.dark-mode .checker-grid-container,
[data-theme="dark"] .checker-grid-container {
    background: var(--bg-surface);
}

.dark-mode .profile-btn-settings,
[data-theme="dark"] .profile-btn-settings {
    background: var(--bg-surface);
}

.dark-mode .profile-description,
[data-theme="dark"] .profile-description {
    background: var(--bg-surface);
}



/* =============================================================================
   v4.1.0: ENHANCED FILTERING FEATURES
   ============================================================================= */

/* Link flow animation */
@keyframes linkFlow {
    0% { stroke-dashoffset: 24; }
    100% { stroke-dashoffset: 0; }
}

.graph-link.link-animated {
    animation: linkFlow 1.5s linear infinite;
}

/* Filter bar navigation container */
.filter-bar-nav {
    display: flex;
    align-items: center;
    gap: 2px;
    margin-right: 8px;
    padding-right: 8px;
    border-right: 1px solid rgba(0, 0, 0, 0.1);
}

/* Filter bar back/forward buttons */
.filter-bar-back,
.filter-bar-forward {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border: none;
    background: rgba(0, 0, 0, 0.05);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    color: var(--text-secondary);
}

.filter-bar-back:hover:not(.disabled),
.filter-bar-forward:hover:not(.disabled) {
    background: rgba(0, 0, 0, 0.1);
    color: var(--text-primary);
}

.filter-bar-back.disabled,
.filter-bar-forward.disabled {
    opacity: 0.35;
    cursor: not-allowed;
    pointer-events: none;
}

.filter-bar-back svg,
.filter-bar-forward svg {
    width: 14px !important;
    height: 14px !important;
}

/* Dark mode for filter bar navigation */
.dark-mode .filter-bar-nav,
[data-theme="dark"] .filter-bar-nav {
    border-right-color: rgba(255, 255, 255, 0.1);
}

.dark-mode .filter-bar-back,
.dark-mode .filter-bar-forward,
[data-theme="dark"] .filter-bar-back,
[data-theme="dark"] .filter-bar-forward {
    background: rgba(255, 255, 255, 0.08);
    color: var(--text-secondary);
}

.dark-mode .filter-bar-back:hover:not(.disabled),
.dark-mode .filter-bar-forward:hover:not(.disabled),
[data-theme="dark"] .filter-bar-back:hover:not(.disabled),
[data-theme="dark"] .filter-bar-forward:hover:not(.disabled) {
    background: rgba(255, 255, 255, 0.15);
    color: var(--text-primary);
}

/* Mini-map */
.graph-minimap {
    position: absolute;
    bottom: 12px;
    right: 12px;
    width: 160px;
    height: auto;
    min-height: 110px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border-radius: var(--radius-lg);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05);
    padding: 5px;
    z-index: 10;
    overflow: hidden;
    transition: width 0.3s ease;
}

.graph-minimap canvas {
    width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    display: block;
}

.minimap-viewport {
    position: absolute;
    border: 2px solid var(--accent);
    border-radius: 2px;
    background: rgba(74, 144, 217, 0.1);
    pointer-events: none;
    display: none;
}

.minimap-label {
    position: absolute;
    bottom: 2px;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 9px;
    color: #888;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
}

.graph-minimap:hover .minimap-label {
    opacity: 1;
}

.graph-minimap:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(74, 144, 217, 0.3);
}

.graph-minimap:active {
    transform: scale(0.98);
}

/* v5.1.2: Minimap context panel with role names */
.minimap-context-panel {
    padding: 6px 8px;
    font-size: 11px;
    line-height: 1.4;
    max-height: 220px;
    overflow-y: auto;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    margin-bottom: 2px;
}
.minimap-context-panel .mcp-selected {
    font-weight: 600;
    color: #b8860b;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 11.5px;
}
.minimap-context-panel .mcp-dot {
    font-size: 10px;
    margin-right: 2px;
}
.minimap-context-panel .mcp-gold { color: #d4a017; }
.minimap-context-panel .mcp-blue { color: #4A90D9; }
.minimap-context-panel .mcp-divider {
    height: 1px;
    background: rgba(0,0,0,0.1);
    margin: 4px 0;
}
.minimap-context-panel .mcp-connected-header {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #888;
    margin-bottom: 2px;
}
.minimap-context-panel .mcp-connected {
    color: #4A6FA5;
    font-size: 10.5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 1px 0;
}
.minimap-context-panel .mcp-more {
    color: #999;
    font-size: 9.5px;
    font-style: italic;
    margin-top: 2px;
}

/* Dark mode context panel */
.dark-mode .minimap-context-panel,
[data-theme="dark"] .minimap-context-panel {
    border-bottom-color: rgba(255,255,255,0.1);
}
.dark-mode .minimap-context-panel .mcp-selected,
[data-theme="dark"] .minimap-context-panel .mcp-selected {
    color: #ffd700;
}
.dark-mode .minimap-context-panel .mcp-divider,
[data-theme="dark"] .minimap-context-panel .mcp-divider {
    background: rgba(255,255,255,0.15);
}
.dark-mode .minimap-context-panel .mcp-connected-header,
[data-theme="dark"] .minimap-context-panel .mcp-connected-header {
    color: rgba(255,255,255,0.5);
}
.dark-mode .minimap-context-panel .mcp-connected,
[data-theme="dark"] .minimap-context-panel .mcp-connected {
    color: #8bb8e8;
}
.dark-mode .minimap-context-panel .mcp-more,
[data-theme="dark"] .minimap-context-panel .mcp-more {
    color: rgba(255,255,255,0.4);
}

/* Dark mode minimap */
.dark-mode .graph-minimap,
[data-theme="dark"] .graph-minimap {
    background: rgba(30, 41, 59, 0.95);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1);
}

.dark-mode .graph-minimap:hover,
[data-theme="dark"] .graph-minimap:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(74, 144, 217, 0.4);
}

.dark-mode .minimap-label,
[data-theme="dark"] .minimap-label {
    color: rgba(255, 255, 255, 0.5);
}

/* Saved Filters Button */
.saved-filters-btn {
    position: absolute;
    bottom: 130px;
    right: 12px;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border: none;
    border-radius: var(--radius-lg);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05);
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    transition: color 0.2s, opacity 0.2s, transform 0.2s, border-color 0.2s, box-shadow 0.2s;
    z-index: 10;
}

.saved-filters-btn:hover {
    background: white;
    color: var(--text-primary);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(74, 144, 217, 0.3);
}

.saved-filters-btn.active {
    background: var(--accent);
    color: white;
}

.saved-filters-btn svg {
    width: 14px;
    height: 14px;
}

/* Saved Filters Panel */
.saved-filters-panel {
    position: absolute;
    bottom: 130px;
    right: 12px;
    width: 320px;
    max-height: 400px;
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.05);
    z-index: 100;
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px) scale(0.95);
    transition: all 0.2s ease;
}

.saved-filters-panel.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
}

.saved-filters-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 16px;
    border-bottom: 1px solid var(--border-light);
    background: var(--bg-secondary);
}

.saved-filters-header h3 {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.saved-filters-header h3 svg {
    width: 16px;
    height: 16px;
    color: var(--accent);
}

.saved-filters-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border: none;
    background: transparent;
    border-radius: var(--radius-full);
    cursor: pointer;
    color: var(--text-muted);
    transition: all 0.15s;
}

.saved-filters-close:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.saved-filters-close svg {
    width: 16px;
    height: 16px;
}

.saved-filters-list {
    max-height: 320px;
    overflow-y: auto;
    padding: 8px;
}

.saved-filter-card {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
    margin-bottom: 4px;
}

.saved-filter-card:hover {
    background: var(--bg-secondary);
}

.saved-filter-card:last-child {
    margin-bottom: 0;
}

.saved-filter-info {
    flex: 1;
    min-width: 0;
}

.saved-filter-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.saved-filter-path {
    font-size: 11px;
    color: var(--text-secondary);
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.saved-filter-date {
    font-size: 10px;
    color: var(--text-muted);
    margin-top: 4px;
}

.saved-filter-delete {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border: none;
    background: transparent;
    border-radius: var(--radius-full);
    cursor: pointer;
    color: var(--text-muted);
    opacity: 0;
    transition: all 0.15s;
    flex-shrink: 0;
}

.saved-filter-card:hover .saved-filter-delete {
    opacity: 1;
}

.saved-filter-delete:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.saved-filter-delete svg {
    width: 14px;
    height: 14px;
}

.saved-filters-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px 20px;
    text-align: center;
    color: var(--text-muted);
}

.saved-filters-empty svg {
    width: 40px;
    height: 40px;
    opacity: 0.3;
    margin-bottom: 12px;
}

.saved-filters-empty p {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 4px;
}

.saved-filters-empty span {
    font-size: 12px;
    line-height: 1.4;
    max-width: 200px;
}

/* Dark mode for saved filters */
.dark-mode .saved-filters-btn,
[data-theme="dark"] .saved-filters-btn {
    background: rgba(30, 41, 59, 0.95);
    color: var(--text-secondary);
}

.dark-mode .saved-filters-btn:hover,
[data-theme="dark"] .saved-filters-btn:hover {
    background: var(--bg-surface);
    color: var(--text-primary);
}

.dark-mode .saved-filters-panel,
[data-theme="dark"] .saved-filters-panel {
    background: var(--bg-surface);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
}

.dark-mode .saved-filters-header,
[data-theme="dark"] .saved-filters-header {
    background: var(--bg-tertiary);
    border-bottom-color: var(--border-default);
}

.dark-mode .saved-filter-card:hover,
[data-theme="dark"] .saved-filter-card:hover {
    background: var(--bg-tertiary);
}

/* Node tooltip */
.graph-node-tooltip {
    position: fixed;
    z-index: 10000;
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.05);
    padding: 12px 14px;
    max-width: 280px;
    pointer-events: none;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.15s, visibility 0.15s;
}

.node-tooltip-header {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 4px;
}

.node-tooltip-icon {
    font-size: 16px;
}

.node-tooltip-label {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.node-tooltip-type {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
}

.node-tooltip-stats {
    display: flex;
    gap: 12px;
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.node-tooltip-hint {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    border-top: 1px solid var(--border-subtle);
    padding-top: 8px;
    margin-top: 4px;
}

/* Link tooltip */
.graph-link-tooltip {
    position: fixed;
    z-index: 10000;
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.05);
    padding: 10px 14px;
    max-width: 320px;
    pointer-events: none;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.15s, visibility 0.15s;
}

.link-tooltip-header {
    font-weight: 600;
    font-size: 13px;
    color: var(--accent);
    margin-bottom: 6px;
}

.link-tooltip-nodes {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-secondary);
}

.link-tooltip-arrow {
    color: var(--text-muted);
    font-size: 10px;
}

.link-tooltip-weight {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 6px;
}

/* Search match highlight */
.graph-node.search-match circle {
    stroke: #f59e0b !important;
    stroke-width: 3px !important;
    filter: drop-shadow(0 0 6px rgba(245, 158, 11, 0.5));
}

/* Filter search box in filter bar */
.filter-search-box {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-left: 8px;
    padding: 2px 8px;
    background: rgba(0, 0, 0, 0.04);
    border-radius: var(--radius-full);
    border: 1px solid transparent;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}

.filter-search-box:focus-within {
    border-color: var(--accent);
    background: white;
}

.filter-search-box input {
    border: none;
    background: transparent;
    font-size: 11px;
    width: 80px;
    outline: none;
}

.filter-search-box svg {
    width: 12px !important;
    height: 12px !important;
    color: var(--text-muted);
}

/* Export and share buttons in filter bar */
.filter-bar-actions {
    display: flex;
    align-items: center;
    gap: 2px;
    margin-left: auto;
    padding-left: 8px;
    border-left: 1px solid rgba(0, 0, 0, 0.08);
}

.filter-bar-action {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    border-radius: var(--radius-full);
    cursor: pointer;
    color: var(--text-muted);
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}

.filter-bar-action:hover {
    background: rgba(0, 0, 0, 0.06);
    color: var(--text-primary);
}

.filter-bar-action svg {
    width: 14px !important;
    height: 14px !important;
}

/* Keyboard shortcut hints */
.keyboard-hint {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    padding: 0 5px;
    background: rgba(0, 0, 0, 0.06);
    border-radius: 4px;
    font-size: 10px;
    font-weight: 500;
    color: var(--text-muted);
    font-family: ui-monospace, monospace;
}

/* Saved filters dropdown */
.saved-filters-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    min-width: 200px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
}

.saved-filter-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}

.saved-filter-item:hover {
    background: rgba(0, 0, 0, 0.04);
}

.saved-filter-name {
    font-size: 13px;
    font-weight: 500;
}

.saved-filter-path {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 2px;
}

.saved-filter-delete {
    opacity: 0;
    transition: opacity 0.15s;
}

.saved-filter-item:hover .saved-filter-delete {
    opacity: 1;
}

/* Pulse rings animation */
.pulse-ring circle {
    transform-origin: center;
}

/* Multi-select indicator */
.filter-bar-item.multi-select {
    border: 1px dashed var(--accent);
}

/* Path visualization */
.graph-link.path-highlight {
    stroke: #f59e0b !important;
    stroke-width: 4px !important;
    filter: drop-shadow(0 0 4px rgba(245, 158, 11, 0.5));
}

/* Filter bar expanded state with more controls */
.graph-filter-bar.expanded {
    padding: 6px 10px;
}

.graph-filter-bar.expanded .filter-bar-path {
    flex-wrap: wrap;
}

/* Export Dialog Styles */
.export-dialog-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 100000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.2s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.export-dialog {
    background: white;
    border-radius: 16px;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-width: 500px;
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from { 
        opacity: 0;
        transform: translateY(20px);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}

.export-dialog-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 1px solid #e2e8f0;
}

.export-dialog-header h3 {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 18px;
    font-weight: 600;
    color: #0f172a;
    margin: 0;
}

.export-dialog-header h3 svg {
    width: 20px;
    height: 20px;
    color: #3b82f6;
}

.export-dialog-close {
    background: none;
    border: none;
    padding: 8px;
    border-radius: 8px;
    cursor: pointer;
    color: #64748b;
    transition: all 0.15s;
}

.export-dialog-close:hover {
    background: #f1f5f9;
    color: #0f172a;
}

.export-dialog-close svg {
    width: 18px;
    height: 18px;
}

.export-dialog-content {
    padding: 20px;
}

.export-summary {
    display: flex;
    justify-content: center;
    gap: 24px;
    padding: 16px;
    background: #f8fafc;
    border-radius: 12px;
    margin-bottom: 16px;
}

.export-stat {
    text-align: center;
    color: #64748b;
    font-size: 14px;
}

.export-stat strong {
    display: block;
    font-size: 24px;
    font-weight: 700;
    color: #3b82f6;
    margin-bottom: 2px;
}

.export-filter-path {
    background: #e0f2fe;
    padding: 10px 14px;
    border-radius: 8px;
    font-size: 13px;
    color: #0369a1;
    margin-bottom: 20px;
}

.export-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.export-option-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 16px 12px;
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    cursor: pointer;
    transition: color 0.2s, opacity 0.2s, transform 0.2s, border-color 0.2s, box-shadow 0.2s;
}

.export-option-btn:hover {
    background: #eff6ff;
    border-color: #3b82f6;
}

.export-option-btn:active {
    transform: scale(0.98);
}

.export-option-btn svg {
    width: 28px;
    height: 28px;
    color: #3b82f6;
}

.export-option-btn span {
    font-weight: 600;
    font-size: 14px;
    color: #0f172a;
}

.export-option-btn small {
    font-size: 11px;
    color: #64748b;
    text-align: center;
}

/* ============================================================
   v4.3.0: SMART SEARCH AUTOCOMPLETE
   ============================================================ */

.smart-search-wrapper {
    position: relative;
    width: 100%;
}

.smart-search-wrapper input {
    width: 100%;
    padding-right: 32px;
}

.smart-search-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    max-height: 280px;
    overflow-y: auto;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-top: none;
    border-radius: 0 0 8px 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
    z-index: 1000;
    display: none;
}

.smart-search-dropdown.visible {
    display: block;
    animation: smartSearchFadeIn 0.15s ease-out;
}

@keyframes smartSearchFadeIn {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
}

.smart-search-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: linear-gradient(135deg, var(--primary, #3b82f6) 0%, #6366f1 100%);
    color: white;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}

.smart-search-header-title {
    font-size: 11px;
    font-weight: 600;
}

.smart-search-header-hint {
    font-size: 10px;
    opacity: 0.85;
}

.smart-search-category {
    padding: 6px 12px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-tertiary, #94a3b8);
    background: var(--bg-secondary, #f8fafc);
    border-bottom: 1px solid var(--border-default, #e2e8f0);
    position: sticky;
    top: 0;
}

.smart-search-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    cursor: pointer;
    border-bottom: 1px solid var(--border-subtle, #f1f5f9);
    /* transition: background removed - anti-flicker */
}

.smart-search-item:last-child {
    border-bottom: none;
}

.smart-search-item:hover,
.smart-search-item.highlighted {
    background: var(--bg-hover, #eff6ff);
}

.smart-search-item.highlighted {
    background: var(--primary-light, #dbeafe);
}

.smart-search-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    background: var(--bg-secondary, #f1f5f9);
    flex-shrink: 0;
}

.smart-search-icon svg {
    width: 14px;
    height: 14px;
    color: var(--text-secondary, #64748b);
    flex-shrink: 0;
}

.smart-search-icon.type-role {
    background: #dbeafe;
}

.smart-search-icon.type-role svg {
    color: #2563eb;
}

.smart-search-icon.type-document {
    background: #fef3c7;
}

.smart-search-icon.type-document svg {
    color: #d97706;
}

.smart-search-icon.type-issue {
    background: #fee2e2;
}

.smart-search-icon.type-issue svg {
    color: #dc2626;
}

.smart-search-icon.type-link {
    background: #e0e7ff;
}

.smart-search-icon.type-link svg {
    color: #4f46e5;
}

.smart-search-icon.type-statement {
    background: #d1fae5;
}

.smart-search-icon.type-statement svg {
    color: #059669;
}

.smart-search-content {
    flex: 1;
    min-width: 0;
    overflow: hidden;
}

.smart-search-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.smart-search-title mark {
    background: #fef08a;
    color: inherit;
    padding: 0 2px;
    border-radius: 2px;
}

.smart-search-meta {
    font-size: 11px;
    color: var(--text-tertiary, #94a3b8);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-top: 2px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.smart-search-meta .smart-search-category {
    font-weight: 600;
    padding: 0;
    background: none;
    border: none;
    position: static;
}

.smart-search-meta .smart-search-count {
    color: var(--text-muted, #94a3b8);
    font-size: 10px;
}

.smart-search-meta .smart-search-count::before {
    content: '•';
    margin-right: 6px;
    opacity: 0.5;
}

.smart-search-badge {
    flex-shrink: 0;
    padding: 2px 8px;
    font-size: 10px;
    font-weight: 600;
    border-radius: 10px;
    background: var(--bg-secondary, #f1f5f9);
    color: var(--text-secondary, #64748b);
}

.smart-search-empty {
    padding: 20px 12px;
    text-align: center;
    color: var(--text-tertiary, #94a3b8);
    font-size: 13px;
}

.smart-search-empty svg {
    width: 24px;
    height: 24px;
    margin-bottom: 8px;
    opacity: 0.5;
}

.smart-search-footer {
    padding: 8px 12px;
    font-size: 11px;
    color: var(--text-tertiary, #94a3b8);
    background: var(--bg-secondary, #f8fafc);
    border-top: 1px solid var(--border-default, #e2e8f0);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.smart-search-footer kbd {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 20px;
    padding: 0 5px;
    font-size: 10px;
    font-family: inherit;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 4px;
    margin: 0 2px;
}

/* Loading state */
.smart-search-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    gap: 8px;
    color: var(--text-tertiary, #94a3b8);
    font-size: 12px;
}

.smart-search-loading::before {
    content: '';
    width: 14px;
    height: 14px;
    border: 2px solid var(--border-default, #e2e8f0);
    border-top-color: var(--primary, #3b82f6);
    border-radius: 50%;
    animation: smartSearchSpin 0.6s linear infinite;
}

@keyframes smartSearchSpin {
    to { transform: rotate(360deg); }
}

/* Recent searches section */
.smart-search-recent {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}

.smart-search-recent-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 6px;
}

.smart-search-recent-header span {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-tertiary, #94a3b8);
}

.smart-search-recent-clear {
    font-size: 10px;
    color: var(--primary, #3b82f6);
    cursor: pointer;
    transition: opacity 0.15s;
}

.smart-search-recent-clear:hover {
    opacity: 0.7;
}

.smart-search-recent-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.smart-search-recent-tag {
    padding: 4px 10px;
    font-size: 11px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 12px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}

.smart-search-recent-tag:hover {
    background: var(--bg-hover, #e2e8f0);
}

/* v4.5.1: Dark mode support for SmartSearch */
.dark-mode .smart-search-dropdown,
[data-theme="dark"] .smart-search-dropdown {
    background: var(--bg-primary, #1e293b);
    border-color: var(--border-default, #334155);
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
}

.dark-mode .smart-search-header,
[data-theme="dark"] .smart-search-header {
    background: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%);
    border-bottom-color: var(--border-default, #334155);
}

.dark-mode .smart-search-item,
[data-theme="dark"] .smart-search-item {
    border-bottom-color: var(--border-subtle, #334155);
}

.dark-mode .smart-search-item:hover,
.dark-mode .smart-search-item.highlighted,
[data-theme="dark"] .smart-search-item:hover,
[data-theme="dark"] .smart-search-item.highlighted {
    background: rgba(59, 130, 246, 0.15);
}

.dark-mode .smart-search-item.highlighted,
[data-theme="dark"] .smart-search-item.highlighted {
    background: rgba(59, 130, 246, 0.25);
}

.dark-mode .smart-search-icon,
[data-theme="dark"] .smart-search-icon {
    background: var(--bg-secondary, #334155);
}

.dark-mode .smart-search-icon svg,
[data-theme="dark"] .smart-search-icon svg {
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .smart-search-icon.type-role,
[data-theme="dark"] .smart-search-icon.type-role {
    background: rgba(59, 130, 246, 0.2);
}

.dark-mode .smart-search-icon.type-role svg,
[data-theme="dark"] .smart-search-icon.type-role svg {
    color: #60a5fa;
}

.dark-mode .smart-search-icon.type-document,
[data-theme="dark"] .smart-search-icon.type-document {
    background: rgba(245, 158, 11, 0.2);
}

.dark-mode .smart-search-icon.type-document svg,
[data-theme="dark"] .smart-search-icon.type-document svg {
    color: #fbbf24;
}

.dark-mode .smart-search-icon.type-issue,
[data-theme="dark"] .smart-search-icon.type-issue {
    background: rgba(239, 68, 68, 0.2);
}

.dark-mode .smart-search-icon.type-issue svg,
[data-theme="dark"] .smart-search-icon.type-issue svg {
    color: #f87171;
}

.dark-mode .smart-search-icon.type-link,
[data-theme="dark"] .smart-search-icon.type-link {
    background: rgba(99, 102, 241, 0.2);
}

.dark-mode .smart-search-icon.type-link svg,
[data-theme="dark"] .smart-search-icon.type-link svg {
    color: #818cf8;
}

.dark-mode .smart-search-icon.type-statement,
[data-theme="dark"] .smart-search-icon.type-statement {
    background: rgba(16, 185, 129, 0.2);
}

.dark-mode .smart-search-icon.type-statement svg,
[data-theme="dark"] .smart-search-icon.type-statement svg {
    color: #34d399;
}

.dark-mode .smart-search-title,
[data-theme="dark"] .smart-search-title {
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .smart-search-title mark,
[data-theme="dark"] .smart-search-title mark {
    background: rgba(250, 204, 21, 0.3);
    color: #fde047;
}

.dark-mode .smart-search-meta,
[data-theme="dark"] .smart-search-meta {
    color: var(--text-tertiary, #64748b);
}

.dark-mode .smart-search-meta .smart-search-count,
[data-theme="dark"] .smart-search-meta .smart-search-count {
    color: var(--text-muted, #64748b);
}

.dark-mode .smart-search-badge,
[data-theme="dark"] .smart-search-badge {
    background: var(--bg-secondary, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .smart-search-empty,
[data-theme="dark"] .smart-search-empty {
    color: var(--text-tertiary, #64748b);
}

.dark-mode .smart-search-footer,
[data-theme="dark"] .smart-search-footer {
    background: var(--bg-secondary, #0f172a);
    border-top-color: var(--border-default, #334155);
    color: var(--text-tertiary, #64748b);
}

.dark-mode .smart-search-footer kbd,
[data-theme="dark"] .smart-search-footer kbd {
    background: var(--bg-primary, #1e293b);
    border-color: var(--border-default, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .smart-search-recent,
[data-theme="dark"] .smart-search-recent {
    border-bottom-color: var(--border-default, #334155);
}

.dark-mode .smart-search-recent-tag,
[data-theme="dark"] .smart-search-recent-tag {
    background: var(--bg-secondary, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .smart-search-recent-tag:hover,
[data-theme="dark"] .smart-search-recent-tag:hover {
    background: var(--bg-hover, #475569);
}

/* ============================================================
   FUNCTION TAGS & DOCUMENT CATEGORIES (v4.4.0)
   ============================================================ */

/* Function Tag Badges */
.function-tag-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 500;
    border: 1px solid;
    margin: 2px;
    transition: all 0.15s ease;
}

.function-tag-badge:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.function-tag-code {
    font-weight: 700;
    font-size: 11px;
}

.function-tag-name {
    opacity: 0.85;
}

.function-tag-remove {
    background: none;
    border: none;
    font-size: 16px;
    line-height: 1;
    cursor: pointer;
    opacity: 0.6;
    padding: 0 0 0 4px;
    color: inherit;
}

.function-tag-remove:hover {
    opacity: 1;
}

/* Function Tags Management Modal */
.function-tags-toolbar {
    display: flex;
    gap: 12px;
    margin-bottom: 16px;
}

.function-categories-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
    max-height: 50vh;
    overflow-y: auto;
    padding-right: 8px;
}

/* ============================================
   Function Tree - Collapsible Hierarchy
   ============================================ */
.func-tree-item {
    border-radius: 8px;
    overflow: hidden;
}

.func-tree-parent {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    cursor: default;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.func-tree-parent.has-children {
    cursor: pointer;
}

.func-tree-parent.has-children:hover {
    background: var(--bg-secondary, #f8fafc);
    border-color: var(--border-hover, #cbd5e1);
}

.func-tree-parent.expanded {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    border-bottom-color: transparent;
    background: var(--bg-secondary, #f8fafc);
}

.func-tree-expand {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.func-tree-expand .expand-icon {
    width: 16px;
    height: 16px;
    color: var(--text-tertiary, #94a3b8);
    transition: transform 0.2s ease;
}

.func-tree-parent.expanded .expand-icon {
    transform: rotate(90deg);
}

.func-tree-expand .expand-spacer {
    width: 16px;
}

.func-tree-color {
    width: 4px;
    height: 32px;
    border-radius: 2px;
    flex-shrink: 0;
}

.func-tree-color-sm {
    width: 3px;
    height: 24px;
    border-radius: 2px;
    flex-shrink: 0;
}

.func-tree-content {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 10px;
    min-width: 0;
}

.func-tree-code {
    font-weight: 700;
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    background: var(--bg-tertiary, #f1f5f9);
    padding: 3px 8px;
    border-radius: 4px;
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
}

.func-tree-code-sm {
    font-weight: 600;
    font-size: 11px;
    color: var(--text-secondary, #475569);
    background: var(--bg-tertiary, #f1f5f9);
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
}

.func-tree-name {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.func-tree-name-sm {
    font-size: 13px;
    font-weight: 400;
    color: var(--text-secondary, #475569);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.func-tree-count {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-tertiary, #94a3b8);
    background: var(--primary-light, #dbeafe);
    color: var(--primary, #3b82f6);
    padding: 2px 8px;
    border-radius: 10px;
}

.func-tree-stats {
    display: flex;
    gap: 8px;
    flex-shrink: 0;
}

.stat-pill {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary, #64748b);
    white-space: nowrap;
}

.stat-pill-sm {
    display: flex;
    align-items: center;
    gap: 3px;
    padding: 2px 6px;
    background: transparent;
    font-size: 11px;
    color: var(--text-tertiary, #94a3b8);
    white-space: nowrap;
}

.stat-icon {
    width: 12px;
    height: 12px;
    opacity: 0.7;
}

.stat-icon-sm {
    width: 10px;
    height: 10px;
    opacity: 0.6;
}

.func-tree-actions {
    display: flex;
    gap: 2px;
    opacity: 0;
    transition: opacity 0.15s;
}

.func-tree-parent:hover .func-tree-actions,
.func-tree-child:hover .func-tree-actions {
    opacity: 1;
}

.btn-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    border-radius: 6px;
    cursor: pointer;
    color: var(--text-tertiary, #94a3b8);
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.btn-icon:hover {
    background: var(--bg-tertiary, #e2e8f0);
    color: var(--text-primary, #1e293b);
}

.btn-icon-danger:hover {
    background: var(--error-light, #fee2e2);
    color: var(--error, #ef4444);
}

.btn-icon svg {
    width: 14px;
    height: 14px;
}

.btn-icon-sm {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    border-radius: 4px;
    cursor: pointer;
    color: var(--text-tertiary, #94a3b8);
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.btn-icon-sm:hover {
    background: var(--bg-tertiary, #e2e8f0);
    color: var(--text-primary, #1e293b);
}

.btn-icon-sm.btn-icon-danger:hover {
    background: var(--error-light, #fee2e2);
    color: var(--error, #ef4444);
}

.btn-icon-sm svg {
    width: 12px;
    height: 12px;
}

/* Children container */
.func-tree-children {
    background: var(--bg-secondary, #f8fafc);
    border: 1px solid var(--border-default, #e2e8f0);
    border-top: none;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    padding: 4px 0 4px 28px;
}

.func-tree-child-expandable {
    position: relative;
}

.func-tree-child {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px 6px 4px;
    border-radius: 6px;
    /* transition: background removed - anti-flicker */
    cursor: default;
}

.func-tree-child.has-children {
    cursor: pointer;
}

.func-tree-child.has-children:hover {
    background: var(--bg-primary, #fff);
}

.func-tree-child.expanded {
    background: var(--bg-tertiary, #f1f5f9);
}

.expand-icon-sm {
    width: 14px;
    height: 14px;
    color: var(--text-tertiary, #94a3b8);
    flex-shrink: 0;
    transition: transform 0.2s ease;
}

.func-tree-child.expanded .expand-icon-sm {
    transform: rotate(90deg);
}

.expand-spacer-sm {
    width: 14px;
    flex-shrink: 0;
}

.func-tree-count-sm {
    font-size: 10px;
    font-weight: 600;
    color: var(--primary, #3b82f6);
    background: var(--primary-light, #dbeafe);
    padding: 1px 6px;
    border-radius: 8px;
}

.func-tree-branch {
    width: 12px;
    height: 20px;
    position: relative;
    flex-shrink: 0;
}

.func-tree-branch::before {
    content: '';
    position: absolute;
    left: 6px;
    top: 0;
    width: 1px;
    height: 10px;
    background: var(--border-default, #cbd5e1);
}

.func-tree-branch::after {
    content: '';
    position: absolute;
    left: 6px;
    top: 10px;
    width: 6px;
    height: 1px;
    background: var(--border-default, #cbd5e1);
}

/* Grandchildren (third level) */
.func-tree-grandchildren {
    margin-left: 20px;
    padding: 4px 0 4px 12px;
    border-left: 1px solid var(--border-light, #e2e8f0);
}

.func-tree-leaf {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px 4px 8px;
    border-radius: 4px;
    /* transition: background removed - anti-flicker */
}

.func-tree-leaf:hover {
    background: var(--bg-primary, #fff);
}

.func-tree-leaf:hover .func-tree-actions {
    opacity: 1;
}

.func-tree-leaf-indent {
    width: 12px;
    flex-shrink: 0;
}

.func-tree-color-xs {
    width: 2px;
    height: 18px;
    border-radius: 1px;
    flex-shrink: 0;
}

.func-tree-code-xs {
    font-weight: 600;
    font-size: 10px;
    color: var(--text-tertiary, #64748b);
    background: var(--bg-tertiary, #f1f5f9);
    padding: 1px 4px;
    border-radius: 2px;
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
}

.func-tree-name-xs {
    font-size: 12px;
    font-weight: 400;
    color: var(--text-tertiary, #64748b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.stat-pill-xs {
    display: flex;
    align-items: center;
    gap: 2px;
    font-size: 10px;
    color: var(--text-quaternary, #a1a1aa);
    white-space: nowrap;
}

.stat-icon-xs {
    width: 9px;
    height: 9px;
    opacity: 0.5;
}

.btn-icon-xs {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    border-radius: 3px;
    cursor: pointer;
    color: var(--text-tertiary, #94a3b8);
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.btn-icon-xs:hover {
    background: var(--bg-tertiary, #e2e8f0);
    color: var(--text-primary, #1e293b);
}

.btn-icon-xs.btn-icon-danger:hover {
    background: var(--error-light, #fee2e2);
    color: var(--error, #ef4444);
}

.btn-icon-xs svg {
    width: 10px;
    height: 10px;
}

/* ============================================
   Mind Map Style - Horizontal Branching
   ============================================ */

.func-mindmap-container {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px;
    overflow-x: auto;
    min-height: 300px;
}

/* Top-level node (root) */
.func-mindmap-root {
    display: flex;
    align-items: flex-start;
    gap: 0;
}

.func-mindmap-node {
    position: relative;
    display: flex;
    flex-direction: column;
}

.func-mindmap-node-content {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: var(--bg-primary, #fff);
    border: 2px solid var(--border-default, #e2e8f0);
    border-radius: 12px;
    cursor: pointer;
    transition: color 0.25s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1), transform 0.25s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.25s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    position: relative;
    z-index: 2;
}

.func-mindmap-node-content:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
}

.func-mindmap-node-content.expanded {
    border-radius: 12px 12px 0 12px;
}

.func-mindmap-node-content.root-node {
    padding: 16px 24px;
    background: linear-gradient(135deg, var(--node-color, #3b82f6), color-mix(in srgb, var(--node-color, #3b82f6) 80%, #fff));
    color: white;
    border: none;
    font-size: 15px;
}

.func-mindmap-node-content.root-node .func-mindmap-code,
.func-mindmap-node-content.root-node .func-mindmap-name {
    color: white;
}

.func-mindmap-node-content.root-node .func-mindmap-count {
    background: rgba(255, 255, 255, 0.25);
    color: white;
}

/* Stats inside root nodes - white text and icons on colored background */
.func-mindmap-node-content.root-node .func-mindmap-stat {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
    color: white;
}

.func-mindmap-node-content.root-node .func-mindmap-stat:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
}

.func-mindmap-node-content.root-node .func-mindmap-stat svg {
    color: white;
}

.func-mindmap-node-content.child-node {
    padding: 10px 14px;
    border-left: 4px solid var(--node-color, #3b82f6);
}

.func-mindmap-node-content.grandchild-node {
    padding: 8px 12px;
    border-left: 3px solid var(--node-color, #3b82f6);
    font-size: 13px;
}

.func-mindmap-color {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 11px;
    color: white;
    flex-shrink: 0;
    box-shadow: inset 0 -2px 0 rgba(0, 0, 0, 0.15);
}

.func-mindmap-code {
    font-weight: 700;
    font-size: 14px;
    color: var(--text-primary, #1e293b);
}

.func-mindmap-name {
    font-weight: 500;
    font-size: 14px;
    color: var(--text-secondary, #64748b);
    white-space: nowrap;
}

.func-mindmap-count {
    background: var(--bg-tertiary, #f1f5f9);
    color: var(--text-tertiary, #64748b);
    font-size: 11px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 10px;
    margin-left: 4px;
}

.func-mindmap-separator {
    color: var(--text-muted, #94a3b8);
    font-weight: 400;
    margin: 0 4px;
}

.func-mindmap-node-content.root-node .func-mindmap-separator {
    color: rgba(255, 255, 255, 0.6);
}

.func-mindmap-expand {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-secondary, #e2e8f0);
    border: 2px solid var(--border-default, #cbd5e1);
    border-radius: 50%;
    transition: color 0.25s ease, opacity 0.25s ease, transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
    margin-left: auto;
    flex-shrink: 0;
}

.func-mindmap-expand:hover {
    background: var(--bg-tertiary, #cbd5e1);
    border-color: var(--text-tertiary, #94a3b8);
}

.func-mindmap-expand svg {
    width: 16px;
    height: 16px;
    color: var(--text-secondary, #475569);
    transition: transform 0.25s ease;
}

.func-mindmap-node-content.expanded .func-mindmap-expand {
    background: var(--node-color, #3b82f6);
    border-color: var(--node-color, #3b82f6);
}

.func-mindmap-node-content.expanded .func-mindmap-expand svg {
    color: white;
    transform: rotate(90deg);
}

.func-mindmap-node-content.root-node .func-mindmap-expand {
    background: rgba(255, 255, 255, 0.2);
}

.func-mindmap-node-content.root-node .func-mindmap-expand svg {
    color: white;
}

.func-mindmap-node-content.root-node.expanded .func-mindmap-expand {
    background: rgba(255, 255, 255, 0.35);
}

/* Branch container - opens to the right */
.func-mindmap-branches {
    display: none;
    flex-direction: column;
    gap: 0;
    margin-left: 24px;
    padding-left: 24px;
    position: relative;
}

.func-mindmap-branches.expanded {
    display: flex;
    animation: branchExpand 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes branchExpand {
    from {
        opacity: 0;
        transform: translateX(-16px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Connecting lines */
.func-mindmap-branches::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 24px;
    width: 2px;
    background: linear-gradient(to bottom, var(--node-color, #e2e8f0), transparent);
    border-radius: 2px;
}

.func-mindmap-branch {
    position: relative;
    display: flex;
    align-items: flex-start;
    padding: 8px 0;
}

/* Horizontal connector */
.func-mindmap-branch::before {
    content: '';
    position: absolute;
    left: -24px;
    top: 24px;
    width: 24px;
    height: 2px;
    background: var(--node-color, #e2e8f0);
}

/* Node connector dot */
.func-mindmap-branch::after {
    content: '';
    position: absolute;
    left: -4px;
    top: 21px;
    width: 8px;
    height: 8px;
    background: var(--node-color, #e2e8f0);
    border-radius: 50%;
    box-shadow: 0 0 0 3px var(--bg-primary, #fff);
    z-index: 1;
}

/* Actions in mindmap */
.func-mindmap-actions {
    display: flex;
    gap: 4px;
    margin-left: 12px;
    opacity: 0;
    transition: opacity 0.15s ease;
}

.func-mindmap-node-content:hover .func-mindmap-actions {
    opacity: 1;
}

.func-mindmap-actions button {
    width: 26px;
    height: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: var(--bg-tertiary, #f1f5f9);
    border-radius: 6px;
    cursor: pointer;
    color: var(--text-tertiary, #94a3b8);
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.func-mindmap-actions button:hover {
    background: var(--bg-secondary, #e2e8f0);
    color: var(--text-primary, #1e293b);
}

.func-mindmap-actions button.btn-danger:hover {
    background: var(--error-light, #fee2e2);
    color: var(--error, #ef4444);
}

.func-mindmap-actions button svg {
    width: 12px;
    height: 12px;
}

/* Stats in mindmap - more prominent styling */
.func-mindmap-stats {
    display: flex;
    gap: 10px;
    margin-left: 12px;
}

.func-mindmap-stat {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary, #334155);
    background: var(--bg-secondary, #f1f5f9);
    padding: 4px 10px;
    border-radius: 6px;
    border: 1px solid var(--border-default, #e2e8f0);
    cursor: help;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.func-mindmap-stat:hover {
    background: var(--bg-tertiary, #e2e8f0);
    border-color: var(--text-tertiary, #94a3b8);
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.func-mindmap-stat.roles-stat {
    color: #2563eb;
    background: rgba(37, 99, 235, 0.1);
    border-color: rgba(37, 99, 235, 0.3);
}

.func-mindmap-stat.roles-stat:hover {
    background: rgba(37, 99, 235, 0.15);
    border-color: rgba(37, 99, 235, 0.5);
}

.func-mindmap-stat.docs-stat {
    color: #059669;
    background: rgba(5, 150, 105, 0.1);
    border-color: rgba(5, 150, 105, 0.3);
}

.func-mindmap-stat.docs-stat:hover {
    background: rgba(5, 150, 105, 0.15);
    border-color: rgba(5, 150, 105, 0.5);
}

.func-mindmap-stat svg {
    width: 14px;
    height: 14px;
    opacity: 1;
}

/* View toggle button */
.func-view-toggle {
    display: flex;
    gap: 4px;
    background: var(--bg-tertiary, #f1f5f9);
    padding: 4px;
    border-radius: 8px;
    margin-bottom: 16px;
}

.func-view-toggle button {
    padding: 8px 16px;
    border: none;
    background: transparent;
    color: var(--text-secondary, #64748b);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border-radius: 6px;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.func-view-toggle button:hover {
    color: var(--text-primary, #1e293b);
}

.func-view-toggle button.active {
    background: var(--bg-primary, #fff);
    color: var(--primary, #3b82f6);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.func-view-toggle button svg {
    width: 16px;
    height: 16px;
}

/* Legacy styles - keep for backward compatibility */
.function-category-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.function-category-row:hover {
    border-color: var(--primary, #3b82f6);
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
}

.function-category-badge {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    color: white;
    font-weight: 700;
    font-size: 14px;
    flex-shrink: 0;
}

.function-category-info {
    flex: 1;
    min-width: 0;
}

.function-category-name {
    font-weight: 600;
    color: var(--text-primary, #1e293b);
}

.function-category-desc {
    font-size: 13px;
    color: var(--text-secondary, #64748b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.function-category-stats {
    display: flex;
    gap: 8px;
}

.stat-badge {
    padding: 4px 10px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 12px;
    font-size: 11px;
    color: var(--text-secondary, #64748b);
    white-space: nowrap;
}

.function-category-actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity 0.15s;
}

.function-category-row:hover .function-category-actions {
    opacity: 1;
}

/* Category Form */
.category-form {
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 16px;
}

.category-form h4 {
    margin: 0 0 16px 0;
    font-size: 16px;
    font-weight: 600;
}

.category-form .form-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.category-form .form-row label {
    width: 100px;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary, #64748b);
}

.category-form .form-row input[type="text"],
.category-form .form-row input[type="color"] {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 14px;
}

.category-form .form-row input[type="color"] {
    width: 60px;
    height: 36px;
    padding: 4px;
    cursor: pointer;
}

.category-form .form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border-default, #e2e8f0);
}

/* Role Required Actions */
.role-actions-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.role-action-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 16px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
    border-left: 3px solid var(--primary, #3b82f6);
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.role-action-item.verified {
    border-left-color: #10b981;
    background: linear-gradient(90deg, #10b98110 0%, transparent 20%);
}

.role-action-content {
    flex: 1;
    min-width: 0;
}

.role-action-text {
    font-size: 14px;
    color: var(--text-primary, #1e293b);
    line-height: 1.5;
    margin: 0 0 8px 0;
}

.role-action-meta {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
}

.role-action-source {
    display: flex;
    align-items: center;
    gap: 4px;
}

.verified-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    color: #10b981;
    font-weight: 500;
}

.verified-badge svg {
    width: 14px;
    height: 14px;
}

.role-action-actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity 0.15s;
}

.role-action-item:hover .role-action-actions {
    opacity: 1;
}

/* Reports Modal */
.report-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.report-option {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 12px;
    cursor: pointer;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.report-option:hover {
    border-color: var(--primary, #3b82f6);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
    transform: translateY(-2px);
}

.report-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    flex-shrink: 0;
}

.report-icon svg {
    width: 24px;
    height: 24px;
}

.report-info {
    flex: 1;
}

.report-info h4 {
    margin: 0 0 4px 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary, #1e293b);
}

.report-info p {
    margin: 0;
    font-size: 13px;
    color: var(--text-secondary, #64748b);
    line-height: 1.4;
}

.report-filters {
    padding: 16px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
}

.report-filters h4 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
}

.report-filters .form-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.report-filters .form-row:last-child {
    margin-bottom: 0;
}

.report-filters .form-row label {
    width: 120px;
    font-size: 13px;
    color: var(--text-secondary, #64748b);
}

.report-filters .form-row select,
.report-filters .form-row input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 14px;
}

/* ── Hierarchical Function Picker ── */
.rpt-func-picker {
    flex: 1;
    position: relative;
}
.rpt-func-picker-selected {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    background: var(--bg-primary, #fff);
    color: var(--text-primary, #1e293b);
    transition: border-color 0.15s;
}
.rpt-func-picker-selected:hover {
    border-color: var(--primary, #3b82f6);
}
.rpt-func-selected-text {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rpt-func-arrow {
    margin-left: 8px;
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
}
.rpt-func-dropdown {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    box-shadow: 0 8px 24px var(--shadow, rgba(0,0,0,0.12));
    z-index: 199999;
    max-height: 340px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}
.rpt-func-search-wrap {
    padding: 8px;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}
.rpt-func-search {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 5px;
    font-size: 13px;
    background: var(--bg-secondary, #f8fafc);
    color: var(--text-primary, #1e293b);
    outline: none;
}
.rpt-func-search:focus {
    border-color: var(--primary, #3b82f6);
    box-shadow: 0 0 0 2px rgba(59,130,246,0.15);
}
.rpt-func-tree {
    overflow-y: auto;
    padding: 4px 0;
    flex: 1;
    min-height: 0;
}
.rpt-func-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
    margin-right: 6px;
}
.rpt-func-item {
    display: flex;
    align-items: center;
    padding: 4px 12px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-primary, #1e293b);
}
.rpt-func-item:hover {
    background: var(--bg-tertiary, #f1f5f9);
}
.rpt-func-item > * {
    pointer-events: none;
}
.rpt-func-item .rpt-func-cb {
    pointer-events: auto;
}
.rpt-func-item .rpt-func-check-label {
    pointer-events: auto;
}
.rpt-func-item-all {
    font-weight: 600;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
    margin-bottom: 2px;
}
.rpt-func-item-label {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rpt-func-group-header {
    display: flex;
    align-items: center;
    padding: 4px 12px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary, #1e293b);
    gap: 0;
}
.rpt-func-group-header:hover {
    background: var(--bg-tertiary, #f1f5f9);
}
.rpt-func-expand-icon {
    width: 16px;
    text-align: center;
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
    margin-right: 4px;
    flex-shrink: 0;
    cursor: pointer;
    padding: 2px;
}
.rpt-func-group-label {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rpt-func-child-count {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-muted, #94a3b8);
    background: var(--bg-tertiary, #f1f5f9);
    padding: 1px 7px;
    border-radius: 10px;
    margin-left: 6px;
    flex-shrink: 0;
    cursor: pointer;
}
.rpt-func-child-item {
    padding-left: 36px;
    font-weight: 400;
}
/* Multi-select checkbox styles */
.rpt-func-check-label {
    display: flex;
    align-items: center;
    cursor: pointer;
    flex: 1;
    min-width: 0;
    gap: 6px;
    padding: 3px 0;
    margin: 0;
}
.rpt-func-cb {
    width: 14px !important;
    height: 14px !important;
    accent-color: var(--primary, #3b82f6);
    cursor: pointer;
    flex: 0 0 14px !important;
    margin: 0;
}
.rpt-func-actions {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-top: 1px solid var(--border-default, #e2e8f0);
    gap: 8px;
}
.rpt-func-clear-btn {
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: color 0.15s;
}
.rpt-func-clear-btn:hover {
    color: var(--danger, #ef4444);
    background: rgba(239,68,68,0.1);
}
.rpt-func-done-btn {
    font-size: 12px;
    font-weight: 600;
    color: #fff;
    background: var(--primary, #3b82f6);
    border: none;
    cursor: pointer;
    padding: 5px 16px;
    border-radius: 5px;
    /* transition: background removed - anti-flicker */
}
.rpt-func-done-btn:hover {
    background: var(--primary-hover, #2563eb);
}

/* ── Document Owner Combobox ── */
.rpt-owner-combo {
    flex: 1;
    position: relative;
}
.rpt-owner-input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 14px;
    background: var(--bg-primary, #fff);
    color: var(--text-primary, #1e293b);
    outline: none;
}
.rpt-owner-input:focus {
    border-color: var(--primary, #3b82f6);
    box-shadow: 0 0 0 2px rgba(59,130,246,0.15);
}
.rpt-owner-dropdown {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    box-shadow: 0 8px 24px var(--shadow, rgba(0,0,0,0.12));
    z-index: 10100;
    max-height: 280px;
    overflow-y: auto;
}
.rpt-owner-list {
    padding: 4px 0;
}
.rpt-owner-func-header {
    display: flex;
    align-items: center;
    padding: 6px 12px 4px;
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--text-muted, #94a3b8);
    gap: 6px;
    margin-top: 4px;
}
.rpt-owner-item {
    display: flex;
    align-items: center;
    padding: 7px 12px 7px 24px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    gap: 8px;
}
.rpt-owner-item:hover {
    background: var(--bg-tertiary, #f1f5f9);
}
.rpt-owner-item-name {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rpt-owner-also {
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
    display: flex;
    align-items: center;
    gap: 3px;
    flex-shrink: 0;
}
.rpt-owner-func-badge {
    display: inline-block;
    padding: 1px 6px;
    border-radius: 8px;
    font-size: 10px;
    color: #fff;
    font-weight: 600;
}
.rpt-owner-empty {
    padding: 16px;
    text-align: center;
    color: var(--text-muted, #94a3b8);
    font-size: 13px;
    line-height: 1.5;
}

/* Document Category Type Badges */
.doc-category-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 500;
}

.doc-category-badge.procedures {
    background: #3b82f620;
    color: #3b82f6;
}

.doc-category-badge.knowledgebase {
    background: #10b98120;
    color: #10b981;
}

.doc-category-badge.specifications {
    background: #f59e0b20;
    color: #f59e0b;
}

.doc-category-badge.instructions {
    background: #8b5cf620;
    color: #8b5cf6;
}

/* Empty State */
.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px 20px;
    text-align: center;
    color: var(--text-muted, #94a3b8);
}

.empty-state svg {
    width: 48px;
    height: 48px;
    margin-bottom: 12px;
    opacity: 0.5;
}

.empty-state p {
    margin: 0;
    font-size: 14px;
}

/* Role Dictionary Enhancement - Required Actions Tab */
.dict-role-detail-panel {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.dict-section {
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    overflow: hidden;
}

.dict-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: var(--bg-secondary, #f8fafc);
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}

.dict-section-title {
    font-size: 14px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.dict-section-body {
    padding: 16px;
}

/* Function Assignment in Role Detail */
.function-assignment-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.function-assignment-row select {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
}

.function-badges-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 8px;
}



/* Document Tags Management Modal */
.document-tags-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.doc-tag-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 12px 16px;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    transition: color 0.15s ease, opacity 0.15s ease, transform 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
}

.doc-tag-row:hover {
    border-color: var(--border-hover, #cbd5e1);
    background: var(--bg-secondary, #f8fafc);
}

.doc-tag-name {
    flex: 1;
    min-width: 200px;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.doc-tag-name strong {
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 300px;
}

.doc-tag-fields {
    display: flex;
    gap: 8px;
    align-items: center;
}

.doc-tag-fields select,
.doc-tag-fields input {
    padding: 6px 10px;
    font-size: 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    background: var(--bg-primary, #fff);
    transition: border-color 0.15s;
}

.doc-tag-fields select:hover,
.doc-tag-fields input:hover {
    border-color: var(--border-hover, #cbd5e1);
}

.doc-tag-fields select:focus,
.doc-tag-fields input:focus {
    outline: none;
    border-color: var(--primary, #3b82f6);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.doc-tag-function {
    width: 160px;
}

.doc-tag-type {
    width: 140px;
}

.doc-tag-owner {
    width: 140px;
}

/* Document Tags Toolbar */
.doc-tags-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}

.doc-tags-filters {
    display: flex;
    gap: 12px;
    align-items: center;
}

.doc-tags-actions {
    display: flex;
    gap: 8px;
}

/* Document Tag Row States */
.doc-tag-row.has-tag {
    border-left: 3px solid var(--success, #22c55e);
}

.doc-tag-row.no-tag {
    border-left: 3px solid var(--warning, #f59e0b);
    background: var(--bg-warning-subtle, rgba(245, 158, 11, 0.05));
}

.doc-tag-meta {
    display: flex;
    align-items: center;
    gap: 8px;
}

.auto-detect-badge {
    display: inline-block;
    padding: 2px 6px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: var(--info-bg, #dbeafe);
    color: var(--info, #3b82f6);
    border-radius: 4px;
}

.btn-auto-detect {
    color: var(--info, #3b82f6);
}

.btn-auto-detect:hover {
    background: var(--info-bg, #dbeafe);
}

/* Document Tag Prompt Modal */
.doc-tag-prompt-filename {
    padding: 12px 16px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}

.doc-tag-prompt-filename strong {
    font-size: 14px;
    color: var(--text-primary, #1e293b);
    word-break: break-word;
}

.input-with-action {
    display: flex;
    gap: 8px;
    align-items: center;
}

.input-with-action select,
.input-with-action input {
    flex: 1;
}

/* Inline Add Form (for adding new categories/types) */
.inline-add-form {
    background: var(--bg-secondary, #f8fafc);
    padding: 12px;
    border-radius: 8px;
    border: 1px dashed var(--border-default, #e2e8f0);
    margin-top: 8px;
}

.inline-add-form-header {
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary, #64748b);
}

.inline-add-form .input-row {
    display: flex;
    gap: 8px;
    align-items: center;
}

.form-input-sm,
.form-select-sm {
    padding: 6px 10px;
    font-size: 12px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    background: var(--bg-primary, #fff);
}

.form-select-sm {
    min-width: 120px;
}

/* Hierarchical select styling */
select optgroup {
    font-weight: 600;
    font-size: 12px;
    color: var(--text-primary, #1e293b);
    background: var(--bg-tertiary, #f1f5f9);
    padding: 8px 4px;
}

select option {
    font-weight: normal;
    padding: 4px 8px;
}

/* Folder icons for parent categories */
.doc-tag-function option[value]:not([value=""]),
.form-select option[value]:not([value=""]) {
    font-family: inherit;
}

/* Batch Tagging Modal */
.batch-tag-header,
.batch-tag-row {
    display: grid;
    grid-template-columns: 40px 1fr 250px;
    gap: 12px;
    align-items: center;
    padding: 8px 12px;
}

.batch-tag-header {
    background: var(--bg-tertiary, #f1f5f9);
    border-radius: 8px 8px 0 0;
    font-weight: 600;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary, #64748b);
}

.batch-tag-row {
    border: 1px solid var(--border-default, #e2e8f0);
    border-top: none;
    /* transition: background removed - anti-flicker */
}

.batch-tag-row:last-child {
    border-radius: 0 0 8px 8px;
}

.batch-tag-row:hover {
    background: var(--bg-secondary, #f8fafc);
}

.batch-tag-checkbox {
    display: flex;
    align-items: center;
    justify-content: center;
}

.batch-tag-name {
    display: flex;
    align-items: center;
    gap: 8px;
}

.batch-tag-name strong {
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.batch-tag-fields {
    display: flex;
    gap: 8px;
}

.batch-tag-fields select {
    flex: 1;
}

.batch-tag-bulk-actions {
    padding: 16px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
}

.batch-tag-bulk-actions .input-row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-top: 8px;
}

.batch-tag-list {
    border-radius: 8px;
    overflow: hidden;
}

/* Document Log Header Actions */
.document-log-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.document-log-actions {
    display: flex;
    gap: 8px;
}


/* ============================================================
   v3.4.0: DATA EXPLORER - Overview Tab Integration
   Clickable summary cards and Data Explorer banner styles
   ============================================================ */

/* Data Explorer Banner */
.data-explorer-banner {
    background: linear-gradient(135deg, rgba(74,144,217,0.15), rgba(99,102,241,0.15));
    border: 1px solid rgba(74,144,217,0.3);
    border-radius: 12px;
    padding: 16px 20px;
    margin-bottom: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.3s ease;
}

.data-explorer-banner:hover {
    background: linear-gradient(135deg, rgba(74,144,217,0.25), rgba(99,102,241,0.25));
    border-color: rgba(74,144,217,0.5);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(74,144,217,0.2);
}

.data-explorer-banner-content {
    display: flex;
    align-items: center;
    gap: 12px;
}

.data-explorer-banner i,
.data-explorer-banner svg {
    width: 24px;
    height: 24px;
    color: var(--accent, #4A90D9);
}

.data-explorer-banner strong {
    font-size: 14px;
    color: var(--text-primary, #e0e0e0);
}

.data-explorer-banner span {
    font-size: 13px;
    color: var(--text-secondary, #a0a0a0);
}

.data-explorer-banner-arrow {
    color: var(--accent, #4A90D9);
    font-size: 18px;
    transition: transform 0.3s ease;
}

.data-explorer-banner:hover .data-explorer-banner-arrow {
    transform: translateX(4px);
}

/* Clickable Summary Cards in Overview */
.roles-summary-card.clickable-stat,
.roles-card-clickable {
    cursor: pointer;
    transition: color 0.3s ease, opacity 0.3s ease, transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
}

.roles-summary-card.clickable-stat::before,
.roles-card-clickable::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--accent, #4A90D9), var(--success, #51cf66));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.roles-summary-card.clickable-stat:hover,
.roles-card-clickable:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    border-color: var(--accent, #4A90D9);
}

.roles-summary-card.clickable-stat:hover::before,
.roles-card-clickable:hover::before {
    opacity: 1;
}

/* Click hint indicator */
.click-hint {
    font-size: 10px;
    color: var(--accent, #4A90D9);
    margin-top: 8px;
    opacity: 0;
    transform: translateY(5px);
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 4px;
}

.click-hint i,
.click-hint svg {
    width: 12px;
    height: 12px;
}

.roles-summary-card.clickable-stat:hover .click-hint,
.roles-card-clickable:hover .click-hint {
    opacity: 1;
    transform: translateY(0);
}

/* Pulse animation for stat values on hover */
@keyframes statPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.roles-summary-card.clickable-stat:hover .stat-value,
.roles-card-clickable:hover .stat-value {
    animation: statPulse 0.6s ease;
    color: var(--accent, #4A90D9);
}

/* Active/pressed state */
.roles-summary-card.clickable-stat:active,
.roles-card-clickable:active {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

/* Data Explorer trigger button in Overview */
.explore-data-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: linear-gradient(135deg, var(--accent, #4A90D9), #6366f1);
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: color 0.3s ease, opacity 0.3s ease, transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    font-size: 13px;
}

.explore-data-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 144, 217, 0.4);
}

.explore-data-btn i,
.explore-data-btn svg {
    width: 16px;
    height: 16px;
}

/* Dark mode adjustments for Data Explorer triggers */
.dark-mode .data-explorer-banner {
    background: linear-gradient(135deg, rgba(74,144,217,0.2), rgba(99,102,241,0.2));
}

.dark-mode .roles-summary-card.clickable-stat:hover,
.dark-mode .roles-card-clickable:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

/* Summary hint for clickable cards */
.summary-hint {
    font-size: 10px;
    color: var(--accent, #4A90D9);
    margin-top: 4px;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.roles-card-clickable:hover .summary-hint {
    opacity: 1;
}

/* ============================================================
   v4.4.0: ENHANCED ROLE DETAILS TAB
   Cinematic, responsive design with smart search integration
   ============================================================ */

/* Header Section */
.rd-header {
    margin-bottom: 24px;
}

/* Stats Bar */
.rd-stats-bar {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 20px;
}

.rd-stat {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: linear-gradient(135deg, var(--bg-secondary, #f8fafc), var(--bg-tertiary, #f1f5f9));
    border-radius: 12px;
    border: 1px solid var(--border-subtle, #e2e8f0);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.rd-stat-animated {
    opacity: 0;
    transform: translateY(10px);
    animation: rdStatFadeIn 0.5s ease forwards;
}

@keyframes rdStatFadeIn {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.rd-stat:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.rd-stat-icon {
    font-size: 24px;
    opacity: 0.9;
}

.rd-stat-content {
    flex: 1;
}

.rd-stat-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-primary, #1e293b);
    line-height: 1;
}

.rd-stat-label {
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 4px;
}

/* Category Filter Pills */
.rd-category-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border-subtle, #e2e8f0);
}

.rd-category-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--bg-secondary, #f8fafc);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 20px;
    font-size: 12px;
    color: var(--text-secondary, #64748b);
    cursor: pointer;
    transition: all 0.2s ease;
}

.rd-category-pill:hover {
    border-color: var(--pill-color, var(--accent, #4a90d9));
    background: var(--bg-tertiary, #f1f5f9);
}

.rd-category-pill-active {
    background: var(--pill-color, var(--accent, #4a90d9));
    border-color: var(--pill-color, var(--accent, #4a90d9));
    color: white;
}

.rd-category-pill-active .rd-pill-dot {
    background: white !important;
}

.rd-pill-icon {
    font-size: 14px;
}

.rd-pill-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

.rd-pill-label {
    font-weight: 500;
}

.rd-pill-count {
    background: rgba(0, 0, 0, 0.1);
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
}

.rd-category-pill-active .rd-pill-count {
    background: rgba(255, 255, 255, 0.25);
}

/* Enhanced Search Container */
.rd-search-container {
    margin-bottom: 16px;
}

.rd-search-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.rd-search-icon {
    position: absolute;
    left: 14px;
    width: 18px;
    height: 18px;
    color: var(--text-muted, #94a3b8);
    pointer-events: none;
}

.rd-search-input {
    width: 100%;
    padding: 14px 14px 14px 44px;
    background: var(--bg-secondary, #f8fafc);
    border: 2px solid var(--border-default, #e2e8f0);
    border-radius: 12px;
    font-size: 14px;
    color: var(--text-primary, #1e293b);
    transition: all 0.2s ease;
}

.rd-search-input:focus {
    outline: none;
    border-color: var(--accent, #4a90d9);
    box-shadow: 0 0 0 4px rgba(74, 144, 217, 0.1);
}

.rd-search-input::placeholder {
    color: var(--text-muted, #94a3b8);
}

.rd-search-hints {
    position: absolute;
    right: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 10px;
    color: var(--text-muted, #94a3b8);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.rd-search-input:focus ~ .rd-search-hints {
    opacity: 1;
}

.rd-search-hints kbd {
    padding: 2px 5px;
    background: var(--bg-tertiary, #f1f5f9);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 4px;
    font-family: inherit;
    font-size: 9px;
}

/* View Controls */
.rd-view-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

.rd-view-toggle {
    display: flex;
    gap: 4px;
    padding: 4px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
}

.rd-view-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: transparent;
    border: none;
    border-radius: 6px;
    color: var(--text-muted, #94a3b8);
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.rd-view-btn:hover {
    color: var(--text-primary, #1e293b);
    background: var(--bg-tertiary, #f1f5f9);
}

.rd-view-btn-active {
    color: white;
    background: var(--accent, #4a90d9);
}

.rd-expand-all-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    background: transparent;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    font-size: 12px;
    color: var(--text-secondary, #64748b);
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.rd-expand-all-btn:hover {
    border-color: var(--accent, #4a90d9);
    color: var(--accent, #4a90d9);
}

.rd-expand-all-btn svg {
    transition: transform 0.2s ease;
}

/* Cards Container */
.rd-cards-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.rd-cards-container[data-view="compact"] .rd-card-content {
    display: none !important;
}

.rd-cards-container[data-view="compact"] .rd-card {
    padding: 12px 16px;
}

.rd-cards-container[data-view="compact"] .rd-card-header {
    margin-bottom: 0;
}

.rd-cards-container[data-view="expanded"] .rd-card-content {
    display: block !important;
    max-height: none !important;
    opacity: 1 !important;
}

/* Role Card */
.rd-card {
    background: var(--bg-surface, #ffffff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-left: 4px solid var(--card-color, #4a90d9);
    border-radius: 0 12px 12px 0;
    padding: 16px 20px;
    transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
}

.rd-card-animated {
    opacity: 0;
    transform: translateX(-10px);
    animation: rdCardSlideIn 0.4s ease forwards;
    animation-delay: calc(var(--card-index) * 0.03s);
}

@keyframes rdCardSlideIn {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.rd-card:hover {
    border-color: var(--card-color, #4a90d9);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

.rd-card-highlight {
    animation: rdCardPulse 0.5s ease;
    box-shadow: 0 0 0 3px var(--card-color, #4a90d9), 0 8px 24px rgba(0, 0, 0, 0.15) !important;
}

@keyframes rdCardPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.01); }
}

/* Card Header */
.rd-card-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.rd-card-avatar {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    flex-shrink: 0;
}

.rd-card-avatar svg {
    width: 22px;
    height: 22px;
}

.rd-card-title-section {
    flex: 1;
    min-width: 0;
}

.rd-card-title {
    margin: 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.rd-card-subtitle {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
    margin-top: 2px;
}

.rd-card-category {
    font-weight: 500;
}

.rd-card-separator {
    opacity: 0.5;
}

.rd-card-badges {
    display: flex;
    gap: 6px;
}

.rd-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    padding: 0 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
}

.rd-badge-responsibilities {
    background: rgba(34, 197, 94, 0.15);
    color: #16a34a;
}

.rd-badge-actions {
    background: rgba(99, 102, 241, 0.15);
    color: #6366f1;
}

.rd-card-explore,
.rd-card-expand {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: 8px;
    color: var(--text-muted, #94a3b8);
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    flex-shrink: 0;
}

.rd-card-explore:hover {
    background: rgba(74, 144, 217, 0.15);
    color: var(--accent, #4a90d9);
    transform: scale(1.1);
}

.rd-card-expand:hover {
    background: var(--bg-secondary, #f8fafc);
    color: var(--text-primary, #1e293b);
}

.rd-card-expand svg {
    transition: transform 0.3s ease;
}

.rd-card-expanded .rd-card-expand svg {
    transform: rotate(180deg);
}

/* Quick Stats Bar */
.rd-card-quick-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 10px 0;
    border-bottom: 1px solid var(--border-subtle, #f1f5f9);
}

.rd-quick-stat {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    background: color-mix(in srgb, var(--stat-color, #64748b) 10%, transparent);
    border-radius: 6px;
    font-size: 11px;
}

.rd-quick-stat-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--stat-color, #64748b);
}

.rd-quick-stat-label {
    font-weight: 500;
    color: var(--stat-color, #64748b);
    text-transform: capitalize;
}

.rd-quick-stat-value {
    font-weight: 700;
    color: var(--text-primary, #1e293b);
}

/* Card Content (Expandable) */
.rd-card-content {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: color 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.4s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.rd-card-expanded .rd-card-content {
    max-height: 2000px;
    opacity: 1;
    padding-top: 12px;
}

/* Sections */
.rd-section {
    margin-bottom: 16px;
}

.rd-section:last-of-type {
    margin-bottom: 0;
}

.rd-section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary, #64748b);
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.rd-section-header svg {
    color: var(--text-muted, #94a3b8);
}

.rd-section-count {
    background: var(--bg-tertiary, #f1f5f9);
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 10px;
}

/* Context Items */
.rd-context-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.rd-context-item {
    display: flex;
    gap: 8px;
    padding: 12px 14px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
    border-left: 3px solid var(--context-color, #4a90d9);
    font-size: 13px;
    line-height: 1.5;
    color: var(--text-primary, #1e293b);
}

.rd-context-quote {
    font-size: 24px;
    line-height: 1;
    color: var(--context-color, #4a90d9);
    opacity: 0.5;
    font-family: Georgia, serif;
}

.rd-context-text {
    flex: 1;
}

.rd-context-text mark {
    background: rgba(74, 144, 217, 0.25);
    padding: 1px 3px;
    border-radius: 3px;
}

/* Responsibility Items */
.rd-responsibility-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.rd-responsibility-item {
    display: flex;
    gap: 10px;
    padding: 10px 12px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
    font-size: 13px;
    line-height: 1.5;
    animation: rdRespFadeIn 0.3s ease forwards;
    animation-delay: calc(var(--resp-index) * 0.05s);
    opacity: 0;
}

@keyframes rdRespFadeIn {
    to { opacity: 1; }
}

.rd-responsibility-bullet {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--resp-color, #4a90d9);
    flex-shrink: 0;
    margin-top: 6px;
}

.rd-responsibility-text {
    flex: 1;
    color: var(--text-primary, #1e293b);
}

/* Statement Items */
.rd-statements-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.rd-statement-item {
    padding: 12px 14px;
    background: var(--bg-secondary, #f8fafc);
    border-radius: 8px;
    border-left: 3px solid var(--stmt-color, #64748b);
    animation: rdStmtSlideIn 0.3s ease forwards;
    animation-delay: calc(var(--stmt-index) * 0.05s);
    opacity: 0;
    transform: translateX(-5px);
}

@keyframes rdStmtSlideIn {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.rd-statement-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
}

.rd-statement-directive {
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 700;
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.rd-statement-number {
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
}

.rd-statement-text {
    font-size: 13px;
    line-height: 1.5;
    color: var(--text-primary, #1e293b);
}

/* Action Chips */
.rd-action-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.rd-action-chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    background: color-mix(in srgb, var(--chip-color, #4a90d9) 12%, transparent);
    border-radius: 6px;
    font-size: 12px;
}

.rd-action-name {
    color: var(--chip-color, #4a90d9);
    font-weight: 500;
}

.rd-action-count {
    background: var(--chip-color, #4a90d9);
    color: white;
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
}

/* Show More Button */
.rd-show-more {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 8px 12px;
    background: transparent;
    border: 1px dashed var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 8px;
}

.rd-show-more:hover {
    border-color: var(--accent, #4a90d9);
    color: var(--accent, #4a90d9);
    background: rgba(74, 144, 217, 0.05);
}

/* Card Footer */
.rd-card-footer {
    display: flex;
    gap: 8px;
    padding-top: 16px;
    margin-top: 16px;
    border-top: 1px solid var(--border-subtle, #f1f5f9);
}

.rd-footer-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    background: var(--bg-secondary, #f8fafc);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary, #64748b);
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.rd-footer-btn:hover {
    border-color: var(--accent, #4a90d9);
    color: var(--accent, #4a90d9);
    background: rgba(74, 144, 217, 0.05);
}

.rd-footer-btn-primary {
    background: var(--accent, #4a90d9);
    border-color: var(--accent, #4a90d9);
    color: white;
}

.rd-footer-btn-primary:hover {
    background: color-mix(in srgb, var(--accent, #4a90d9) 85%, black);
    border-color: color-mix(in srgb, var(--accent, #4a90d9) 85%, black);
    color: white;
}

.rd-footer-btn svg {
    width: 14px;
    height: 14px;
}

/* No Results State */
.rd-no-results {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    text-align: center;
}

.rd-no-results-icon {
    font-size: 48px;
    opacity: 0.5;
    margin-bottom: 16px;
}

.rd-no-results-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary, #1e293b);
    margin-bottom: 8px;
}

.rd-no-results-text {
    font-size: 14px;
    color: var(--text-muted, #94a3b8);
    margin-bottom: 20px;
}

.rd-no-results-btn {
    padding: 10px 20px;
    background: var(--accent, #4a90d9);
    border: none;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    cursor: pointer;
    transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.rd-no-results-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(74, 144, 217, 0.3);
}

/* Dark Mode Styles */
.dark-mode .rd-stat,
[data-theme="dark"] .rd-stat {
    background: linear-gradient(135deg, var(--bg-secondary, #1e293b), var(--bg-tertiary, #334155));
    border-color: var(--border-default, #334155);
}

.dark-mode .rd-stat-value,
[data-theme="dark"] .rd-stat-value {
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-category-pill,
[data-theme="dark"] .rd-category-pill {
    background: var(--bg-secondary, #1e293b);
    border-color: var(--border-default, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .rd-search-input,
[data-theme="dark"] .rd-search-input {
    background: var(--bg-secondary, #1e293b);
    border-color: var(--border-default, #334155);
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-search-hints kbd,
[data-theme="dark"] .rd-search-hints kbd {
    background: var(--bg-tertiary, #334155);
    border-color: var(--border-default, #475569);
}

.dark-mode .rd-view-toggle,
[data-theme="dark"] .rd-view-toggle {
    background: var(--bg-secondary, #1e293b);
}

.dark-mode .rd-view-btn:hover,
[data-theme="dark"] .rd-view-btn:hover {
    background: var(--bg-tertiary, #334155);
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-expand-all-btn,
[data-theme="dark"] .rd-expand-all-btn {
    border-color: var(--border-default, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .rd-card,
[data-theme="dark"] .rd-card {
    background: var(--bg-surface, #1e293b);
    border-color: var(--border-default, #334155);
}

.dark-mode .rd-card-title,
[data-theme="dark"] .rd-card-title {
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-quick-stat,
[data-theme="dark"] .rd-quick-stat {
    background: color-mix(in srgb, var(--stat-color, #64748b) 15%, transparent);
}

.dark-mode .rd-quick-stat-value,
[data-theme="dark"] .rd-quick-stat-value {
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-context-item,
.dark-mode .rd-responsibility-item,
.dark-mode .rd-statement-item,
[data-theme="dark"] .rd-context-item,
[data-theme="dark"] .rd-responsibility-item,
[data-theme="dark"] .rd-statement-item {
    background: var(--bg-tertiary, #334155);
}

.dark-mode .rd-context-text,
.dark-mode .rd-responsibility-text,
.dark-mode .rd-statement-text,
[data-theme="dark"] .rd-context-text,
[data-theme="dark"] .rd-responsibility-text,
[data-theme="dark"] .rd-statement-text {
    color: var(--text-primary, #f1f5f9);
}

.dark-mode .rd-section-count,
[data-theme="dark"] .rd-section-count {
    background: var(--bg-tertiary, #334155);
}

.dark-mode .rd-action-chip,
[data-theme="dark"] .rd-action-chip {
    background: color-mix(in srgb, var(--chip-color, #4a90d9) 20%, transparent);
}

.dark-mode .rd-footer-btn,
[data-theme="dark"] .rd-footer-btn {
    background: var(--bg-secondary, #1e293b);
    border-color: var(--border-default, #334155);
    color: var(--text-secondary, #94a3b8);
}

.dark-mode .rd-show-more,
[data-theme="dark"] .rd-show-more {
    border-color: var(--border-default, #334155);
}

.dark-mode .rd-card-quick-stats,
[data-theme="dark"] .rd-card-quick-stats {
    border-bottom-color: var(--border-subtle, #334155);
}

.dark-mode .rd-card-footer,
[data-theme="dark"] .rd-card-footer {
    border-top-color: var(--border-subtle, #334155);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .rd-stats-bar {
        grid-template-columns: repeat(2, 1fr);
    }

    .rd-category-filters {
        overflow-x: auto;
        flex-wrap: nowrap;
        padding-bottom: 12px;
        -webkit-overflow-scrolling: touch;
    }

    .rd-category-pill {
        flex-shrink: 0;
    }

    .rd-search-hints {
        display: none;
    }

    .rd-card-header {
        flex-wrap: wrap;
    }

    .rd-card-badges {
        order: 3;
        width: 100%;
        margin-top: 8px;
    }
}

/* ===== v4.0.4: Import Diff Preview Modal ===== */

.import-diff-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.15s ease;
}

.import-diff-modal {
    background: var(--bg-surface, #fff);
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    width: 520px;
    max-width: 90vw;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    animation: slideUp 0.2s ease;
}

@keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.import-diff-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border-default, #e5e7eb);
}

.import-diff-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
}

.import-diff-close {
    background: none;
    border: none;
    font-size: 20px;
    color: var(--text-muted, #6b7280);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
}

.import-diff-close:hover {
    background: var(--bg-hover, #f3f4f6);
    color: var(--text-primary, #1f2937);
}

.import-diff-summary {
    display: flex;
    gap: 12px;
    padding: 12px 20px;
    border-bottom: 1px solid var(--border-default, #e5e7eb);
    flex-wrap: wrap;
}

.diff-stat {
    font-size: 13px;
    color: var(--text-muted, #6b7280);
}

.diff-stat strong {
    font-weight: 600;
}

.diff-stat-new strong { color: #10b981; }
.diff-stat-changed strong { color: #f59e0b; }
.diff-stat-unchanged strong { color: #6b7280; }
.diff-stat-total { margin-left: auto; }

.import-diff-body {
    overflow-y: auto;
    flex: 1;
    min-height: 0;
    max-height: 400px;
}

.diff-section {
    border-bottom: 1px solid var(--border-default, #e5e7eb);
}

.diff-section:last-child {
    border-bottom: none;
}

.diff-section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
    user-select: none;
}

.diff-section-header:hover {
    background: var(--bg-hover, #f9fafb);
}

.diff-section-arrow {
    font-size: 10px;
    transition: transform 0.15s ease;
    color: var(--text-muted, #6b7280);
}

.diff-section.collapsed .diff-section-arrow {
    transform: rotate(-90deg);
}

.diff-section.collapsed .diff-section-body {
    display: none;
}

.diff-section-badge {
    font-size: 11px;
    font-weight: 600;
    color: #fff;
    padding: 1px 6px;
    border-radius: 10px;
    min-width: 22px;
    text-align: center;
}

.diff-section-body {
    padding: 0 20px 8px;
}

.diff-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 5px 8px;
    border-radius: 4px;
    margin-bottom: 2px;
    font-size: 12px;
}

.diff-item.diff-new {
    background: rgba(16, 185, 129, 0.06);
}

.diff-item.diff-changed {
    background: rgba(245, 158, 11, 0.06);
}

.diff-item.diff-unchanged {
    background: transparent;
}

.diff-role-name {
    font-weight: 500;
    color: var(--text-primary, #1f2937);
    flex: 1;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.diff-detail {
    font-size: 11px;
    color: var(--text-muted, #6b7280);
    margin-left: 12px;
    white-space: nowrap;
}

.import-diff-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    padding: 12px 20px;
    border-top: 1px solid var(--border-default, #e5e7eb);
}

.import-diff-actions .btn {
    padding: 8px 16px;
    font-size: 13px;
    border-radius: 6px;
    cursor: pointer;
}

.import-diff-actions .btn-ghost {
    background: none;
    border: 1px solid var(--border-default, #e5e7eb);
    color: var(--text-primary, #1f2937);
}

.import-diff-actions .btn-ghost:hover {
    background: var(--bg-hover, #f3f4f6);
}

.import-diff-actions .btn-primary {
    background: #D6A84A;
    border: none;
    color: #fff;
    font-weight: 500;
}

.import-diff-actions .btn-primary:hover {
    background: #B8743A;
}

.import-diff-actions .btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Dark mode overrides for diff modal */
.dark-mode .import-diff-modal,
[data-theme="dark"] .import-diff-modal {
    background: var(--bg-surface, #1f2937);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
}

.dark-mode .import-diff-overlay,
[data-theme="dark"] .import-diff-overlay {
    background: rgba(0, 0, 0, 0.7);
}

/* =====================================================================
   DICTIONARY TAB v4.0.5 - Dashboard, Card View, Bulk Ops, Inline Actions
   ===================================================================== */

/* Dashboard Container */
.dict-dashboard {
    margin-bottom: 16px;
    flex-shrink: 0;
}

.dict-dash-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 12px;
}

.dict-dash-tile {
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: box-shadow 0.2s, transform 0.15s;
}

.dict-dash-tile:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transform: translateY(-1px);
}

.dict-dash-tile::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
}

.dict-dash-tile-total::before { background: #3b82f6; }
.dict-dash-tile-deliverable::before { background: #D6A84A; }
.dict-dash-tile-adj::before { background: #10b981; }
.dict-dash-tile-health::before { background: #8b5cf6; }

.dict-dash-icon {
    margin-bottom: 6px;
}

.dict-dash-icon svg,
.dict-dash-icon i {
    width: 20px;
    height: 20px;
    color: var(--text-muted, #6b7280);
}

.dict-dash-value {
    font-size: 28px;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 2px;
    color: var(--text-primary, #1f2937);
}

.dict-dash-label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted, #6b7280);
    font-weight: 600;
    margin-bottom: 4px;
}

.dict-dash-sub {
    font-size: 11px;
    color: var(--text-muted, #6b7280);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex-wrap: wrap;
}

/* Health Bar */
.dict-health-bar {
    width: 80%;
    margin: 8px auto 0;
    height: 5px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 3px;
    overflow: hidden;
}

.dict-health-fill {
    height: 100%;
    background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981);
    border-radius: 3px;
    transition: width 0.6s ease;
}

/* Dashboard Charts Row */
.dict-dash-charts {
    display: grid;
    grid-template-columns: 200px 1fr 1fr;
    gap: 12px;
}

.dict-chart-box {
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 10px;
    padding: 14px;
}

.dict-chart-title {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
    color: var(--text-muted, #6b7280);
    margin-bottom: 10px;
}

#dict-category-chart {
    display: block;
    margin: 0 auto;
}

/* Source Distribution Bars */
.dict-src-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
}

.dict-src-label {
    font-size: 11px;
    color: var(--text-secondary, #4b5563);
    min-width: 80px;
    display: flex;
    align-items: center;
    gap: 6px;
    text-transform: capitalize;
}

.dict-src-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
    flex-shrink: 0;
}

.dict-src-bar-track {
    flex: 1;
    height: 6px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 3px;
    overflow: hidden;
}

.dict-src-bar-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.4s ease;
}

.dict-src-count {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
    min-width: 24px;
    text-align: right;
}

/* Category List in Dashboard */
.dict-cat-list {
    max-height: 200px;
    overflow-y: auto;
}

.dict-cat-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 5px;
}

.dict-cat-name {
    font-size: 11px;
    color: var(--text-secondary, #4b5563);
    min-width: 90px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.dict-cat-bar-track {
    flex: 1;
    height: 6px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 3px;
    overflow: hidden;
}

.dict-cat-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #D6A84A, #B8743A);
    border-radius: 3px;
    transition: width 0.4s ease;
}

.dict-cat-count {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
    min-width: 24px;
    text-align: right;
}

/* Filter Count Badge */
.dict-filter-count {
    font-size: 12px;
    color: var(--text-muted, #6b7280);
    font-weight: 500;
    padding: 4px 10px;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 12px;
    white-space: nowrap;
}

/* View Toggle Buttons */
.dict-view-toggle {
    display: flex;
    background: var(--bg-secondary, #f1f5f9);
    border-radius: 8px;
    padding: 2px;
    gap: 2px;
}

.dict-view-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 28px;
    border: none;
    background: transparent;
    border-radius: 6px;
    cursor: pointer;
    color: var(--text-muted, #6b7280);
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}

.dict-view-btn svg,
.dict-view-btn i {
    width: 16px;
    height: 16px;
}

.dict-view-btn:hover {
    background: var(--bg-hover, #e5e7eb);
    color: var(--text-primary, #1f2937);
}

.dict-view-btn.active {
    background: var(--bg-primary, #fff);
    color: #D6A84A;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* Bulk Operations Bar */
.dict-bulk-bar {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 16px;
    background: #D6A84A12;
    border: 1px solid #D6A84A40;
    border-radius: 8px;
    margin-bottom: 8px;
    flex-shrink: 0;
    animation: dictSlideDown 0.2s ease;
}

@keyframes dictSlideDown {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
}

.dict-bulk-count {
    font-size: 13px;
    font-weight: 600;
    color: #B8743A;
    white-space: nowrap;
}

.dict-bulk-actions {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    flex: 1;
}

.dict-bulk-clear {
    margin-left: auto;
}

/* Content Area */
.dict-content-area {
    min-height: 120px;
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
}

/* Enhanced Table Styles */
.dict-enhanced-table {
    border-collapse: separate;
    border-spacing: 0;
}

.dict-enhanced-table thead th {
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--bg-secondary, #f8fafc);
    border-bottom: 2px solid var(--border-default, #e2e8f0);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    color: var(--text-muted, #6b7280);
    padding: 8px 10px;
    white-space: nowrap;
}

.dict-th-sortable {
    cursor: pointer;
    user-select: none;
    transition: color 0.15s;
}

.dict-th-sortable:hover {
    color: var(--text-primary, #1f2937) !important;
}

.dict-sort-arrow {
    font-size: 10px;
    opacity: 0.4;
    margin-left: 2px;
}

.dict-sort-active {
    opacity: 1;
    color: #D6A84A;
}

.dict-th-check {
    width: 36px;
    text-align: center;
}

.dict-td-check {
    text-align: center;
}

.dict-td-check input[type="checkbox"],
.dict-th-check input[type="checkbox"],
.dict-row-check {
    width: 15px;
    height: 15px;
    cursor: pointer;
    accent-color: #D6A84A;
}

/* Table Row States */
.dict-enhanced-table tbody tr {
    /* transition: background removed - anti-flicker */
}

.dict-enhanced-table tbody tr:hover {
    background: var(--bg-hover, #f8fafc) !important;
}

.dict-row-selected {
    background: #D6A84A08 !important;
}

.dict-row-selected:hover {
    background: #D6A84A12 !important;
}

.dict-row-focused {
    outline: 2px solid #D6A84A;
    outline-offset: -2px;
    border-radius: 2px;
}

/* Name Cell */
.dict-name-wrap {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
}

.dict-role-name-text {
    cursor: pointer;
    transition: color 0.15s;
}

.dict-role-name-text:hover {
    color: #D6A84A;
}

.dict-aliases {
    margin-top: 2px;
    font-size: 10px;
}

.dict-desc-preview {
    margin-top: 2px;
    font-size: 10px;
    max-width: 280px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Inline Mini Tags */
.dict-inline-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 3px;
    margin-top: 3px;
}

.dict-mini-tag {
    display: inline-block;
    padding: 0 5px;
    font-size: 9px;
    font-weight: 500;
    background: #3b82f618;
    color: #3b82f6;
    border-radius: 3px;
    border: 1px solid #3b82f625;
    line-height: 16px;
}

/* Pending Dot */
.dict-pending-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    background: #d1d5db;
    border-radius: 50%;
    vertical-align: middle;
}

/* Date Cell */
.dict-td-date {
    font-size: 11px;
}

.dict-date-text {
    display: block;
    color: var(--text-secondary, #4b5563);
}

.dict-by-text {
    display: block;
    font-size: 10px;
    color: var(--text-muted, #9ca3af);
    margin-top: 1px;
}

/* Actions Cell */
.dict-td-actions {
    white-space: nowrap;
}
.dict-td-actions > * {
    display: inline-flex;
    vertical-align: middle;
    margin-right: 2px;
}

.dict-td-actions .btn-xs {
    padding: 3px 5px;
}

.dict-td-actions .btn-xs svg,
.dict-td-actions .btn-xs i {
    width: 13px;
    height: 13px;
}

/* Deliverable Toggle */
.dict-deliv-toggle {
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
}

.dict-deliv-toggle input {
    display: none;
}

.dict-deliv-icon {
    font-size: 16px;
    color: #d1d5db;
    transition: color 0.2s, transform 0.2s;
    line-height: 1;
}

.dict-deliv-toggle input:checked + .dict-deliv-icon {
    color: #D6A84A;
    transform: scale(1.15);
}

.dict-deliv-toggle:hover .dict-deliv-icon {
    color: #f59e0b;
}

/* Category Badge Inline */
.dict-cat-inline {
    cursor: pointer;
    transition: box-shadow 0.15s;
    font-size: 11px;
}

.dict-cat-inline:hover {
    box-shadow: 0 0 0 2px #D6A84A40;
}

/* Inline Category Select */
.dict-inline-cat-select {
    border-radius: 6px;
    font-size: 11px !important;
}

/* =====================================================================
   CARD VIEW
   ===================================================================== */

.dict-card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 12px;
}

.dict-card {
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 10px;
    padding: 14px;
    transition: box-shadow 0.2s, transform 0.15s;
    position: relative;
    cursor: pointer;
}

.dict-card:hover {
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    transform: translateY(-1px);
}

.dict-card-selected {
    background: #D6A84A08;
    border-color: #D6A84A60;
}

.dict-card-focused {
    outline: 2px solid #D6A84A;
    outline-offset: -1px;
}

.dict-card-header {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    margin-bottom: 8px;
}

.dict-card-header input[type="checkbox"] {
    margin-top: 3px;
    accent-color: #D6A84A;
}

.dict-card-title-row {
    display: flex;
    align-items: center;
    gap: 6px;
    flex: 1;
    min-width: 0;
}

.dict-card-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary, #1f2937);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    cursor: pointer;
}

.dict-card-name:hover {
    color: #D6A84A;
}

.dict-card-actions {
    display: flex;
    gap: 2px;
    opacity: 0;
    transition: opacity 0.15s;
}

.dict-card:hover .dict-card-actions {
    opacity: 1;
}

.dict-card-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 8px;
}

.dict-card-star {
    color: #D6A84A;
    font-size: 14px;
}

.dict-card-desc {
    font-size: 12px;
    color: var(--text-secondary, #4b5563);
    margin-bottom: 6px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    line-height: 1.4;
}

.dict-card-aliases {
    font-size: 11px;
    color: var(--text-muted, #6b7280);
    margin-bottom: 4px;
}

.dict-card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 3px;
    margin-bottom: 6px;
}

.dict-card-notes {
    font-size: 11px;
    color: var(--text-muted, #9ca3af);
    font-style: italic;
    display: flex;
    align-items: flex-start;
    gap: 4px;
    margin-bottom: 6px;
}

.dict-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 8px;
    border-top: 1px solid var(--border-default, #e2e8f0);
    margin-top: auto;
}

.dict-card-date {
    font-size: 10px;
    color: var(--text-muted, #9ca3af);
}

.dict-card-quick {
    display: flex;
    align-items: center;
    gap: 4px;
}

/* =====================================================================
   KEYBOARD HINTS BAR
   ===================================================================== */

.dict-keyboard-hints {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 12px;
    background: var(--bg-secondary, #f8fafc);
    border-top: 1px solid var(--border-default, #e2e8f0);
    font-size: 10px;
    color: var(--text-muted, #9ca3af);
    margin-top: 0;
    border-radius: 0 0 8px 8px;
    flex-wrap: wrap;
    flex-shrink: 0;
}


.dict-keyboard-hints kbd {
    display: inline-block;
    padding: 1px 5px;
    font-size: 10px;
    font-family: inherit;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #d1d5db);
    border-radius: 4px;
    box-shadow: 0 1px 1px rgba(0,0,0,0.06);
    color: var(--text-secondary, #4b5563);
    margin-right: 2px;
}

/* =====================================================================
   ENHANCED FILTER DROPDOWNS
   ===================================================================== */

.dict-enhanced-filter {
    font-size: 12px;
}

/* =====================================================================
   RESPONSIVE ADJUSTMENTS
   ===================================================================== */

@media (max-width: 1200px) {
    .dict-dash-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    .dict-dash-charts {
        grid-template-columns: 1fr 1fr;
    }
    .dict-dash-charts .dict-chart-box:first-child {
        grid-column: 1 / -1;
        text-align: center;
    }
}

@media (max-width: 768px) {
    .dict-dash-grid {
        grid-template-columns: 1fr;
    }
    .dict-dash-charts {
        grid-template-columns: 1fr;
    }
    .dict-card-grid {
        grid-template-columns: 1fr;
    }
}

/* =====================================================================
   DARK MODE - Dictionary Tab
   ===================================================================== */

.dark-mode .dict-dash-tile,
[data-theme="dark"] .dict-dash-tile {
    background: var(--bg-surface, #1e293b);
    border-color: var(--border-default, #334155);
}

.dark-mode .dict-dash-tile:hover,
[data-theme="dark"] .dict-dash-tile:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.dark-mode .dict-chart-box,
[data-theme="dark"] .dict-chart-box {
    background: var(--bg-surface, #1e293b);
    border-color: var(--border-default, #334155);
}

.dark-mode .dict-card,
[data-theme="dark"] .dict-card {
    background: var(--bg-surface, #1e293b);
    border-color: var(--border-default, #334155);
}

.dark-mode .dict-card:hover,
[data-theme="dark"] .dict-card:hover {
    box-shadow: 0 4px 16px rgba(0,0,0,0.4);
}

.dark-mode .dict-bulk-bar,
[data-theme="dark"] .dict-bulk-bar {
    background: #D6A84A15;
    border-color: #D6A84A30;
}

.dark-mode .dict-view-toggle,
[data-theme="dark"] .dict-view-toggle {
    background: var(--bg-surface, #1e293b);
}

.dark-mode .dict-view-btn.active,
[data-theme="dark"] .dict-view-btn.active {
    background: var(--bg-primary, #0f172a);
}

.dark-mode .dict-keyboard-hints,
[data-theme="dark"] .dict-keyboard-hints {
    background: var(--bg-surface, #1e293b);
    border-color: var(--border-default, #334155);
}

.dark-mode .dict-keyboard-hints kbd,
[data-theme="dark"] .dict-keyboard-hints kbd {
    background: var(--bg-primary, #0f172a);
    border-color: var(--border-default, #475569);
}

.dark-mode .dict-filter-count,
[data-theme="dark"] .dict-filter-count {
    background: var(--bg-surface, #1e293b);
}

.dark-mode .dict-health-bar,
[data-theme="dark"] .dict-health-bar {
    background: var(--bg-surface, #1e293b);
}

.dark-mode .dict-src-bar-track,
.dark-mode .dict-cat-bar-track,
[data-theme="dark"] .dict-src-bar-track,
[data-theme="dark"] .dict-cat-bar-track {
    background: var(--bg-surface, #1e293b);
}

.dark-mode .dict-mini-tag,
[data-theme="dark"] .dict-mini-tag {
    background: #3b82f625;
    border-color: #3b82f635;
}

.dark-mode .dict-pending-dot,
[data-theme="dark"] .dict-pending-dot {
    background: #475569;
}

.dark-mode .dict-row-selected,
[data-theme="dark"] .dict-row-selected {
    background: #D6A84A10 !important;
}

.dark-mode .dict-card-selected,
[data-theme="dark"] .dict-card-selected {
    background: #D6A84A12;
    border-color: #D6A84A40;
}

.dark-mode .dict-card-footer,
[data-theme="dark"] .dict-card-footer {
    border-color: var(--border-default, #334155);
}


/* =============================================================================
   v4.1.0 - SIPOC IMPORT & HIERARCHY STYLES
   ============================================================================= */

/* SIPOC Import Modal — Backdrop & Container */
/* v4.7.1: z-index must be above Roles Studio modal (10000) */
#sipoc-import-modal {
    z-index: 10100 !important;
}
#sipoc-import-modal .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 0;
}
#sipoc-import-modal .modal-container {
    position: relative;
    z-index: 1;
    background: var(--bg-primary, #ffffff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: var(--radius-xl, 16px);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* SIPOC Modal — Dark Mode Container */
.dark-mode #sipoc-import-modal .modal-container,
[data-theme="dark"] #sipoc-import-modal .modal-container {
    background: var(--bg-primary, #1e293b);
    border-color: var(--border-default, #334155);
}

/* Hierarchy Export Modal — Same pattern as SIPOC */
/* v4.7.1: z-index must be above Roles Studio modal (10000) */
#hierarchy-export-modal {
    z-index: 10100 !important;
}
#hierarchy-export-modal .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 0;
}
#hierarchy-export-modal .modal-container {
    position: relative;
    z-index: 1;
    background: var(--bg-primary, #ffffff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: var(--radius-xl, 16px);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}
.dark-mode #hierarchy-export-modal .modal-container,
[data-theme="dark"] #hierarchy-export-modal .modal-container {
    background: var(--bg-primary, #1e293b);
    border-color: var(--border-default, #334155);
}

/* SIPOC Import Modal Stats */
.sipoc-stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
}
.sipoc-stat-card {
    background: var(--bg-surface, #f7f7f7);
    border: 1px solid var(--border-color, #e5e7eb);
    border-radius: 8px;
    padding: 16px 12px;
    text-align: center;
}
.sipoc-stat-value {
    font-size: 28px;
    font-weight: 700;
    color: #D6A84A;
    line-height: 1;
}
.sipoc-stat-label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary, #666);
    margin-top: 4px;
}

/* Import Dropdown Menu */
.dict-import-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: var(--bg-primary, white);
    border: 1px solid var(--border-color, #e5e7eb);
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    z-index: 100;
    min-width: 200px;
    padding: 4px;
    /* v4.7.1: Smooth show/hide to avoid flicker on first open */
    opacity: 0;
    visibility: hidden;
    transform: translateY(-4px);
    transition: opacity 0.15s ease, visibility 0.15s ease, transform 0.15s ease;
}
.dict-import-menu.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}
.dict-import-option {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 10px 12px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-primary, #333);
    border-radius: 6px;
    text-align: left;
}
.dict-import-option:hover {
    background: var(--bg-hover, #f3f4f6);
}
.dict-import-option i {
    width: 16px;
    height: 16px;
    color: #D6A84A;
}

/* SIPOC Dropzone Drag Over */
.drag-over {
    border-color: #D6A84A !important;
    background: #D6A84A08 !important;
}

/* Spinner for loading states */
.spinner-border {
    display: inline-block;
    width: 24px;
    height: 24px;
    border: 3px solid #e5e7eb;
    border-right-color: #D6A84A;
    border-radius: 50%;
    animation: spin 0.75s linear infinite;
}
@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Hierarchy Tree View */
.hier-tree-container {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    font-size: 13px;
}
.hier-node {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 5px 8px;
    border-radius: 6px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
}
.hier-node:hover {
    background: var(--bg-hover, #f3f4f6);
}
.hier-toggle {
    width: 16px;
    text-align: center;
    font-size: 10px;
    color: var(--text-secondary, #888);
    cursor: pointer;
    user-select: none;
    flex-shrink: 0;
}
.hier-name {
    font-weight: 500;
    color: var(--text-primary, #333);
}
.hier-count {
    font-size: 11px;
    color: var(--text-secondary, #888);
}
.hier-org-badge {
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 10px;
    background: #6366f120;
    color: #6366f1;
    margin-left: 4px;
}

/* Disposition styles for hierarchy nodes */
.hier-sanctioned .hier-name {
    color: #10b981;
}
.hier-sanctioned {
    border-left: 3px solid #10b981;
}
.hier-disp-badge {
    font-size: 11px;
    padding: 0 4px;
    border-radius: 4px;
}
.hier-disp-sanctioned {
    background: #10b98120;
    color: #10b981;
}
.hier-retiring .hier-name {
    text-decoration: line-through;
    opacity: 0.6;
    color: #f59e0b;
}
.hier-retiring {
    border-left: 3px dashed #f59e0b;
    opacity: 0.7;
}
.hier-disp-retiring {
    background: #f59e0b20;
    color: #f59e0b;
}
.hier-tbd {
    border-left: 3px dotted #9ca3af;
}
.hier-tbd .hier-name {
    color: #9ca3af;
    font-style: italic;
}
.hier-disp-tbd {
    background: #9ca3af20;
    color: #9ca3af;
}
.hier-baselined {
    font-size: 10px;
    background: #10b98120;
    color: #10b981;
    padding: 0 4px;
    border-radius: 4px;
    margin-left: 4px;
}
.hier-highlight {
    background: #D6A84A20 !important;
    box-shadow: 0 0 0 2px #D6A84A40;
}

/* Disposition treatments on dictionary cards and table rows */
.dict-role-sanctioned {
    border-left: 3px solid #10b981 !important;
}
.dict-role-retiring {
    border-left: 3px dashed #f59e0b !important;
    opacity: 0.65;
}
.dict-role-retiring .dict-role-name-text,
.dict-role-retiring .dict-card-name {
    text-decoration: line-through;
    color: #f59e0b;
}
.dict-role-tbd {
    border-left: 3px dotted #9ca3af !important;
}

/* Disposition badges for table/card */
.dict-disp-badge {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 10px;
    font-weight: 500;
}
.dict-disp-sanctioned {
    background: #10b98120;
    color: #10b981;
}
.dict-disp-retiring {
    background: #f59e0b20;
    color: #f59e0b;
}
.dict-disp-tbd {
    background: #9ca3af20;
    color: #9ca3af;
}
.dict-baselined-badge {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 10px;
    background: #10b98115;
    color: #10b981;
    font-weight: 500;
}
.dict-role-type-badge {
    display: inline-block;
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 10px;
    background: #8b5cf620;
    color: #8b5cf6;
}

/* ---- Dark Mode for v4.1.0 elements ---- */
.dark-mode .sipoc-stat-card,
[data-theme="dark"] .sipoc-stat-card {
    background: #1e293b;
    border-color: #334155;
}
.dark-mode .dict-import-menu,
[data-theme="dark"] .dict-import-menu {
    background: #1e293b;
    border-color: #334155;
    box-shadow: 0 4px 16px rgba(0,0,0,0.4);
}
.dark-mode .dict-import-option,
[data-theme="dark"] .dict-import-option {
    color: #e2e8f0;
}
.dark-mode .dict-import-option:hover,
[data-theme="dark"] .dict-import-option:hover {
    background: #334155;
}
.dark-mode .hier-node:hover,
[data-theme="dark"] .hier-node:hover {
    background: #334155;
}
.dark-mode .hier-name,
[data-theme="dark"] .hier-name {
    color: #e2e8f0;
}
.dark-mode .hier-highlight,
[data-theme="dark"] .hier-highlight {
    background: #D6A84A15 !important;
    box-shadow: 0 0 0 2px #D6A84A30;
}
.dark-mode .spinner-border,
[data-theme="dark"] .spinner-border {
    border-color: #334155;
    border-right-color: #D6A84A;
}

/* SIPOC Fallback Notice — Dark Mode */
.dark-mode #sipoc-fallback-notice > div,
[data-theme="dark"] #sipoc-fallback-notice > div {
    background: #332d1a !important;
    border-color: #5a4b1e !important;
    color: #e2e8f0 !important;
}
.dark-mode #sipoc-fallback-notice > div strong,
[data-theme="dark"] #sipoc-fallback-notice > div strong {
    color: #fbbf24 !important;
}

/* =================================================================
   ROLE DETAIL CARD — Rich inline-editable detail view
   ================================================================= */

/* Make role names clickable */
.dict-role-name-text,
.dict-card-name {
    cursor: pointer !important;
    transition: color 0.15s, text-decoration 0.15s;
}
.dict-role-name-text:hover,
.dict-card-name:hover {
    color: #D6A84A !important;
    text-decoration: underline dotted;
}

/* Modal override for the detail card */
#role-detail-modal .modal-content {
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    box-shadow: 0 25px 60px -12px rgba(0,0,0,0.3);
    height: fit-content;
    max-height: 90vh;
    overflow-y: auto;
    pointer-events: auto;
}

/* Hero Header */
.rd-hero {
    background: linear-gradient(135deg, #D6A84A 0%, #B8743A 100%);
    padding: 24px 28px 20px;
    position: relative;
    overflow: hidden;
}
.rd-hero::after {
    content: '';
    position: absolute;
    top: -40px; right: -40px;
    width: 120px; height: 120px;
    border-radius: 50%;
    background: rgba(255,255,255,0.08);
    pointer-events: none;
}
.rd-hero-top {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 12px;
}
.rd-hero-name {
    font-size: 1.5rem;
    font-weight: 700;
    color: #fff;
    margin: 0;
    line-height: 1.2;
    text-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.rd-hero-close {
    background: rgba(255,255,255,0.15);
    border: none;
    border-radius: 8px;
    color: #fff;
    width: 36px; height: 36px;
    min-width: 36px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
    flex-shrink: 0;
    position: relative;
    z-index: 2;
    margin: -4px -4px 0 0;
}
.rd-hero-close:hover { background: rgba(255,255,255,0.3); }
.rd-hero-badges {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
    flex-wrap: wrap;
}
.rd-hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    background: rgba(255,255,255,0.2);
    color: #fff;
    backdrop-filter: blur(4px);
}
.rd-hero-badge.rd-badge-deliverable { background: rgba(59,130,246,0.35); }
.rd-hero-badge.rd-badge-active { background: rgba(34,197,94,0.35); }
.rd-hero-badge.rd-badge-inactive { background: rgba(239,68,68,0.35); }
.rd-hero-badge.rd-badge-adj { background: rgba(255,255,255,0.25); }

/* Stats Row */
.rd-stats-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1px;
    background: var(--border-subtle, #f1f5f9);
    border-bottom: 1px solid var(--border-default, #e2e8f0);
}
.rd-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 12px 8px;
    background: var(--bg-primary, #fff);
    cursor: default;
    /* transition: background removed - anti-flicker */
    gap: 2px;
}
.rd-stat:hover { background: var(--bg-hover, #f8fafc); }
.rd-stat-value {
    font-size: 13px;
    font-weight: 700;
    color: var(--text-primary, #1e293b);
}
.rd-stat-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted, #94a3b8);
    font-weight: 500;
}

/* Body — 2 column */
.rd-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
}
.rd-col {
    padding: 20px 24px;
}
.rd-col:first-child {
    border-right: 1px solid var(--border-default, #e2e8f0);
}
.rd-section-title {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted, #94a3b8);
    font-weight: 700;
    margin: 0 0 12px;
}

/* Fields */
.rd-field {
    margin-bottom: 14px;
}
.rd-field-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted, #94a3b8);
    font-weight: 600;
    margin-bottom: 4px;
}
.rd-field-value {
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    line-height: 1.5;
}
.rd-field-value:empty::after {
    content: '—';
    color: var(--text-muted, #94a3b8);
}

/* Editable fields */
.rd-editable {
    border: 1px solid transparent;
    border-radius: 6px;
    padding: 6px 8px;
    transition: all 0.15s;
    min-height: 28px;
    background: transparent;
    width: 100%;
    font-family: inherit;
    font-size: 13px;
    color: var(--text-primary, #1e293b);
    resize: vertical;
}
.rd-editable:hover {
    border-color: var(--border-default, #e2e8f0);
    background: var(--bg-hover, #f8fafc);
}
.rd-editable:focus {
    outline: none;
    border-color: #D6A84A;
    background: var(--bg-primary, #fff);
    box-shadow: 0 0 0 3px rgba(214,168,74,0.15);
}
select.rd-editable {
    appearance: auto;
    cursor: pointer;
}
textarea.rd-editable {
    min-height: 60px;
}
.rd-editable::placeholder {
    color: var(--text-muted, #94a3b8);
    opacity: 0.5;
    font-style: italic;
}

/* Function Tags */
.rd-tags-wrap {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 10px;
}
.rd-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 500;
    background: rgba(99,102,241,0.1);
    color: #6366f1;
    transition: all 0.15s;
}
.rd-tag .rd-tag-x {
    cursor: pointer;
    opacity: 0.5;
    font-size: 13px;
    line-height: 1;
    transition: opacity 0.15s;
}
.rd-tag .rd-tag-x:hover { opacity: 1; }
.rd-tag-add {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 5px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    background: var(--bg-hover, #f1f5f9);
    color: var(--text-muted, #94a3b8);
    border: 1px dashed var(--border-default, #e2e8f0);
    cursor: pointer;
    transition: all 0.15s;
    user-select: none;
}
.rd-tag-add:hover {
    border-color: #D6A84A;
    color: #D6A84A;
    background: rgba(214,168,74,0.06);
}

/* Tag Add Dropdown */
.rd-tag-add-wrap {
    position: relative;
    display: inline-block;
}
.rd-tag-dropdown {
    position: absolute;
    top: calc(100% + 6px);
    left: 0;
    width: 320px;
    max-height: 0;
    overflow: hidden;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 10px;
    box-shadow: 0 12px 36px -8px rgba(0,0,0,0.2);
    z-index: 20;
    opacity: 0;
    transform: translateY(-4px);
    transition: max-height 0.25s ease, opacity 0.2s ease, transform 0.2s ease;
    pointer-events: none;
}
.rd-tag-dropdown.rd-dd-open {
    max-height: 340px;
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
    overflow: visible;
}
.rd-tag-dd-search-wrap {
    padding: 8px 10px 6px;
    border-bottom: 1px solid var(--border-default, #e2e8f0);
    position: sticky;
    top: 0;
    background: var(--bg-primary, #fff);
    z-index: 1;
    border-radius: 10px 10px 0 0;
}
.rd-tag-dd-search {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 12px;
    font-family: inherit;
    background: var(--bg-secondary, #f8fafc);
    color: var(--text-primary, #1e293b);
    outline: none;
    transition: border-color 0.15s;
}
.rd-tag-dd-search:focus {
    border-color: #D6A84A;
    box-shadow: 0 0 0 2px rgba(214,168,74,0.15);
}
.rd-tag-dd-list {
    max-height: 270px;
    overflow-y: auto;
    padding: 4px 0;
    overscroll-behavior: contain;
}
.rd-tag-dd-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
    color: var(--text-primary, #1e293b);
}
.rd-tag-dd-item:hover:not(.rd-tag-dd-group):not(.rd-tag-dd-disabled) {
    background: var(--bg-hover, #f1f5f9);
}
.rd-tag-dd-group {
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted, #94a3b8);
    padding: 10px 12px 4px;
    cursor: default;
}
.rd-tag-dd-leaf {
    padding-left: 16px;
}
.rd-tag-dd-child {
    padding-left: 28px;
}
.rd-tag-dd-grandchild {
    padding-left: 40px;
}
.rd-tag-dd-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}
.rd-tag-dd-name {
    font-weight: 600;
    font-family: 'SF Mono', 'Fira Code', monospace;
    font-size: 11px;
    white-space: nowrap;
}
.rd-tag-dd-desc {
    color: var(--text-muted, #94a3b8);
    font-size: 11px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
    min-width: 0;
}
.rd-tag-dd-check {
    color: #22c55e;
    font-size: 12px;
    font-weight: 700;
    flex-shrink: 0;
    margin-left: auto;
}
.rd-tag-dd-disabled {
    opacity: 0.45;
    cursor: default;
    pointer-events: none;
}

/* Dark mode tag dropdown */
.dark-mode .rd-tag-dropdown,
[data-theme="dark"] .rd-tag-dropdown {
    background: var(--bg-primary, #1e293b);
    border-color: #334155;
    box-shadow: 0 12px 36px -8px rgba(0,0,0,0.5);
}
.dark-mode .rd-tag-dd-search-wrap,
[data-theme="dark"] .rd-tag-dd-search-wrap {
    background: var(--bg-primary, #1e293b);
    border-color: #334155;
}
.dark-mode .rd-tag-dd-search,
[data-theme="dark"] .rd-tag-dd-search {
    background: var(--bg-secondary, #0f172a);
    border-color: #334155;
    color: var(--text-primary, #e2e8f0);
}
.dark-mode .rd-tag-dd-item:hover:not(.rd-tag-dd-group):not(.rd-tag-dd-disabled),
[data-theme="dark"] .rd-tag-dd-item:hover:not(.rd-tag-dd-group):not(.rd-tag-dd-disabled) {
    background: rgba(255,255,255,0.05);
}

/* Mini inheritance tree */
.rd-inherit {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    margin-top: 8px;
}
.rd-inherit-group {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: center;
}
.rd-inherit-node {
    display: inline-flex;
    align-items: center;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 500;
    background: var(--bg-hover, #f1f5f9);
    color: var(--text-secondary, #64748b);
    border: 1px solid var(--border-default, #e2e8f0);
    transition: all 0.15s;
    max-width: 180px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rd-inherit-node.rd-self {
    background: linear-gradient(135deg, #D6A84A, #B8743A);
    color: #fff;
    border-color: transparent;
    font-weight: 700;
}
.rd-inherit-node:hover:not(.rd-self) {
    border-color: #D6A84A;
    color: #D6A84A;
    cursor: pointer;
}
.rd-inherit-arrow {
    color: var(--text-muted, #94a3b8);
    font-size: 14px;
    line-height: 1;
}
.rd-inherit-label {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted, #94a3b8);
    font-weight: 600;
}
.rd-inherit-empty {
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
    font-style: italic;
    opacity: 0.6;
}
.rd-inherit-removable {
    cursor: pointer;
    position: relative;
    padding-right: 20px;
}
.rd-inherit-removable:hover {
    border-color: #ef4444;
    color: #ef4444;
    background: rgba(239,68,68,0.08);
}
.rd-inherit-x {
    position: absolute;
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 13px;
    line-height: 1;
    opacity: 0;
    transition: opacity 0.15s;
    color: #ef4444;
}
.rd-inherit-removable:hover .rd-inherit-x {
    opacity: 1;
}

/* Inheritance smart search */
.rd-inherit-add-wrap {
    margin-top: 12px;
    position: relative;
}
.rd-inherit-search-row {
    display: flex;
    gap: 6px;
}
.rd-inherit-search {
    flex: 1;
    padding: 6px 10px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 12px;
    font-family: inherit;
    background: var(--bg-secondary, #f8fafc);
    color: var(--text-primary, #1e293b);
    outline: none;
    transition: border-color 0.15s;
    min-width: 0;
}
.rd-inherit-search:focus {
    border-color: #D6A84A;
    box-shadow: 0 0 0 2px rgba(214,168,74,0.15);
}
.rd-inherit-direction {
    padding: 4px 8px;
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 6px;
    font-size: 11px;
    font-family: inherit;
    background: var(--bg-secondary, #f8fafc);
    color: var(--text-primary, #1e293b);
    cursor: pointer;
    outline: none;
    flex-shrink: 0;
}
.rd-inherit-results {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--bg-primary, #fff);
    border: 1px solid var(--border-default, #e2e8f0);
    border-radius: 8px;
    box-shadow: 0 8px 24px -6px rgba(0,0,0,0.15);
    z-index: 20;
    max-height: 200px;
    overflow-y: auto;
    display: none;
}
.rd-inherit-result-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 7px 12px;
    font-size: 12px;
    cursor: pointer;
    /* transition: background removed - anti-flicker */
    color: var(--text-primary, #1e293b);
}
.rd-inherit-result-item:hover {
    background: var(--bg-hover, #f1f5f9);
}
.rd-inherit-result-name {
    font-weight: 600;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
    min-width: 0;
}
.rd-inherit-result-cat {
    font-size: 10px;
    color: var(--text-muted, #94a3b8);
    padding: 1px 6px;
    border-radius: 4px;
    background: var(--bg-hover, #f1f5f9);
    flex-shrink: 0;
    margin-left: 8px;
}
.rd-inherit-result-empty {
    padding: 12px;
    text-align: center;
    font-size: 12px;
    color: var(--text-muted, #94a3b8);
    font-style: italic;
}

/* Dark mode inheritance search */
.dark-mode .rd-inherit-search,
[data-theme="dark"] .rd-inherit-search {
    background: var(--bg-secondary, #0f172a);
    border-color: #334155;
    color: var(--text-primary, #e2e8f0);
}
.dark-mode .rd-inherit-direction,
[data-theme="dark"] .rd-inherit-direction {
    background: var(--bg-secondary, #0f172a);
    border-color: #334155;
    color: var(--text-primary, #e2e8f0);
}
.dark-mode .rd-inherit-results,
[data-theme="dark"] .rd-inherit-results {
    background: var(--bg-primary, #1e293b);
    border-color: #334155;
    box-shadow: 0 8px 24px -6px rgba(0,0,0,0.4);
}
.dark-mode .rd-inherit-result-item:hover,
[data-theme="dark"] .rd-inherit-result-item:hover {
    background: rgba(255,255,255,0.05);
}

/* Nimbus Model Locations */
.rd-nimbus-list {
    list-style: none;
    padding: 0;
    margin: 8px 0 0 0;
}
.rd-nimbus-item {
    padding: 5px 10px;
    border-radius: 6px;
    font-size: 12px;
    transition: background 0.15s;
}
.rd-nimbus-item:hover {
    background: var(--bg-hover, #f1f5f9);
}
.rd-nimbus-link {
    color: var(--accent, #6366f1);
    text-decoration: none;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 6px;
}
.rd-nimbus-link:hover {
    text-decoration: underline;
}
.rd-nimbus-icon {
    font-size: 14px;
    flex-shrink: 0;
}
.dark-mode .rd-nimbus-item:hover,
[data-theme="dark"] .rd-nimbus-item:hover {
    background: rgba(255,255,255,0.05);
}

/* Timeline */
.rd-timeline {
    padding: 10px 28px;
    font-size: 11px;
    color: var(--text-muted, #94a3b8);
    border-top: 1px solid var(--border-default, #e2e8f0);
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 8px;
}

/* Footer */
.rd-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 28px;
    border-top: 1px solid var(--border-default, #e2e8f0);
    background: var(--bg-secondary, #f8fafc);
}
.rd-save-btn {
    transition: color 0.2s, opacity 0.2s, transform 0.2s, border-color 0.2s, box-shadow 0.2s;
}
.rd-save-btn.rd-dirty {
    animation: rdPulse 2s ease infinite;
    box-shadow: 0 0 0 3px rgba(214,168,74,0.25);
}
@keyframes rdPulse {
    0%, 100% { box-shadow: 0 0 0 3px rgba(214,168,74,0.15); }
    50% { box-shadow: 0 0 0 6px rgba(214,168,74,0.25); }
}

/* Dark Mode */
.dark-mode #role-detail-modal .modal-content,
[data-theme="dark"] #role-detail-modal .modal-content {
    background: var(--bg-primary, #1e293b);
    border-color: #334155;
}
.dark-mode .rd-hero,
[data-theme="dark"] .rd-hero {
    background: linear-gradient(135deg, #a47f32 0%, #8a5c2a 100%);
}
.dark-mode .rd-stats-row,
[data-theme="dark"] .rd-stats-row {
    background: #1e293b;
}
.dark-mode .rd-stat,
[data-theme="dark"] .rd-stat {
    background: var(--bg-primary, #0f172a);
}
.dark-mode .rd-editable:hover,
[data-theme="dark"] .rd-editable:hover {
    background: rgba(255,255,255,0.05);
}
.dark-mode .rd-editable:focus,
[data-theme="dark"] .rd-editable:focus {
    background: rgba(255,255,255,0.08);
}
.dark-mode .rd-footer,
[data-theme="dark"] .rd-footer {
    background: var(--bg-secondary, #1e293b);
}
.dark-mode .rd-tag,
[data-theme="dark"] .rd-tag {
    background: rgba(99,102,241,0.2);
    color: #a5b4fc;
}

/* =============================================================================
   v4.6.0: Role Statements Panel
   ============================================================================= */
.role-stmt-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(2px);
}
.role-stmt-panel {
    background: var(--bg-surface, #1e293b);
    border-radius: 16px;
    width: min(900px, 90vw);
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    border: 1px solid var(--border-color, rgba(255,255,255,0.1));
}
.role-stmt-header {
    padding: 20px 24px 12px;
    border-bottom: 1px solid var(--border-color, rgba(255,255,255,0.1));
    flex-shrink: 0;
}
.role-stmt-title-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
}
.role-stmt-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary, #e2e8f0);
    margin: 0;
    display: flex;
    align-items: center;
    gap: 8px;
}
.role-stmt-close {
    background: none;
    border: none;
    color: var(--text-muted, rgba(255,255,255,0.5));
    font-size: 24px;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 6px;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}
.role-stmt-close:hover {
    background: rgba(255,255,255,0.1);
    color: var(--text-primary, #e2e8f0);
}
.role-stmt-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 8px;
}
.role-stmt-stats {
    display: flex;
    gap: 12px;
    font-size: 13px;
    color: var(--text-muted, rgba(255,255,255,0.5));
}
.role-stmt-stats strong {
    color: var(--text-primary, #e2e8f0);
}
.role-stmt-actions {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
}
.role-stmt-select-all-label {
    font-size: 12px;
    color: var(--text-secondary, #94a3b8);
    display: flex;
    align-items: center;
    gap: 4px;
    cursor: pointer;
}
.role-stmt-reassign-select {
    padding: 5px 8px;
    font-size: 12px;
    border-radius: 6px;
    border: 1px solid var(--border-color, rgba(255,255,255,0.15));
    background: var(--bg-primary, #0f172a);
    color: var(--text-primary, #e2e8f0);
    max-width: 200px;
}
.role-stmt-btn {
    padding: 5px 12px;
    font-size: 12px;
    font-weight: 500;
    border-radius: 6px;
    border: 1px solid transparent;
    cursor: pointer;
    transition: color 0.15s, opacity 0.15s, transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}
.role-stmt-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}
.role-stmt-btn-primary {
    background: #3b82f6;
    color: white;
}
.role-stmt-btn-primary:hover:not(:disabled) {
    background: #2563eb;
}
.role-stmt-btn-danger {
    background: rgba(239,68,68,0.15);
    color: #ef4444;
    border-color: rgba(239,68,68,0.3);
}
.role-stmt-btn-danger:hover:not(:disabled) {
    background: #ef4444;
    color: white;
}
.role-stmt-body {
    padding: 16px 24px 20px;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
}
.role-stmt-loading {
    text-align: center;
    padding: 40px 0;
    color: var(--text-muted, rgba(255,255,255,0.5));
    font-size: 14px;
}
.role-stmt-empty {
    text-align: center;
    padding: 40px 0;
    color: var(--text-muted, rgba(255,255,255,0.5));
    font-size: 14px;
}
.role-stmt-warning {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 12px 16px;
    margin-bottom: 16px;
    background: rgba(251,191,36,0.1);
    border: 1px solid rgba(251,191,36,0.3);
    border-radius: 8px;
    color: #f59e0b;
    font-size: 13px;
    line-height: 1.5;
}
.role-stmt-group {
    margin-bottom: 16px;
}
.role-stmt-group-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: var(--bg-secondary, #0f172a);
    border-radius: 8px;
    margin-bottom: 6px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary, #e2e8f0);
}
.role-stmt-group-name {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.role-stmt-group-count {
    background: rgba(99,102,241,0.2);
    color: #a5b4fc;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 600;
}
.role-stmt-group-items {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding-left: 8px;
}
.role-stmt-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-primary, #e2e8f0);
    /* transition: background removed - anti-flicker */
    border: 1px solid transparent;
}
.role-stmt-item:hover {
    background: rgba(255,255,255,0.04);
    border-color: var(--border-color, rgba(255,255,255,0.1));
}
.role-stmt-cb {
    flex-shrink: 0;
    cursor: pointer;
}
.role-stmt-num {
    flex-shrink: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--text-muted, rgba(255,255,255,0.5));
    min-width: 24px;
}
.role-stmt-desc {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--text-secondary, #94a3b8);
    font-size: 12px;
}
.role-stmt-item .stmt-badge {
    flex-shrink: 0;
}

/* Light mode */
body:not(.dark-mode) .role-stmt-panel,
body.light-mode .role-stmt-panel {
    background: #ffffff;
    border-color: rgba(0,0,0,0.1);
}
body:not(.dark-mode) .role-stmt-header,
body.light-mode .role-stmt-header {
    border-color: rgba(0,0,0,0.1);
}
body:not(.dark-mode) .role-stmt-title,
body.light-mode .role-stmt-title {
    color: #1e293b;
}
body:not(.dark-mode) .role-stmt-group-header,
body.light-mode .role-stmt-group-header {
    background: #f1f5f9;
    color: #1e293b;
}
body:not(.dark-mode) .role-stmt-item,
body.light-mode .role-stmt-item {
    color: #334155;
}
body:not(.dark-mode) .role-stmt-item:hover,
body.light-mode .role-stmt-item:hover {
    background: rgba(0,0,0,0.03);
    border-color: rgba(0,0,0,0.1);
}
body:not(.dark-mode) .role-stmt-reassign-select,
body.light-mode .role-stmt-reassign-select {
    background: #f8fafc;
    border-color: rgba(0,0,0,0.15);
    color: #334155;
}

